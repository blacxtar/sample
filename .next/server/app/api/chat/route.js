(()=>{var a={};a.id=276,a.ids=[276],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},66946:(a,b,c)=>{"use strict";Object.defineProperty(b,"I",{enumerable:!0,get:function(){return g}});let d=c(30898),e=c(42471),f=c(47912);async function g(a,b,c,g){if((0,d.isNodeNextResponse)(b)){var h;b.statusCode=c.status,b.statusMessage=c.statusText;let d=["set-cookie","www-authenticate","proxy-authenticate","vary"];null==(h=c.headers)||h.forEach((a,c)=>{if("x-middleware-set-cookie"!==c.toLowerCase())if("set-cookie"===c.toLowerCase())for(let d of(0,f.splitCookiesString)(a))b.appendHeader(c,d);else{let e=void 0!==b.getHeader(c);(d.includes(c.toLowerCase())||!e)&&b.appendHeader(c,a)}});let{originalResponse:i}=b;c.body&&"HEAD"!==a.method?await (0,e.pipeToNodeResponse)(c.body,i,g):i.end()}}},78335:()=>{},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},96349:(a,b,c)=>{"use strict";let d,e;c.r(b),c.d(b,{handler:()=>j6,patchFetch:()=>j5,routeModule:()=>j1,serverHooks:()=>j4,workAsyncStorage:()=>j2,workUnitAsyncStorage:()=>j3});var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T={};c.r(T),c.d(T,{POST:()=>j0,maxDuration:()=>j_});var U=c(96559),V=c(48088),W=c(37719),X=c(26191),Y=c(81289),Z=c(261),$=c(92603),_=c(39893),aa=c(14823),ab=c(47220),ac=c(66946),ad=c(47912),ae=c(99786),af=c(46143),ag=c(86439),ah=c(43365),ai="vercel.ai.error",aj=Symbol.for(ai),ak=class a extends Error{constructor({name:a,message:b,cause:c}){super(b),this[f]=!0,this.name=a,this.cause=c}static isInstance(b){return a.hasMarker(b,ai)}static hasMarker(a,b){let c=Symbol.for(b);return null!=a&&"object"==typeof a&&c in a&&"boolean"==typeof a[c]&&!0===a[c]}};f=aj;var al=ak,am="AI_APICallError",an=`vercel.ai.error.${am}`,ao=Symbol.for(an),ap=class extends al{constructor({message:a,url:b,requestBodyValues:c,statusCode:d,responseHeaders:e,responseBody:f,cause:h,isRetryable:i=null!=d&&(408===d||409===d||429===d||d>=500),data:j}){super({name:am,message:a,cause:h}),this[g]=!0,this.url=b,this.requestBodyValues=c,this.statusCode=d,this.responseHeaders=e,this.responseBody=f,this.isRetryable=i,this.data=j}static isInstance(a){return al.hasMarker(a,an)}};g=ao;var aq="AI_EmptyResponseBodyError",ar=`vercel.ai.error.${aq}`,as=Symbol.for(ar),at=class extends al{constructor({message:a="Empty response body"}={}){super({name:aq,message:a}),this[h]=!0}static isInstance(a){return al.hasMarker(a,ar)}};function au(a){return null==a?"unknown error":"string"==typeof a?a:a instanceof Error?a.message:JSON.stringify(a)}h=as;var av="AI_InvalidArgumentError",aw=`vercel.ai.error.${av}`,ax=Symbol.for(aw),ay=class extends al{constructor({message:a,cause:b,argument:c}){super({name:av,message:a,cause:b}),this[i]=!0,this.argument=c}static isInstance(a){return al.hasMarker(a,aw)}};i=ax;var az="AI_InvalidPromptError",aA=`vercel.ai.error.${az}`,aB=Symbol.for(aA),aC=class extends al{constructor({prompt:a,message:b,cause:c}){super({name:az,message:`Invalid prompt: ${b}`,cause:c}),this[j]=!0,this.prompt=a}static isInstance(a){return al.hasMarker(a,aA)}};j=aB,Symbol.for("vercel.ai.error.AI_InvalidResponseDataError");var aD="AI_JSONParseError",aE=`vercel.ai.error.${aD}`,aF=Symbol.for(aE),aG=class extends al{constructor({text:a,cause:b}){super({name:aD,message:`JSON parsing failed: Text: ${a}.
Error message: ${au(b)}`,cause:b}),this[k]=!0,this.text=a}static isInstance(a){return al.hasMarker(a,aE)}};k=aF;var aH="AI_LoadAPIKeyError",aI=`vercel.ai.error.${aH}`,aJ=Symbol.for(aI),aK=class extends al{constructor({message:a}){super({name:aH,message:a}),this[l]=!0}static isInstance(a){return al.hasMarker(a,aI)}};l=aJ,Symbol.for("vercel.ai.error.AI_LoadSettingError"),Symbol.for("vercel.ai.error.AI_NoContentGeneratedError");var aL="AI_NoSuchModelError",aM=`vercel.ai.error.${aL}`,aN=Symbol.for(aM),aO=class extends al{constructor({errorName:a=aL,modelId:b,modelType:c,message:d=`No such ${c}: ${b}`}){super({name:a,message:d}),this[m]=!0,this.modelId=b,this.modelType=c}static isInstance(a){return al.hasMarker(a,aM)}};m=aN;var aP="AI_TooManyEmbeddingValuesForCallError",aQ=`vercel.ai.error.${aP}`,aR=Symbol.for(aQ),aS=class extends al{constructor(a){super({name:aP,message:`Too many values for a single embedding call. The ${a.provider} model "${a.modelId}" can only embed up to ${a.maxEmbeddingsPerCall} values per call, but ${a.values.length} values were provided.`}),this[n]=!0,this.provider=a.provider,this.modelId=a.modelId,this.maxEmbeddingsPerCall=a.maxEmbeddingsPerCall,this.values=a.values}static isInstance(a){return al.hasMarker(a,aQ)}};n=aR;var aT="AI_TypeValidationError",aU=`vercel.ai.error.${aT}`,aV=Symbol.for(aU),aW=class a extends al{constructor({value:a,cause:b}){super({name:aT,message:`Type validation failed: Value: ${JSON.stringify(a)}.
Error message: ${au(b)}`,cause:b}),this[o]=!0,this.value=a}static isInstance(a){return al.hasMarker(a,aU)}static wrap({value:b,cause:c}){return a.isInstance(c)&&c.value===b?c:new a({value:b,cause:c})}};o=aV;var aX="AI_UnsupportedFunctionalityError",aY=`vercel.ai.error.${aX}`,aZ=Symbol.for(aY),a$=class extends al{constructor({functionality:a,message:b=`'${a}' functionality not supported.`}){super({name:aX,message:b}),this[p]=!0,this.functionality=a}static isInstance(a){return al.hasMarker(a,aY)}};p=aZ;class a_ extends Error{constructor(a,b){super(a),this.name="ParseError",this.type=b.type,this.field=b.field,this.value=b.value,this.line=b.line}}function a0(a){}class a1 extends TransformStream{constructor({onError:a,onRetry:b,onComment:c}={}){let d;super({start(e){d=function(a){if("function"==typeof a)throw TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");let{onEvent:b=a0,onError:c=a0,onRetry:d=a0,onComment:e}=a,f="",g=!0,h,i="",j="";function k(a){if(""===a)return void(i.length>0&&b({id:h,event:j||void 0,data:i.endsWith(`
`)?i.slice(0,-1):i}),h=void 0,i="",j="");if(a.startsWith(":")){e&&e(a.slice(a.startsWith(": ")?2:1));return}let c=a.indexOf(":");if(-1!==c){let b=a.slice(0,c),d=" "===a[c+1]?2:1;l(b,a.slice(c+d),a);return}l(a,"",a)}function l(a,b,e){switch(a){case"event":j=b;break;case"data":i=`${i}${b}
`;break;case"id":h=b.includes("\0")?void 0:b;break;case"retry":/^\d+$/.test(b)?d(parseInt(b,10)):c(new a_(`Invalid \`retry\` value: "${b}"`,{type:"invalid-retry",value:b,line:e}));break;default:c(new a_(`Unknown field "${a.length>20?`${a.slice(0,20)}\u2026`:a}"`,{type:"unknown-field",field:a,value:b,line:e}))}}return{feed:function(a){let b=g?a.replace(/^\xEF\xBB\xBF/,""):a,[c,d]=function(a){let b=[],c="",d=0;for(;d<a.length;){let e=a.indexOf("\r",d),f=a.indexOf(`
`,d),g=-1;if(-1!==e&&-1!==f?g=Math.min(e,f):-1!==e?g=e:-1!==f&&(g=f),-1===g){c=a.slice(d);break}{let c=a.slice(d,g);b.push(c),"\r"===a[(d=g+1)-1]&&a[d]===`
`&&d++}}return[b,c]}(`${f}${b}`);for(let a of c)k(a);f=d,g=!1},reset:function(a={}){f&&a.consume&&k(f),g=!0,h=void 0,i="",j="",f=""}}}({onEvent:a=>{e.enqueue(a)},onError(b){"terminate"===a?e.error(b):"function"==typeof a&&a(b)},onRetry:b,onComment:c})},transform(a){d.feed(a)}})}}let a2=Symbol("Let zodToJsonSchema decide on which parser to use"),a3={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"};!function(a){a.assertEqual=a=>{},a.assertIs=function(a){},a.assertNever=function(a){throw Error()},a.arrayToEnum=a=>{let b={};for(let c of a)b[c]=c;return b},a.getValidEnumValues=b=>{let c=a.objectKeys(b).filter(a=>"number"!=typeof b[b[a]]),d={};for(let a of c)d[a]=b[a];return a.objectValues(d)},a.objectValues=b=>a.objectKeys(b).map(function(a){return b[a]}),a.objectKeys="function"==typeof Object.keys?a=>Object.keys(a):a=>{let b=[];for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b},a.find=(a,b)=>{for(let c of a)if(b(c))return c},a.isInteger="function"==typeof Number.isInteger?a=>Number.isInteger(a):a=>"number"==typeof a&&Number.isFinite(a)&&Math.floor(a)===a,a.joinValues=function(a,b=" | "){return a.map(a=>"string"==typeof a?`'${a}'`:a).join(b)},a.jsonStringifyReplacer=(a,b)=>"bigint"==typeof b?b.toString():b}(q||(q={})),(r||(r={})).mergeShapes=(a,b)=>({...a,...b});let a4=q.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),a5=a=>{switch(typeof a){case"undefined":return a4.undefined;case"string":return a4.string;case"number":return Number.isNaN(a)?a4.nan:a4.number;case"boolean":return a4.boolean;case"function":return a4.function;case"bigint":return a4.bigint;case"symbol":return a4.symbol;case"object":if(Array.isArray(a))return a4.array;if(null===a)return a4.null;if(a.then&&"function"==typeof a.then&&a.catch&&"function"==typeof a.catch)return a4.promise;if("undefined"!=typeof Map&&a instanceof Map)return a4.map;if("undefined"!=typeof Set&&a instanceof Set)return a4.set;if("undefined"!=typeof Date&&a instanceof Date)return a4.date;return a4.object;default:return a4.unknown}},a6=q.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class a7 extends Error{get errors(){return this.issues}constructor(a){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};let b=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,b):this.__proto__=b,this.name="ZodError",this.issues=a}format(a){let b=a||function(a){return a.message},c={_errors:[]},d=a=>{for(let e of a.issues)if("invalid_union"===e.code)e.unionErrors.map(d);else if("invalid_return_type"===e.code)d(e.returnTypeError);else if("invalid_arguments"===e.code)d(e.argumentsError);else if(0===e.path.length)c._errors.push(b(e));else{let a=c,d=0;for(;d<e.path.length;){let c=e.path[d];d===e.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(b(e))):a[c]=a[c]||{_errors:[]},a=a[c],d++}}};return d(this),c}static assert(a){if(!(a instanceof a7))throw Error(`Not a ZodError: ${a}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,q.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(a=a=>a.message){let b={},c=[];for(let d of this.issues)if(d.path.length>0){let c=d.path[0];b[c]=b[c]||[],b[c].push(a(d))}else c.push(a(d));return{formErrors:c,fieldErrors:b}}get formErrors(){return this.flatten()}}a7.create=a=>new a7(a);let a8=(a,b)=>{let c;switch(a.code){case a6.invalid_type:c=a.received===a4.undefined?"Required":`Expected ${a.expected}, received ${a.received}`;break;case a6.invalid_literal:c=`Invalid literal value, expected ${JSON.stringify(a.expected,q.jsonStringifyReplacer)}`;break;case a6.unrecognized_keys:c=`Unrecognized key(s) in object: ${q.joinValues(a.keys,", ")}`;break;case a6.invalid_union:c="Invalid input";break;case a6.invalid_union_discriminator:c=`Invalid discriminator value. Expected ${q.joinValues(a.options)}`;break;case a6.invalid_enum_value:c=`Invalid enum value. Expected ${q.joinValues(a.options)}, received '${a.received}'`;break;case a6.invalid_arguments:c="Invalid function arguments";break;case a6.invalid_return_type:c="Invalid function return type";break;case a6.invalid_date:c="Invalid date";break;case a6.invalid_string:"object"==typeof a.validation?"includes"in a.validation?(c=`Invalid input: must include "${a.validation.includes}"`,"number"==typeof a.validation.position&&(c=`${c} at one or more positions greater than or equal to ${a.validation.position}`)):"startsWith"in a.validation?c=`Invalid input: must start with "${a.validation.startsWith}"`:"endsWith"in a.validation?c=`Invalid input: must end with "${a.validation.endsWith}"`:q.assertNever(a.validation):c="regex"!==a.validation?`Invalid ${a.validation}`:"Invalid";break;case a6.too_small:c="array"===a.type?`Array must contain ${a.exact?"exactly":a.inclusive?"at least":"more than"} ${a.minimum} element(s)`:"string"===a.type?`String must contain ${a.exact?"exactly":a.inclusive?"at least":"over"} ${a.minimum} character(s)`:"number"===a.type||"bigint"===a.type?`Number must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${a.minimum}`:"date"===a.type?`Date must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(a.minimum))}`:"Invalid input";break;case a6.too_big:c="array"===a.type?`Array must contain ${a.exact?"exactly":a.inclusive?"at most":"less than"} ${a.maximum} element(s)`:"string"===a.type?`String must contain ${a.exact?"exactly":a.inclusive?"at most":"under"} ${a.maximum} character(s)`:"number"===a.type?`Number must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:"bigint"===a.type?`BigInt must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:"date"===a.type?`Date must be ${a.exact?"exactly":a.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(a.maximum))}`:"Invalid input";break;case a6.custom:c="Invalid input";break;case a6.invalid_intersection_types:c="Intersection results could not be merged";break;case a6.not_multiple_of:c=`Number must be a multiple of ${a.multipleOf}`;break;case a6.not_finite:c="Number must be finite";break;default:c=b.defaultError,q.assertNever(a)}return{message:c}};!function(a){a.errToObj=a=>"string"==typeof a?{message:a}:a||{},a.toString=a=>"string"==typeof a?a:a?.message}(s||(s={}));let a9=a=>{let{data:b,path:c,errorMaps:d,issueData:e}=a,f=[...c,...e.path||[]],g={...e,path:f};if(void 0!==e.message)return{...e,path:f,message:e.message};let h="";for(let a of d.filter(a=>!!a).slice().reverse())h=a(g,{data:b,defaultError:h}).message;return{...e,path:f,message:h}};function ba(a,b){let c=a9({issueData:b,data:a.data,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,a8,void 0].filter(a=>!!a)});a.common.issues.push(c)}class bb{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(a,b){let c=[];for(let d of b){if("aborted"===d.status)return bc;"dirty"===d.status&&a.dirty(),c.push(d.value)}return{status:a.value,value:c}}static async mergeObjectAsync(a,b){let c=[];for(let a of b){let b=await a.key,d=await a.value;c.push({key:b,value:d})}return bb.mergeObjectSync(a,c)}static mergeObjectSync(a,b){let c={};for(let d of b){let{key:b,value:e}=d;if("aborted"===b.status||"aborted"===e.status)return bc;"dirty"===b.status&&a.dirty(),"dirty"===e.status&&a.dirty(),"__proto__"!==b.value&&(void 0!==e.value||d.alwaysSet)&&(c[b.value]=e.value)}return{status:a.value,value:c}}}let bc=Object.freeze({status:"aborted"}),bd=a=>({status:"dirty",value:a}),be=a=>({status:"valid",value:a}),bf=a=>"undefined"!=typeof Promise&&a instanceof Promise;class bg{constructor(a,b,c,d){this._cachedPath=[],this.parent=a,this.data=b,this._path=c,this._key=d}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let bh=(a,b)=>{if("valid"===b.status)return{success:!0,data:b.value};if(!a.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let b=new a7(a.common.issues);return this._error=b,this._error}}};function bi(a){if(!a)return{};let{errorMap:b,invalid_type_error:c,required_error:d,description:e}=a;if(b&&(c||d))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return b?{errorMap:b,description:e}:{errorMap:(b,e)=>{let{message:f}=a;return"invalid_enum_value"===b.code?{message:f??e.defaultError}:void 0===e.data?{message:f??d??e.defaultError}:"invalid_type"!==b.code?{message:e.defaultError}:{message:f??c??e.defaultError}},description:e}}class bj{get description(){return this._def.description}_getType(a){return a5(a.data)}_getOrReturnCtx(a,b){return b||{common:a.parent.common,data:a.data,parsedType:a5(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}_processInputParams(a){return{status:new bb,ctx:{common:a.parent.common,data:a.data,parsedType:a5(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}}_parseSync(a){let b=this._parse(a);if(bf(b))throw Error("Synchronous parse encountered promise.");return b}_parseAsync(a){return Promise.resolve(this._parse(a))}parse(a,b){let c=this.safeParse(a,b);if(c.success)return c.data;throw c.error}safeParse(a,b){let c={common:{issues:[],async:b?.async??!1,contextualErrorMap:b?.errorMap},path:b?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:a5(a)},d=this._parseSync({data:a,path:c.path,parent:c});return bh(c,d)}"~validate"(a){let b={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:a5(a)};if(!this["~standard"].async)try{let c=this._parseSync({data:a,path:[],parent:b});return"valid"===c.status?{value:c.value}:{issues:b.common.issues}}catch(a){a?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),b.common={issues:[],async:!0}}return this._parseAsync({data:a,path:[],parent:b}).then(a=>"valid"===a.status?{value:a.value}:{issues:b.common.issues})}async parseAsync(a,b){let c=await this.safeParseAsync(a,b);if(c.success)return c.data;throw c.error}async safeParseAsync(a,b){let c={common:{issues:[],contextualErrorMap:b?.errorMap,async:!0},path:b?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:a5(a)},d=this._parse({data:a,path:c.path,parent:c});return bh(c,await (bf(d)?d:Promise.resolve(d)))}refine(a,b){return this._refinement((c,d)=>{let e=a(c),f=()=>d.addIssue({code:a6.custom,..."string"==typeof b||void 0===b?{message:b}:"function"==typeof b?b(c):b});return"undefined"!=typeof Promise&&e instanceof Promise?e.then(a=>!!a||(f(),!1)):!!e||(f(),!1)})}refinement(a,b){return this._refinement((c,d)=>!!a(c)||(d.addIssue("function"==typeof b?b(c,d):b),!1))}_refinement(a){return new b2({schema:this,typeName:t.ZodEffects,effect:{type:"refinement",refinement:a}})}superRefine(a){return this._refinement(a)}constructor(a){this.spa=this.safeParseAsync,this._def=a,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return b3.create(this,this._def)}nullable(){return b4.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return bN.create(this)}promise(){return b1.create(this,this._def)}or(a){return bP.create([this,a],this._def)}and(a){return bS.create(this,a,this._def)}transform(a){return new b2({...bi(this._def),schema:this,typeName:t.ZodEffects,effect:{type:"transform",transform:a}})}default(a){return new b5({...bi(this._def),innerType:this,defaultValue:"function"==typeof a?a:()=>a,typeName:t.ZodDefault})}brand(){return new b8({typeName:t.ZodBranded,type:this,...bi(this._def)})}catch(a){return new b6({...bi(this._def),innerType:this,catchValue:"function"==typeof a?a:()=>a,typeName:t.ZodCatch})}describe(a){return new this.constructor({...this._def,description:a})}pipe(a){return b9.create(this,a)}readonly(){return ca.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let bk=/^c[^\s-]{8,}$/i,bl=/^[0-9a-z]+$/,bm=/^[0-9A-HJKMNP-TV-Z]{26}$/i,bn=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,bo=/^[a-z0-9_-]{21}$/i,bp=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,bq=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,br=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,bs=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,bt=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,bu=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,bv=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,bw=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,bx=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,by="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",bz=RegExp(`^${by}$`);function bA(a){let b="[0-5]\\d";a.precision?b=`${b}\\.\\d{${a.precision}}`:null==a.precision&&(b=`${b}(\\.\\d+)?`);let c=a.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${b})${c}`}class bB extends bj{_parse(a){var b,c,e,f;let g;if(this._def.coerce&&(a.data=String(a.data)),this._getType(a)!==a4.string){let b=this._getOrReturnCtx(a);return ba(b,{code:a6.invalid_type,expected:a4.string,received:b.parsedType}),bc}let h=new bb;for(let i of this._def.checks)if("min"===i.kind)a.data.length<i.value&&(ba(g=this._getOrReturnCtx(a,g),{code:a6.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),h.dirty());else if("max"===i.kind)a.data.length>i.value&&(ba(g=this._getOrReturnCtx(a,g),{code:a6.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),h.dirty());else if("length"===i.kind){let b=a.data.length>i.value,c=a.data.length<i.value;(b||c)&&(g=this._getOrReturnCtx(a,g),b?ba(g,{code:a6.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&ba(g,{code:a6.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),h.dirty())}else if("email"===i.kind)br.test(a.data)||(ba(g=this._getOrReturnCtx(a,g),{validation:"email",code:a6.invalid_string,message:i.message}),h.dirty());else if("emoji"===i.kind)d||(d=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),d.test(a.data)||(ba(g=this._getOrReturnCtx(a,g),{validation:"emoji",code:a6.invalid_string,message:i.message}),h.dirty());else if("uuid"===i.kind)bn.test(a.data)||(ba(g=this._getOrReturnCtx(a,g),{validation:"uuid",code:a6.invalid_string,message:i.message}),h.dirty());else if("nanoid"===i.kind)bo.test(a.data)||(ba(g=this._getOrReturnCtx(a,g),{validation:"nanoid",code:a6.invalid_string,message:i.message}),h.dirty());else if("cuid"===i.kind)bk.test(a.data)||(ba(g=this._getOrReturnCtx(a,g),{validation:"cuid",code:a6.invalid_string,message:i.message}),h.dirty());else if("cuid2"===i.kind)bl.test(a.data)||(ba(g=this._getOrReturnCtx(a,g),{validation:"cuid2",code:a6.invalid_string,message:i.message}),h.dirty());else if("ulid"===i.kind)bm.test(a.data)||(ba(g=this._getOrReturnCtx(a,g),{validation:"ulid",code:a6.invalid_string,message:i.message}),h.dirty());else if("url"===i.kind)try{new URL(a.data)}catch{ba(g=this._getOrReturnCtx(a,g),{validation:"url",code:a6.invalid_string,message:i.message}),h.dirty()}else"regex"===i.kind?(i.regex.lastIndex=0,i.regex.test(a.data)||(ba(g=this._getOrReturnCtx(a,g),{validation:"regex",code:a6.invalid_string,message:i.message}),h.dirty())):"trim"===i.kind?a.data=a.data.trim():"includes"===i.kind?a.data.includes(i.value,i.position)||(ba(g=this._getOrReturnCtx(a,g),{code:a6.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),h.dirty()):"toLowerCase"===i.kind?a.data=a.data.toLowerCase():"toUpperCase"===i.kind?a.data=a.data.toUpperCase():"startsWith"===i.kind?a.data.startsWith(i.value)||(ba(g=this._getOrReturnCtx(a,g),{code:a6.invalid_string,validation:{startsWith:i.value},message:i.message}),h.dirty()):"endsWith"===i.kind?a.data.endsWith(i.value)||(ba(g=this._getOrReturnCtx(a,g),{code:a6.invalid_string,validation:{endsWith:i.value},message:i.message}),h.dirty()):"datetime"===i.kind?(function(a){let b=`${by}T${bA(a)}`,c=[];return c.push(a.local?"Z?":"Z"),a.offset&&c.push("([+-]\\d{2}:?\\d{2})"),b=`${b}(${c.join("|")})`,RegExp(`^${b}$`)})(i).test(a.data)||(ba(g=this._getOrReturnCtx(a,g),{code:a6.invalid_string,validation:"datetime",message:i.message}),h.dirty()):"date"===i.kind?bz.test(a.data)||(ba(g=this._getOrReturnCtx(a,g),{code:a6.invalid_string,validation:"date",message:i.message}),h.dirty()):"time"===i.kind?RegExp(`^${bA(i)}$`).test(a.data)||(ba(g=this._getOrReturnCtx(a,g),{code:a6.invalid_string,validation:"time",message:i.message}),h.dirty()):"duration"===i.kind?bq.test(a.data)||(ba(g=this._getOrReturnCtx(a,g),{validation:"duration",code:a6.invalid_string,message:i.message}),h.dirty()):"ip"===i.kind?(b=a.data,!(("v4"===(c=i.version)||!c)&&bs.test(b)||("v6"===c||!c)&&bu.test(b))&&1&&(ba(g=this._getOrReturnCtx(a,g),{validation:"ip",code:a6.invalid_string,message:i.message}),h.dirty())):"jwt"===i.kind?!function(a,b){if(!bp.test(a))return!1;try{let[c]=a.split(".");if(!c)return!1;let d=c.replace(/-/g,"+").replace(/_/g,"/").padEnd(c.length+(4-c.length%4)%4,"="),e=JSON.parse(atob(d));if("object"!=typeof e||null===e||"typ"in e&&e?.typ!=="JWT"||!e.alg||b&&e.alg!==b)return!1;return!0}catch{return!1}}(a.data,i.alg)&&(ba(g=this._getOrReturnCtx(a,g),{validation:"jwt",code:a6.invalid_string,message:i.message}),h.dirty()):"cidr"===i.kind?(e=a.data,!(("v4"===(f=i.version)||!f)&&bt.test(e)||("v6"===f||!f)&&bv.test(e))&&1&&(ba(g=this._getOrReturnCtx(a,g),{validation:"cidr",code:a6.invalid_string,message:i.message}),h.dirty())):"base64"===i.kind?bw.test(a.data)||(ba(g=this._getOrReturnCtx(a,g),{validation:"base64",code:a6.invalid_string,message:i.message}),h.dirty()):"base64url"===i.kind?bx.test(a.data)||(ba(g=this._getOrReturnCtx(a,g),{validation:"base64url",code:a6.invalid_string,message:i.message}),h.dirty()):q.assertNever(i);return{status:h.value,value:a.data}}_regex(a,b,c){return this.refinement(b=>a.test(b),{validation:b,code:a6.invalid_string,...s.errToObj(c)})}_addCheck(a){return new bB({...this._def,checks:[...this._def.checks,a]})}email(a){return this._addCheck({kind:"email",...s.errToObj(a)})}url(a){return this._addCheck({kind:"url",...s.errToObj(a)})}emoji(a){return this._addCheck({kind:"emoji",...s.errToObj(a)})}uuid(a){return this._addCheck({kind:"uuid",...s.errToObj(a)})}nanoid(a){return this._addCheck({kind:"nanoid",...s.errToObj(a)})}cuid(a){return this._addCheck({kind:"cuid",...s.errToObj(a)})}cuid2(a){return this._addCheck({kind:"cuid2",...s.errToObj(a)})}ulid(a){return this._addCheck({kind:"ulid",...s.errToObj(a)})}base64(a){return this._addCheck({kind:"base64",...s.errToObj(a)})}base64url(a){return this._addCheck({kind:"base64url",...s.errToObj(a)})}jwt(a){return this._addCheck({kind:"jwt",...s.errToObj(a)})}ip(a){return this._addCheck({kind:"ip",...s.errToObj(a)})}cidr(a){return this._addCheck({kind:"cidr",...s.errToObj(a)})}datetime(a){return"string"==typeof a?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:a}):this._addCheck({kind:"datetime",precision:void 0===a?.precision?null:a?.precision,offset:a?.offset??!1,local:a?.local??!1,...s.errToObj(a?.message)})}date(a){return this._addCheck({kind:"date",message:a})}time(a){return"string"==typeof a?this._addCheck({kind:"time",precision:null,message:a}):this._addCheck({kind:"time",precision:void 0===a?.precision?null:a?.precision,...s.errToObj(a?.message)})}duration(a){return this._addCheck({kind:"duration",...s.errToObj(a)})}regex(a,b){return this._addCheck({kind:"regex",regex:a,...s.errToObj(b)})}includes(a,b){return this._addCheck({kind:"includes",value:a,position:b?.position,...s.errToObj(b?.message)})}startsWith(a,b){return this._addCheck({kind:"startsWith",value:a,...s.errToObj(b)})}endsWith(a,b){return this._addCheck({kind:"endsWith",value:a,...s.errToObj(b)})}min(a,b){return this._addCheck({kind:"min",value:a,...s.errToObj(b)})}max(a,b){return this._addCheck({kind:"max",value:a,...s.errToObj(b)})}length(a,b){return this._addCheck({kind:"length",value:a,...s.errToObj(b)})}nonempty(a){return this.min(1,s.errToObj(a))}trim(){return new bB({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new bB({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new bB({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(a=>"datetime"===a.kind)}get isDate(){return!!this._def.checks.find(a=>"date"===a.kind)}get isTime(){return!!this._def.checks.find(a=>"time"===a.kind)}get isDuration(){return!!this._def.checks.find(a=>"duration"===a.kind)}get isEmail(){return!!this._def.checks.find(a=>"email"===a.kind)}get isURL(){return!!this._def.checks.find(a=>"url"===a.kind)}get isEmoji(){return!!this._def.checks.find(a=>"emoji"===a.kind)}get isUUID(){return!!this._def.checks.find(a=>"uuid"===a.kind)}get isNANOID(){return!!this._def.checks.find(a=>"nanoid"===a.kind)}get isCUID(){return!!this._def.checks.find(a=>"cuid"===a.kind)}get isCUID2(){return!!this._def.checks.find(a=>"cuid2"===a.kind)}get isULID(){return!!this._def.checks.find(a=>"ulid"===a.kind)}get isIP(){return!!this._def.checks.find(a=>"ip"===a.kind)}get isCIDR(){return!!this._def.checks.find(a=>"cidr"===a.kind)}get isBase64(){return!!this._def.checks.find(a=>"base64"===a.kind)}get isBase64url(){return!!this._def.checks.find(a=>"base64url"===a.kind)}get minLength(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxLength(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}}bB.create=a=>new bB({checks:[],typeName:t.ZodString,coerce:a?.coerce??!1,...bi(a)});class bC extends bj{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(a){let b;if(this._def.coerce&&(a.data=Number(a.data)),this._getType(a)!==a4.number){let b=this._getOrReturnCtx(a);return ba(b,{code:a6.invalid_type,expected:a4.number,received:b.parsedType}),bc}let c=new bb;for(let d of this._def.checks)"int"===d.kind?q.isInteger(a.data)||(ba(b=this._getOrReturnCtx(a,b),{code:a6.invalid_type,expected:"integer",received:"float",message:d.message}),c.dirty()):"min"===d.kind?(d.inclusive?a.data<d.value:a.data<=d.value)&&(ba(b=this._getOrReturnCtx(a,b),{code:a6.too_small,minimum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):"max"===d.kind?(d.inclusive?a.data>d.value:a.data>=d.value)&&(ba(b=this._getOrReturnCtx(a,b),{code:a6.too_big,maximum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):"multipleOf"===d.kind?0!==function(a,b){let c=(a.toString().split(".")[1]||"").length,d=(b.toString().split(".")[1]||"").length,e=c>d?c:d;return Number.parseInt(a.toFixed(e).replace(".",""))%Number.parseInt(b.toFixed(e).replace(".",""))/10**e}(a.data,d.value)&&(ba(b=this._getOrReturnCtx(a,b),{code:a6.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):"finite"===d.kind?Number.isFinite(a.data)||(ba(b=this._getOrReturnCtx(a,b),{code:a6.not_finite,message:d.message}),c.dirty()):q.assertNever(d);return{status:c.value,value:a.data}}gte(a,b){return this.setLimit("min",a,!0,s.toString(b))}gt(a,b){return this.setLimit("min",a,!1,s.toString(b))}lte(a,b){return this.setLimit("max",a,!0,s.toString(b))}lt(a,b){return this.setLimit("max",a,!1,s.toString(b))}setLimit(a,b,c,d){return new bC({...this._def,checks:[...this._def.checks,{kind:a,value:b,inclusive:c,message:s.toString(d)}]})}_addCheck(a){return new bC({...this._def,checks:[...this._def.checks,a]})}int(a){return this._addCheck({kind:"int",message:s.toString(a)})}positive(a){return this._addCheck({kind:"min",value:0,inclusive:!1,message:s.toString(a)})}negative(a){return this._addCheck({kind:"max",value:0,inclusive:!1,message:s.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:0,inclusive:!0,message:s.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:0,inclusive:!0,message:s.toString(a)})}multipleOf(a,b){return this._addCheck({kind:"multipleOf",value:a,message:s.toString(b)})}finite(a){return this._addCheck({kind:"finite",message:s.toString(a)})}safe(a){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:s.toString(a)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:s.toString(a)})}get minValue(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxValue(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}get isInt(){return!!this._def.checks.find(a=>"int"===a.kind||"multipleOf"===a.kind&&q.isInteger(a.value))}get isFinite(){let a=null,b=null;for(let c of this._def.checks)if("finite"===c.kind||"int"===c.kind||"multipleOf"===c.kind)return!0;else"min"===c.kind?(null===b||c.value>b)&&(b=c.value):"max"===c.kind&&(null===a||c.value<a)&&(a=c.value);return Number.isFinite(b)&&Number.isFinite(a)}}bC.create=a=>new bC({checks:[],typeName:t.ZodNumber,coerce:a?.coerce||!1,...bi(a)});class bD extends bj{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(a){let b;if(this._def.coerce)try{a.data=BigInt(a.data)}catch{return this._getInvalidInput(a)}if(this._getType(a)!==a4.bigint)return this._getInvalidInput(a);let c=new bb;for(let d of this._def.checks)"min"===d.kind?(d.inclusive?a.data<d.value:a.data<=d.value)&&(ba(b=this._getOrReturnCtx(a,b),{code:a6.too_small,type:"bigint",minimum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):"max"===d.kind?(d.inclusive?a.data>d.value:a.data>=d.value)&&(ba(b=this._getOrReturnCtx(a,b),{code:a6.too_big,type:"bigint",maximum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):"multipleOf"===d.kind?a.data%d.value!==BigInt(0)&&(ba(b=this._getOrReturnCtx(a,b),{code:a6.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):q.assertNever(d);return{status:c.value,value:a.data}}_getInvalidInput(a){let b=this._getOrReturnCtx(a);return ba(b,{code:a6.invalid_type,expected:a4.bigint,received:b.parsedType}),bc}gte(a,b){return this.setLimit("min",a,!0,s.toString(b))}gt(a,b){return this.setLimit("min",a,!1,s.toString(b))}lte(a,b){return this.setLimit("max",a,!0,s.toString(b))}lt(a,b){return this.setLimit("max",a,!1,s.toString(b))}setLimit(a,b,c,d){return new bD({...this._def,checks:[...this._def.checks,{kind:a,value:b,inclusive:c,message:s.toString(d)}]})}_addCheck(a){return new bD({...this._def,checks:[...this._def.checks,a]})}positive(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:s.toString(a)})}negative(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:s.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:s.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:s.toString(a)})}multipleOf(a,b){return this._addCheck({kind:"multipleOf",value:a,message:s.toString(b)})}get minValue(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxValue(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}}bD.create=a=>new bD({checks:[],typeName:t.ZodBigInt,coerce:a?.coerce??!1,...bi(a)});class bE extends bj{_parse(a){if(this._def.coerce&&(a.data=!!a.data),this._getType(a)!==a4.boolean){let b=this._getOrReturnCtx(a);return ba(b,{code:a6.invalid_type,expected:a4.boolean,received:b.parsedType}),bc}return be(a.data)}}bE.create=a=>new bE({typeName:t.ZodBoolean,coerce:a?.coerce||!1,...bi(a)});class bF extends bj{_parse(a){let b;if(this._def.coerce&&(a.data=new Date(a.data)),this._getType(a)!==a4.date){let b=this._getOrReturnCtx(a);return ba(b,{code:a6.invalid_type,expected:a4.date,received:b.parsedType}),bc}if(Number.isNaN(a.data.getTime()))return ba(this._getOrReturnCtx(a),{code:a6.invalid_date}),bc;let c=new bb;for(let d of this._def.checks)"min"===d.kind?a.data.getTime()<d.value&&(ba(b=this._getOrReturnCtx(a,b),{code:a6.too_small,message:d.message,inclusive:!0,exact:!1,minimum:d.value,type:"date"}),c.dirty()):"max"===d.kind?a.data.getTime()>d.value&&(ba(b=this._getOrReturnCtx(a,b),{code:a6.too_big,message:d.message,inclusive:!0,exact:!1,maximum:d.value,type:"date"}),c.dirty()):q.assertNever(d);return{status:c.value,value:new Date(a.data.getTime())}}_addCheck(a){return new bF({...this._def,checks:[...this._def.checks,a]})}min(a,b){return this._addCheck({kind:"min",value:a.getTime(),message:s.toString(b)})}max(a,b){return this._addCheck({kind:"max",value:a.getTime(),message:s.toString(b)})}get minDate(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return null!=a?new Date(a):null}get maxDate(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return null!=a?new Date(a):null}}bF.create=a=>new bF({checks:[],coerce:a?.coerce||!1,typeName:t.ZodDate,...bi(a)});class bG extends bj{_parse(a){if(this._getType(a)!==a4.symbol){let b=this._getOrReturnCtx(a);return ba(b,{code:a6.invalid_type,expected:a4.symbol,received:b.parsedType}),bc}return be(a.data)}}bG.create=a=>new bG({typeName:t.ZodSymbol,...bi(a)});class bH extends bj{_parse(a){if(this._getType(a)!==a4.undefined){let b=this._getOrReturnCtx(a);return ba(b,{code:a6.invalid_type,expected:a4.undefined,received:b.parsedType}),bc}return be(a.data)}}bH.create=a=>new bH({typeName:t.ZodUndefined,...bi(a)});class bI extends bj{_parse(a){if(this._getType(a)!==a4.null){let b=this._getOrReturnCtx(a);return ba(b,{code:a6.invalid_type,expected:a4.null,received:b.parsedType}),bc}return be(a.data)}}bI.create=a=>new bI({typeName:t.ZodNull,...bi(a)});class bJ extends bj{constructor(){super(...arguments),this._any=!0}_parse(a){return be(a.data)}}bJ.create=a=>new bJ({typeName:t.ZodAny,...bi(a)});class bK extends bj{constructor(){super(...arguments),this._unknown=!0}_parse(a){return be(a.data)}}bK.create=a=>new bK({typeName:t.ZodUnknown,...bi(a)});class bL extends bj{_parse(a){let b=this._getOrReturnCtx(a);return ba(b,{code:a6.invalid_type,expected:a4.never,received:b.parsedType}),bc}}bL.create=a=>new bL({typeName:t.ZodNever,...bi(a)});class bM extends bj{_parse(a){if(this._getType(a)!==a4.undefined){let b=this._getOrReturnCtx(a);return ba(b,{code:a6.invalid_type,expected:a4.void,received:b.parsedType}),bc}return be(a.data)}}bM.create=a=>new bM({typeName:t.ZodVoid,...bi(a)});class bN extends bj{_parse(a){let{ctx:b,status:c}=this._processInputParams(a),d=this._def;if(b.parsedType!==a4.array)return ba(b,{code:a6.invalid_type,expected:a4.array,received:b.parsedType}),bc;if(null!==d.exactLength){let a=b.data.length>d.exactLength.value,e=b.data.length<d.exactLength.value;(a||e)&&(ba(b,{code:a?a6.too_big:a6.too_small,minimum:e?d.exactLength.value:void 0,maximum:a?d.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:d.exactLength.message}),c.dirty())}if(null!==d.minLength&&b.data.length<d.minLength.value&&(ba(b,{code:a6.too_small,minimum:d.minLength.value,type:"array",inclusive:!0,exact:!1,message:d.minLength.message}),c.dirty()),null!==d.maxLength&&b.data.length>d.maxLength.value&&(ba(b,{code:a6.too_big,maximum:d.maxLength.value,type:"array",inclusive:!0,exact:!1,message:d.maxLength.message}),c.dirty()),b.common.async)return Promise.all([...b.data].map((a,c)=>d.type._parseAsync(new bg(b,a,b.path,c)))).then(a=>bb.mergeArray(c,a));let e=[...b.data].map((a,c)=>d.type._parseSync(new bg(b,a,b.path,c)));return bb.mergeArray(c,e)}get element(){return this._def.type}min(a,b){return new bN({...this._def,minLength:{value:a,message:s.toString(b)}})}max(a,b){return new bN({...this._def,maxLength:{value:a,message:s.toString(b)}})}length(a,b){return new bN({...this._def,exactLength:{value:a,message:s.toString(b)}})}nonempty(a){return this.min(1,a)}}bN.create=(a,b)=>new bN({type:a,minLength:null,maxLength:null,exactLength:null,typeName:t.ZodArray,...bi(b)});class bO extends bj{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let a=this._def.shape(),b=q.objectKeys(a);return this._cached={shape:a,keys:b},this._cached}_parse(a){if(this._getType(a)!==a4.object){let b=this._getOrReturnCtx(a);return ba(b,{code:a6.invalid_type,expected:a4.object,received:b.parsedType}),bc}let{status:b,ctx:c}=this._processInputParams(a),{shape:d,keys:e}=this._getCached(),f=[];if(!(this._def.catchall instanceof bL&&"strip"===this._def.unknownKeys))for(let a in c.data)e.includes(a)||f.push(a);let g=[];for(let a of e){let b=d[a],e=c.data[a];g.push({key:{status:"valid",value:a},value:b._parse(new bg(c,e,c.path,a)),alwaysSet:a in c.data})}if(this._def.catchall instanceof bL){let a=this._def.unknownKeys;if("passthrough"===a)for(let a of f)g.push({key:{status:"valid",value:a},value:{status:"valid",value:c.data[a]}});else if("strict"===a)f.length>0&&(ba(c,{code:a6.unrecognized_keys,keys:f}),b.dirty());else if("strip"===a);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let a=this._def.catchall;for(let b of f){let d=c.data[b];g.push({key:{status:"valid",value:b},value:a._parse(new bg(c,d,c.path,b)),alwaysSet:b in c.data})}}return c.common.async?Promise.resolve().then(async()=>{let a=[];for(let b of g){let c=await b.key,d=await b.value;a.push({key:c,value:d,alwaysSet:b.alwaysSet})}return a}).then(a=>bb.mergeObjectSync(b,a)):bb.mergeObjectSync(b,g)}get shape(){return this._def.shape()}strict(a){return s.errToObj,new bO({...this._def,unknownKeys:"strict",...void 0!==a?{errorMap:(b,c)=>{let d=this._def.errorMap?.(b,c).message??c.defaultError;return"unrecognized_keys"===b.code?{message:s.errToObj(a).message??d}:{message:d}}}:{}})}strip(){return new bO({...this._def,unknownKeys:"strip"})}passthrough(){return new bO({...this._def,unknownKeys:"passthrough"})}extend(a){return new bO({...this._def,shape:()=>({...this._def.shape(),...a})})}merge(a){return new bO({unknownKeys:a._def.unknownKeys,catchall:a._def.catchall,shape:()=>({...this._def.shape(),...a._def.shape()}),typeName:t.ZodObject})}setKey(a,b){return this.augment({[a]:b})}catchall(a){return new bO({...this._def,catchall:a})}pick(a){let b={};for(let c of q.objectKeys(a))a[c]&&this.shape[c]&&(b[c]=this.shape[c]);return new bO({...this._def,shape:()=>b})}omit(a){let b={};for(let c of q.objectKeys(this.shape))a[c]||(b[c]=this.shape[c]);return new bO({...this._def,shape:()=>b})}deepPartial(){return function a(b){if(b instanceof bO){let c={};for(let d in b.shape){let e=b.shape[d];c[d]=b3.create(a(e))}return new bO({...b._def,shape:()=>c})}if(b instanceof bN)return new bN({...b._def,type:a(b.element)});if(b instanceof b3)return b3.create(a(b.unwrap()));if(b instanceof b4)return b4.create(a(b.unwrap()));if(b instanceof bT)return bT.create(b.items.map(b=>a(b)));else return b}(this)}partial(a){let b={};for(let c of q.objectKeys(this.shape)){let d=this.shape[c];a&&!a[c]?b[c]=d:b[c]=d.optional()}return new bO({...this._def,shape:()=>b})}required(a){let b={};for(let c of q.objectKeys(this.shape))if(a&&!a[c])b[c]=this.shape[c];else{let a=this.shape[c];for(;a instanceof b3;)a=a._def.innerType;b[c]=a}return new bO({...this._def,shape:()=>b})}keyof(){return b$(q.objectKeys(this.shape))}}bO.create=(a,b)=>new bO({shape:()=>a,unknownKeys:"strip",catchall:bL.create(),typeName:t.ZodObject,...bi(b)}),bO.strictCreate=(a,b)=>new bO({shape:()=>a,unknownKeys:"strict",catchall:bL.create(),typeName:t.ZodObject,...bi(b)}),bO.lazycreate=(a,b)=>new bO({shape:a,unknownKeys:"strip",catchall:bL.create(),typeName:t.ZodObject,...bi(b)});class bP extends bj{_parse(a){let{ctx:b}=this._processInputParams(a),c=this._def.options;if(b.common.async)return Promise.all(c.map(async a=>{let c={...b,common:{...b.common,issues:[]},parent:null};return{result:await a._parseAsync({data:b.data,path:b.path,parent:c}),ctx:c}})).then(function(a){for(let b of a)if("valid"===b.result.status)return b.result;for(let c of a)if("dirty"===c.result.status)return b.common.issues.push(...c.ctx.common.issues),c.result;let c=a.map(a=>new a7(a.ctx.common.issues));return ba(b,{code:a6.invalid_union,unionErrors:c}),bc});{let a,d=[];for(let e of c){let c={...b,common:{...b.common,issues:[]},parent:null},f=e._parseSync({data:b.data,path:b.path,parent:c});if("valid"===f.status)return f;"dirty"!==f.status||a||(a={result:f,ctx:c}),c.common.issues.length&&d.push(c.common.issues)}if(a)return b.common.issues.push(...a.ctx.common.issues),a.result;let e=d.map(a=>new a7(a));return ba(b,{code:a6.invalid_union,unionErrors:e}),bc}}get options(){return this._def.options}}bP.create=(a,b)=>new bP({options:a,typeName:t.ZodUnion,...bi(b)});let bQ=a=>{if(a instanceof bY)return bQ(a.schema);if(a instanceof b2)return bQ(a.innerType());if(a instanceof bZ)return[a.value];if(a instanceof b_)return a.options;if(a instanceof b0)return q.objectValues(a.enum);else if(a instanceof b5)return bQ(a._def.innerType);else if(a instanceof bH)return[void 0];else if(a instanceof bI)return[null];else if(a instanceof b3)return[void 0,...bQ(a.unwrap())];else if(a instanceof b4)return[null,...bQ(a.unwrap())];else if(a instanceof b8)return bQ(a.unwrap());else if(a instanceof ca)return bQ(a.unwrap());else if(a instanceof b6)return bQ(a._def.innerType);else return[]};class bR extends bj{_parse(a){let{ctx:b}=this._processInputParams(a);if(b.parsedType!==a4.object)return ba(b,{code:a6.invalid_type,expected:a4.object,received:b.parsedType}),bc;let c=this.discriminator,d=b.data[c],e=this.optionsMap.get(d);return e?b.common.async?e._parseAsync({data:b.data,path:b.path,parent:b}):e._parseSync({data:b.data,path:b.path,parent:b}):(ba(b,{code:a6.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[c]}),bc)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(a,b,c){let d=new Map;for(let c of b){let b=bQ(c.shape[a]);if(!b.length)throw Error(`A discriminator value for key \`${a}\` could not be extracted from all schema options`);for(let e of b){if(d.has(e))throw Error(`Discriminator property ${String(a)} has duplicate value ${String(e)}`);d.set(e,c)}}return new bR({typeName:t.ZodDiscriminatedUnion,discriminator:a,options:b,optionsMap:d,...bi(c)})}}class bS extends bj{_parse(a){let{status:b,ctx:c}=this._processInputParams(a),d=(a,d)=>{if("aborted"===a.status||"aborted"===d.status)return bc;let e=function a(b,c){let d=a5(b),e=a5(c);if(b===c)return{valid:!0,data:b};if(d===a4.object&&e===a4.object){let d=q.objectKeys(c),e=q.objectKeys(b).filter(a=>-1!==d.indexOf(a)),f={...b,...c};for(let d of e){let e=a(b[d],c[d]);if(!e.valid)return{valid:!1};f[d]=e.data}return{valid:!0,data:f}}if(d===a4.array&&e===a4.array){if(b.length!==c.length)return{valid:!1};let d=[];for(let e=0;e<b.length;e++){let f=a(b[e],c[e]);if(!f.valid)return{valid:!1};d.push(f.data)}return{valid:!0,data:d}}if(d===a4.date&&e===a4.date&&+b==+c)return{valid:!0,data:b};return{valid:!1}}(a.value,d.value);return e.valid?(("dirty"===a.status||"dirty"===d.status)&&b.dirty(),{status:b.value,value:e.data}):(ba(c,{code:a6.invalid_intersection_types}),bc)};return c.common.async?Promise.all([this._def.left._parseAsync({data:c.data,path:c.path,parent:c}),this._def.right._parseAsync({data:c.data,path:c.path,parent:c})]).then(([a,b])=>d(a,b)):d(this._def.left._parseSync({data:c.data,path:c.path,parent:c}),this._def.right._parseSync({data:c.data,path:c.path,parent:c}))}}bS.create=(a,b,c)=>new bS({left:a,right:b,typeName:t.ZodIntersection,...bi(c)});class bT extends bj{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==a4.array)return ba(c,{code:a6.invalid_type,expected:a4.array,received:c.parsedType}),bc;if(c.data.length<this._def.items.length)return ba(c,{code:a6.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),bc;!this._def.rest&&c.data.length>this._def.items.length&&(ba(c,{code:a6.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),b.dirty());let d=[...c.data].map((a,b)=>{let d=this._def.items[b]||this._def.rest;return d?d._parse(new bg(c,a,c.path,b)):null}).filter(a=>!!a);return c.common.async?Promise.all(d).then(a=>bb.mergeArray(b,a)):bb.mergeArray(b,d)}get items(){return this._def.items}rest(a){return new bT({...this._def,rest:a})}}bT.create=(a,b)=>{if(!Array.isArray(a))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new bT({items:a,typeName:t.ZodTuple,rest:null,...bi(b)})};class bU extends bj{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==a4.object)return ba(c,{code:a6.invalid_type,expected:a4.object,received:c.parsedType}),bc;let d=[],e=this._def.keyType,f=this._def.valueType;for(let a in c.data)d.push({key:e._parse(new bg(c,a,c.path,a)),value:f._parse(new bg(c,c.data[a],c.path,a)),alwaysSet:a in c.data});return c.common.async?bb.mergeObjectAsync(b,d):bb.mergeObjectSync(b,d)}get element(){return this._def.valueType}static create(a,b,c){return new bU(b instanceof bj?{keyType:a,valueType:b,typeName:t.ZodRecord,...bi(c)}:{keyType:bB.create(),valueType:a,typeName:t.ZodRecord,...bi(b)})}}class bV extends bj{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==a4.map)return ba(c,{code:a6.invalid_type,expected:a4.map,received:c.parsedType}),bc;let d=this._def.keyType,e=this._def.valueType,f=[...c.data.entries()].map(([a,b],f)=>({key:d._parse(new bg(c,a,c.path,[f,"key"])),value:e._parse(new bg(c,b,c.path,[f,"value"]))}));if(c.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of f){let d=await c.key,e=await c.value;if("aborted"===d.status||"aborted"===e.status)return bc;("dirty"===d.status||"dirty"===e.status)&&b.dirty(),a.set(d.value,e.value)}return{status:b.value,value:a}})}{let a=new Map;for(let c of f){let d=c.key,e=c.value;if("aborted"===d.status||"aborted"===e.status)return bc;("dirty"===d.status||"dirty"===e.status)&&b.dirty(),a.set(d.value,e.value)}return{status:b.value,value:a}}}}bV.create=(a,b,c)=>new bV({valueType:b,keyType:a,typeName:t.ZodMap,...bi(c)});class bW extends bj{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==a4.set)return ba(c,{code:a6.invalid_type,expected:a4.set,received:c.parsedType}),bc;let d=this._def;null!==d.minSize&&c.data.size<d.minSize.value&&(ba(c,{code:a6.too_small,minimum:d.minSize.value,type:"set",inclusive:!0,exact:!1,message:d.minSize.message}),b.dirty()),null!==d.maxSize&&c.data.size>d.maxSize.value&&(ba(c,{code:a6.too_big,maximum:d.maxSize.value,type:"set",inclusive:!0,exact:!1,message:d.maxSize.message}),b.dirty());let e=this._def.valueType;function f(a){let c=new Set;for(let d of a){if("aborted"===d.status)return bc;"dirty"===d.status&&b.dirty(),c.add(d.value)}return{status:b.value,value:c}}let g=[...c.data.values()].map((a,b)=>e._parse(new bg(c,a,c.path,b)));return c.common.async?Promise.all(g).then(a=>f(a)):f(g)}min(a,b){return new bW({...this._def,minSize:{value:a,message:s.toString(b)}})}max(a,b){return new bW({...this._def,maxSize:{value:a,message:s.toString(b)}})}size(a,b){return this.min(a,b).max(a,b)}nonempty(a){return this.min(1,a)}}bW.create=(a,b)=>new bW({valueType:a,minSize:null,maxSize:null,typeName:t.ZodSet,...bi(b)});class bX extends bj{constructor(){super(...arguments),this.validate=this.implement}_parse(a){let{ctx:b}=this._processInputParams(a);if(b.parsedType!==a4.function)return ba(b,{code:a6.invalid_type,expected:a4.function,received:b.parsedType}),bc;function c(a,c){return a9({data:a,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,a8,a8].filter(a=>!!a),issueData:{code:a6.invalid_arguments,argumentsError:c}})}function d(a,c){return a9({data:a,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,a8,a8].filter(a=>!!a),issueData:{code:a6.invalid_return_type,returnTypeError:c}})}let e={errorMap:b.common.contextualErrorMap},f=b.data;if(this._def.returns instanceof b1){let a=this;return be(async function(...b){let g=new a7([]),h=await a._def.args.parseAsync(b,e).catch(a=>{throw g.addIssue(c(b,a)),g}),i=await Reflect.apply(f,this,h);return await a._def.returns._def.type.parseAsync(i,e).catch(a=>{throw g.addIssue(d(i,a)),g})})}{let a=this;return be(function(...b){let g=a._def.args.safeParse(b,e);if(!g.success)throw new a7([c(b,g.error)]);let h=Reflect.apply(f,this,g.data),i=a._def.returns.safeParse(h,e);if(!i.success)throw new a7([d(h,i.error)]);return i.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...a){return new bX({...this._def,args:bT.create(a).rest(bK.create())})}returns(a){return new bX({...this._def,returns:a})}implement(a){return this.parse(a)}strictImplement(a){return this.parse(a)}static create(a,b,c){return new bX({args:a||bT.create([]).rest(bK.create()),returns:b||bK.create(),typeName:t.ZodFunction,...bi(c)})}}class bY extends bj{get schema(){return this._def.getter()}_parse(a){let{ctx:b}=this._processInputParams(a);return this._def.getter()._parse({data:b.data,path:b.path,parent:b})}}bY.create=(a,b)=>new bY({getter:a,typeName:t.ZodLazy,...bi(b)});class bZ extends bj{_parse(a){if(a.data!==this._def.value){let b=this._getOrReturnCtx(a);return ba(b,{received:b.data,code:a6.invalid_literal,expected:this._def.value}),bc}return{status:"valid",value:a.data}}get value(){return this._def.value}}function b$(a,b){return new b_({values:a,typeName:t.ZodEnum,...bi(b)})}bZ.create=(a,b)=>new bZ({value:a,typeName:t.ZodLiteral,...bi(b)});class b_ extends bj{_parse(a){if("string"!=typeof a.data){let b=this._getOrReturnCtx(a),c=this._def.values;return ba(b,{expected:q.joinValues(c),received:b.parsedType,code:a6.invalid_type}),bc}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(a.data)){let b=this._getOrReturnCtx(a),c=this._def.values;return ba(b,{received:b.data,code:a6.invalid_enum_value,options:c}),bc}return be(a.data)}get options(){return this._def.values}get enum(){let a={};for(let b of this._def.values)a[b]=b;return a}get Values(){let a={};for(let b of this._def.values)a[b]=b;return a}get Enum(){let a={};for(let b of this._def.values)a[b]=b;return a}extract(a,b=this._def){return b_.create(a,{...this._def,...b})}exclude(a,b=this._def){return b_.create(this.options.filter(b=>!a.includes(b)),{...this._def,...b})}}b_.create=b$;class b0 extends bj{_parse(a){let b=q.getValidEnumValues(this._def.values),c=this._getOrReturnCtx(a);if(c.parsedType!==a4.string&&c.parsedType!==a4.number){let a=q.objectValues(b);return ba(c,{expected:q.joinValues(a),received:c.parsedType,code:a6.invalid_type}),bc}if(this._cache||(this._cache=new Set(q.getValidEnumValues(this._def.values))),!this._cache.has(a.data)){let a=q.objectValues(b);return ba(c,{received:c.data,code:a6.invalid_enum_value,options:a}),bc}return be(a.data)}get enum(){return this._def.values}}b0.create=(a,b)=>new b0({values:a,typeName:t.ZodNativeEnum,...bi(b)});class b1 extends bj{unwrap(){return this._def.type}_parse(a){let{ctx:b}=this._processInputParams(a);return b.parsedType!==a4.promise&&!1===b.common.async?(ba(b,{code:a6.invalid_type,expected:a4.promise,received:b.parsedType}),bc):be((b.parsedType===a4.promise?b.data:Promise.resolve(b.data)).then(a=>this._def.type.parseAsync(a,{path:b.path,errorMap:b.common.contextualErrorMap})))}}b1.create=(a,b)=>new b1({type:a,typeName:t.ZodPromise,...bi(b)});class b2 extends bj{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===t.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(a){let{status:b,ctx:c}=this._processInputParams(a),d=this._def.effect||null,e={addIssue:a=>{ba(c,a),a.fatal?b.abort():b.dirty()},get path(){return c.path}};if(e.addIssue=e.addIssue.bind(e),"preprocess"===d.type){let a=d.transform(c.data,e);if(c.common.async)return Promise.resolve(a).then(async a=>{if("aborted"===b.value)return bc;let d=await this._def.schema._parseAsync({data:a,path:c.path,parent:c});return"aborted"===d.status?bc:"dirty"===d.status||"dirty"===b.value?bd(d.value):d});{if("aborted"===b.value)return bc;let d=this._def.schema._parseSync({data:a,path:c.path,parent:c});return"aborted"===d.status?bc:"dirty"===d.status||"dirty"===b.value?bd(d.value):d}}if("refinement"===d.type){let a=a=>{let b=d.refinement(a,e);if(c.common.async)return Promise.resolve(b);if(b instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(!1!==c.common.async)return this._def.schema._parseAsync({data:c.data,path:c.path,parent:c}).then(c=>"aborted"===c.status?bc:("dirty"===c.status&&b.dirty(),a(c.value).then(()=>({status:b.value,value:c.value}))));{let d=this._def.schema._parseSync({data:c.data,path:c.path,parent:c});return"aborted"===d.status?bc:("dirty"===d.status&&b.dirty(),a(d.value),{status:b.value,value:d.value})}}if("transform"===d.type)if(!1!==c.common.async)return this._def.schema._parseAsync({data:c.data,path:c.path,parent:c}).then(a=>"valid"!==a.status?bc:Promise.resolve(d.transform(a.value,e)).then(a=>({status:b.value,value:a})));else{let a=this._def.schema._parseSync({data:c.data,path:c.path,parent:c});if("valid"!==a.status)return bc;let f=d.transform(a.value,e);if(f instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:b.value,value:f}}q.assertNever(d)}}b2.create=(a,b,c)=>new b2({schema:a,typeName:t.ZodEffects,effect:b,...bi(c)}),b2.createWithPreprocess=(a,b,c)=>new b2({schema:b,effect:{type:"preprocess",transform:a},typeName:t.ZodEffects,...bi(c)});class b3 extends bj{_parse(a){return this._getType(a)===a4.undefined?be(void 0):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}b3.create=(a,b)=>new b3({innerType:a,typeName:t.ZodOptional,...bi(b)});class b4 extends bj{_parse(a){return this._getType(a)===a4.null?be(null):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}b4.create=(a,b)=>new b4({innerType:a,typeName:t.ZodNullable,...bi(b)});class b5 extends bj{_parse(a){let{ctx:b}=this._processInputParams(a),c=b.data;return b.parsedType===a4.undefined&&(c=this._def.defaultValue()),this._def.innerType._parse({data:c,path:b.path,parent:b})}removeDefault(){return this._def.innerType}}b5.create=(a,b)=>new b5({innerType:a,typeName:t.ZodDefault,defaultValue:"function"==typeof b.default?b.default:()=>b.default,...bi(b)});class b6 extends bj{_parse(a){let{ctx:b}=this._processInputParams(a),c={...b,common:{...b.common,issues:[]}},d=this._def.innerType._parse({data:c.data,path:c.path,parent:{...c}});return bf(d)?d.then(a=>({status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new a7(c.common.issues)},input:c.data})})):{status:"valid",value:"valid"===d.status?d.value:this._def.catchValue({get error(){return new a7(c.common.issues)},input:c.data})}}removeCatch(){return this._def.innerType}}b6.create=(a,b)=>new b6({innerType:a,typeName:t.ZodCatch,catchValue:"function"==typeof b.catch?b.catch:()=>b.catch,...bi(b)});class b7 extends bj{_parse(a){if(this._getType(a)!==a4.nan){let b=this._getOrReturnCtx(a);return ba(b,{code:a6.invalid_type,expected:a4.nan,received:b.parsedType}),bc}return{status:"valid",value:a.data}}}b7.create=a=>new b7({typeName:t.ZodNaN,...bi(a)}),Symbol("zod_brand");class b8 extends bj{_parse(a){let{ctx:b}=this._processInputParams(a),c=b.data;return this._def.type._parse({data:c,path:b.path,parent:b})}unwrap(){return this._def.type}}class b9 extends bj{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.common.async)return(async()=>{let a=await this._def.in._parseAsync({data:c.data,path:c.path,parent:c});return"aborted"===a.status?bc:"dirty"===a.status?(b.dirty(),bd(a.value)):this._def.out._parseAsync({data:a.value,path:c.path,parent:c})})();{let a=this._def.in._parseSync({data:c.data,path:c.path,parent:c});return"aborted"===a.status?bc:"dirty"===a.status?(b.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:c.path,parent:c})}}static create(a,b){return new b9({in:a,out:b,typeName:t.ZodPipeline})}}class ca extends bj{_parse(a){let b=this._def.innerType._parse(a),c=a=>("valid"===a.status&&(a.value=Object.freeze(a.value)),a);return bf(b)?b.then(a=>c(a)):c(b)}unwrap(){return this._def.innerType}}ca.create=(a,b)=>new ca({innerType:a,typeName:t.ZodReadonly,...bi(b)}),bO.lazycreate,function(a){a.ZodString="ZodString",a.ZodNumber="ZodNumber",a.ZodNaN="ZodNaN",a.ZodBigInt="ZodBigInt",a.ZodBoolean="ZodBoolean",a.ZodDate="ZodDate",a.ZodSymbol="ZodSymbol",a.ZodUndefined="ZodUndefined",a.ZodNull="ZodNull",a.ZodAny="ZodAny",a.ZodUnknown="ZodUnknown",a.ZodNever="ZodNever",a.ZodVoid="ZodVoid",a.ZodArray="ZodArray",a.ZodObject="ZodObject",a.ZodUnion="ZodUnion",a.ZodDiscriminatedUnion="ZodDiscriminatedUnion",a.ZodIntersection="ZodIntersection",a.ZodTuple="ZodTuple",a.ZodRecord="ZodRecord",a.ZodMap="ZodMap",a.ZodSet="ZodSet",a.ZodFunction="ZodFunction",a.ZodLazy="ZodLazy",a.ZodLiteral="ZodLiteral",a.ZodEnum="ZodEnum",a.ZodEffects="ZodEffects",a.ZodNativeEnum="ZodNativeEnum",a.ZodOptional="ZodOptional",a.ZodNullable="ZodNullable",a.ZodDefault="ZodDefault",a.ZodCatch="ZodCatch",a.ZodPromise="ZodPromise",a.ZodBranded="ZodBranded",a.ZodPipeline="ZodPipeline",a.ZodReadonly="ZodReadonly"}(t||(t={})),bB.create,bC.create,b7.create,bD.create,bE.create,bF.create,bG.create,bH.create,bI.create,bJ.create,bK.create,bL.create,bM.create,bN.create,bO.create,bO.strictCreate,bP.create,bR.create,bS.create,bT.create,bU.create,bV.create,bW.create,bX.create,bY.create,bZ.create,b_.create,b0.create,b1.create,b2.create,b3.create,b4.create,b2.createWithPreprocess,b9.create;let cb=(a,b)=>{let c=0;for(;c<a.length&&c<b.length&&a[c]===b[c];c++);return[(a.length-c).toString(),...b.slice(c)].join("/")};function cc(a){if("openAi"!==a.target)return{};let b=[...a.basePath,a.definitionPath,a.openAiAnyTypeName];return a.flags.hasReferencedOpenAiAnyType=!0,{$ref:"relative"===a.$refStrategy?cb(b,a.currentPath):b.join("/")}}function cd(a,b,c,d){d?.errorMessages&&c&&(a.errorMessage={...a.errorMessage,[b]:c})}function ce(a,b,c,d,e){a[b]=c,cd(a,b,d,e)}function cf(a,b){return cq(a.type._def,b)}let cg={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(void 0===e&&(e=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),e),ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function ch(a,b){let c={type:"string"};if(a.checks)for(let d of a.checks)switch(d.kind){case"min":ce(c,"minLength","number"==typeof c.minLength?Math.max(c.minLength,d.value):d.value,d.message,b);break;case"max":ce(c,"maxLength","number"==typeof c.maxLength?Math.min(c.maxLength,d.value):d.value,d.message,b);break;case"email":switch(b.emailStrategy){case"format:email":ck(c,"email",d.message,b);break;case"format:idn-email":ck(c,"idn-email",d.message,b);break;case"pattern:zod":cl(c,cg.email,d.message,b)}break;case"url":ck(c,"uri",d.message,b);break;case"uuid":ck(c,"uuid",d.message,b);break;case"regex":cl(c,d.regex,d.message,b);break;case"cuid":cl(c,cg.cuid,d.message,b);break;case"cuid2":cl(c,cg.cuid2,d.message,b);break;case"startsWith":cl(c,RegExp(`^${ci(d.value,b)}`),d.message,b);break;case"endsWith":cl(c,RegExp(`${ci(d.value,b)}$`),d.message,b);break;case"datetime":ck(c,"date-time",d.message,b);break;case"date":ck(c,"date",d.message,b);break;case"time":ck(c,"time",d.message,b);break;case"duration":ck(c,"duration",d.message,b);break;case"length":ce(c,"minLength","number"==typeof c.minLength?Math.max(c.minLength,d.value):d.value,d.message,b),ce(c,"maxLength","number"==typeof c.maxLength?Math.min(c.maxLength,d.value):d.value,d.message,b);break;case"includes":cl(c,RegExp(ci(d.value,b)),d.message,b);break;case"ip":"v6"!==d.version&&ck(c,"ipv4",d.message,b),"v4"!==d.version&&ck(c,"ipv6",d.message,b);break;case"base64url":cl(c,cg.base64url,d.message,b);break;case"jwt":cl(c,cg.jwt,d.message,b);break;case"cidr":"v6"!==d.version&&cl(c,cg.ipv4Cidr,d.message,b),"v4"!==d.version&&cl(c,cg.ipv6Cidr,d.message,b);break;case"emoji":cl(c,cg.emoji(),d.message,b);break;case"ulid":cl(c,cg.ulid,d.message,b);break;case"base64":switch(b.base64Strategy){case"format:binary":ck(c,"binary",d.message,b);break;case"contentEncoding:base64":ce(c,"contentEncoding","base64",d.message,b);break;case"pattern:zod":cl(c,cg.base64,d.message,b)}break;case"nanoid":cl(c,cg.nanoid,d.message,b)}return c}function ci(a,b){return"escape"===b.patternStrategy?function(a){let b="";for(let c=0;c<a.length;c++)cj.has(a[c])||(b+="\\"),b+=a[c];return b}(a):a}let cj=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function ck(a,b,c,d){a.format||a.anyOf?.some(a=>a.format)?(a.anyOf||(a.anyOf=[]),a.format&&(a.anyOf.push({format:a.format,...a.errorMessage&&d.errorMessages&&{errorMessage:{format:a.errorMessage.format}}}),delete a.format,a.errorMessage&&(delete a.errorMessage.format,0===Object.keys(a.errorMessage).length&&delete a.errorMessage)),a.anyOf.push({format:b,...c&&d.errorMessages&&{errorMessage:{format:c}}})):ce(a,"format",b,c,d)}function cl(a,b,c,d){a.pattern||a.allOf?.some(a=>a.pattern)?(a.allOf||(a.allOf=[]),a.pattern&&(a.allOf.push({pattern:a.pattern,...a.errorMessage&&d.errorMessages&&{errorMessage:{pattern:a.errorMessage.pattern}}}),delete a.pattern,a.errorMessage&&(delete a.errorMessage.pattern,0===Object.keys(a.errorMessage).length&&delete a.errorMessage)),a.allOf.push({pattern:cm(b,d),...c&&d.errorMessages&&{errorMessage:{pattern:c}}})):ce(a,"pattern",cm(b,d),c,d)}function cm(a,b){if(!b.applyRegexFlags||!a.flags)return a.source;let c={i:a.flags.includes("i"),m:a.flags.includes("m"),s:a.flags.includes("s")},d=c.i?a.source.toLowerCase():a.source,e="",f=!1,g=!1,h=!1;for(let a=0;a<d.length;a++){if(f){e+=d[a],f=!1;continue}if(c.i){if(g){if(d[a].match(/[a-z]/)){h?(e+=d[a],e+=`${d[a-2]}-${d[a]}`.toUpperCase(),h=!1):"-"===d[a+1]&&d[a+2]?.match(/[a-z]/)?(e+=d[a],h=!0):e+=`${d[a]}${d[a].toUpperCase()}`;continue}}else if(d[a].match(/[a-z]/)){e+=`[${d[a]}${d[a].toUpperCase()}]`;continue}}if(c.m){if("^"===d[a]){e+=`(^|(?<=[\r
]))`;continue}else if("$"===d[a]){e+=`($|(?=[\r
]))`;continue}}if(c.s&&"."===d[a]){e+=g?`${d[a]}\r
`:`[${d[a]}\r
]`;continue}e+=d[a],"\\"===d[a]?f=!0:g&&"]"===d[a]?g=!1:g||"["!==d[a]||(g=!0)}try{new RegExp(e)}catch{return console.warn(`Could not convert regex pattern at ${b.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),a.source}return e}function cn(a,b){if("openAi"===b.target&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),"openApi3"===b.target&&a.keyType?._def.typeName===t.ZodEnum)return{type:"object",required:a.keyType._def.values,properties:a.keyType._def.values.reduce((c,d)=>({...c,[d]:cq(a.valueType._def,{...b,currentPath:[...b.currentPath,"properties",d]})??cc(b)}),{}),additionalProperties:b.rejectedAdditionalProperties};let c={type:"object",additionalProperties:cq(a.valueType._def,{...b,currentPath:[...b.currentPath,"additionalProperties"]})??b.allowedAdditionalProperties};if("openApi3"===b.target)return c;if(a.keyType?._def.typeName===t.ZodString&&a.keyType._def.checks?.length){let{type:d,...e}=ch(a.keyType._def,b);return{...c,propertyNames:e}}if(a.keyType?._def.typeName===t.ZodEnum)return{...c,propertyNames:{enum:a.keyType._def.values}};if(a.keyType?._def.typeName===t.ZodBranded&&a.keyType._def.type._def.typeName===t.ZodString&&a.keyType._def.type._def.checks?.length){let{type:d,...e}=cf(a.keyType._def,b);return{...c,propertyNames:e}}return c}let co={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"},cp=(a,b)=>{let c=(a.options instanceof Map?Array.from(a.options.values()):a.options).map((a,c)=>cq(a._def,{...b,currentPath:[...b.currentPath,"anyOf",`${c}`]})).filter(a=>!!a&&(!b.strictUnions||"object"==typeof a&&Object.keys(a).length>0));return c.length?{anyOf:c}:void 0};function cq(a,b,c=!1){let d=b.seen.get(a);if(b.override){let e=b.override?.(a,b,d,c);if(e!==a2)return e}if(d&&!c){let a=cr(d,b);if(void 0!==a)return a}let e={def:a,path:b.currentPath,jsonSchema:void 0};b.seen.set(a,e);let f=((a,b,c)=>{switch(b){case t.ZodString:return ch(a,c);case t.ZodNumber:var d,e,f,g,h,i,j,k,l,m=a,n=c;let o={type:"number"};if(!m.checks)return o;for(let a of m.checks)switch(a.kind){case"int":o.type="integer",cd(o,"type",a.message,n);break;case"min":"jsonSchema7"===n.target?a.inclusive?ce(o,"minimum",a.value,a.message,n):ce(o,"exclusiveMinimum",a.value,a.message,n):(a.inclusive||(o.exclusiveMinimum=!0),ce(o,"minimum",a.value,a.message,n));break;case"max":"jsonSchema7"===n.target?a.inclusive?ce(o,"maximum",a.value,a.message,n):ce(o,"exclusiveMaximum",a.value,a.message,n):(a.inclusive||(o.exclusiveMaximum=!0),ce(o,"maximum",a.value,a.message,n));break;case"multipleOf":ce(o,"multipleOf",a.value,a.message,n)}return o;case t.ZodObject:return function(a,b){let c="openAi"===b.target,d={type:"object",properties:{}},e=[],f=a.shape();for(let a in f){let g=f[a];if(void 0===g||void 0===g._def)continue;let h=function(a){try{return a.isOptional()}catch{return!0}}(g);h&&c&&("ZodOptional"===g._def.typeName&&(g=g._def.innerType),g.isNullable()||(g=g.nullable()),h=!1);let i=cq(g._def,{...b,currentPath:[...b.currentPath,"properties",a],propertyPath:[...b.currentPath,"properties",a]});void 0!==i&&(d.properties[a]=i,h||e.push(a))}e.length&&(d.required=e);let g=function(a,b){if("ZodNever"!==a.catchall._def.typeName)return cq(a.catchall._def,{...b,currentPath:[...b.currentPath,"additionalProperties"]});switch(a.unknownKeys){case"passthrough":return b.allowedAdditionalProperties;case"strict":return b.rejectedAdditionalProperties;case"strip":return"strict"===b.removeAdditionalStrategy?b.allowedAdditionalProperties:b.rejectedAdditionalProperties}}(a,b);return void 0!==g&&(d.additionalProperties=g),d}(a,c);case t.ZodBigInt:var p=a,q=c;let r={type:"integer",format:"int64"};if(!p.checks)return r;for(let a of p.checks)switch(a.kind){case"min":"jsonSchema7"===q.target?a.inclusive?ce(r,"minimum",a.value,a.message,q):ce(r,"exclusiveMinimum",a.value,a.message,q):(a.inclusive||(r.exclusiveMinimum=!0),ce(r,"minimum",a.value,a.message,q));break;case"max":"jsonSchema7"===q.target?a.inclusive?ce(r,"maximum",a.value,a.message,q):ce(r,"exclusiveMaximum",a.value,a.message,q):(a.inclusive||(r.exclusiveMaximum=!0),ce(r,"maximum",a.value,a.message,q));break;case"multipleOf":ce(r,"multipleOf",a.value,a.message,q)}return r;case t.ZodBoolean:return{type:"boolean"};case t.ZodDate:return function a(b,c,d){let e=d??c.dateStrategy;if(Array.isArray(e))return{anyOf:e.map((d,e)=>a(b,c,d))};switch(e){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":var f=b,g=c;let h={type:"integer",format:"unix-time"};if("openApi3"===g.target)return h;for(let a of f.checks)switch(a.kind){case"min":ce(h,"minimum",a.value,a.message,g);break;case"max":ce(h,"maximum",a.value,a.message,g)}return h}}(a,c);case t.ZodUndefined:return{not:cc(c)};case t.ZodNull:return"openApi3"===c.target?{enum:["null"],nullable:!0}:{type:"null"};case t.ZodArray:var s=a,u=c;let v={type:"array"};return s.type?._def&&s.type?._def?.typeName!==t.ZodAny&&(v.items=cq(s.type._def,{...u,currentPath:[...u.currentPath,"items"]})),s.minLength&&ce(v,"minItems",s.minLength.value,s.minLength.message,u),s.maxLength&&ce(v,"maxItems",s.maxLength.value,s.maxLength.message,u),s.exactLength&&(ce(v,"minItems",s.exactLength.value,s.exactLength.message,u),ce(v,"maxItems",s.exactLength.value,s.exactLength.message,u)),v;case t.ZodUnion:case t.ZodDiscriminatedUnion:var w=a,x=c;if("openApi3"===x.target)return cp(w,x);let y=w.options instanceof Map?Array.from(w.options.values()):w.options;if(y.every(a=>a._def.typeName in co&&(!a._def.checks||!a._def.checks.length))){let a=y.reduce((a,b)=>{let c=co[b._def.typeName];return c&&!a.includes(c)?[...a,c]:a},[]);return{type:a.length>1?a:a[0]}}if(y.every(a=>"ZodLiteral"===a._def.typeName&&!a.description)){let a=y.reduce((a,b)=>{let c=typeof b._def.value;switch(c){case"string":case"number":case"boolean":return[...a,c];case"bigint":return[...a,"integer"];case"object":if(null===b._def.value)return[...a,"null"];default:return a}},[]);if(a.length===y.length){let b=a.filter((a,b,c)=>c.indexOf(a)===b);return{type:b.length>1?b:b[0],enum:y.reduce((a,b)=>a.includes(b._def.value)?a:[...a,b._def.value],[])}}}else if(y.every(a=>"ZodEnum"===a._def.typeName))return{type:"string",enum:y.reduce((a,b)=>[...a,...b._def.values.filter(b=>!a.includes(b))],[])};return cp(w,x);case t.ZodIntersection:var z=a,A=c;let B=[cq(z.left._def,{...A,currentPath:[...A.currentPath,"allOf","0"]}),cq(z.right._def,{...A,currentPath:[...A.currentPath,"allOf","1"]})].filter(a=>!!a),C="jsonSchema2019-09"===A.target?{unevaluatedProperties:!1}:void 0,D=[];return B.forEach(a=>{if((!("type"in a)||"string"!==a.type)&&"allOf"in a)D.push(...a.allOf),void 0===a.unevaluatedProperties&&(C=void 0);else{let b=a;if("additionalProperties"in a&&!1===a.additionalProperties){let{additionalProperties:c,...d}=a;b=d}else C=void 0;D.push(b)}}),D.length?{allOf:D,...C}:void 0;case t.ZodTuple:return d=a,e=c,d.rest?{type:"array",minItems:d.items.length,items:d.items.map((a,b)=>cq(a._def,{...e,currentPath:[...e.currentPath,"items",`${b}`]})).reduce((a,b)=>void 0===b?a:[...a,b],[]),additionalItems:cq(d.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:d.items.length,maxItems:d.items.length,items:d.items.map((a,b)=>cq(a._def,{...e,currentPath:[...e.currentPath,"items",`${b}`]})).reduce((a,b)=>void 0===b?a:[...a,b],[])};case t.ZodRecord:return cn(a,c);case t.ZodLiteral:var E=a,F=c;let G=typeof E.value;return"bigint"!==G&&"number"!==G&&"boolean"!==G&&"string"!==G?{type:Array.isArray(E.value)?"array":"object"}:"openApi3"===F.target?{type:"bigint"===G?"integer":G,enum:[E.value]}:{type:"bigint"===G?"integer":G,const:E.value};case t.ZodEnum:return{type:"string",enum:Array.from(a.values)};case t.ZodNativeEnum:var H=a;let I=H.values,J=Object.keys(H.values).filter(a=>"number"!=typeof I[I[a]]).map(a=>I[a]),K=Array.from(new Set(J.map(a=>typeof a)));return{type:1===K.length?"string"===K[0]?"string":"number":["string","number"],enum:J};case t.ZodNullable:var L=a,M=c;if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(L.innerType._def.typeName)&&(!L.innerType._def.checks||!L.innerType._def.checks.length))return"openApi3"===M.target?{type:co[L.innerType._def.typeName],nullable:!0}:{type:[co[L.innerType._def.typeName],"null"]};if("openApi3"===M.target){let a=cq(L.innerType._def,{...M,currentPath:[...M.currentPath]});return a&&"$ref"in a?{allOf:[a],nullable:!0}:a&&{...a,nullable:!0}}let N=cq(L.innerType._def,{...M,currentPath:[...M.currentPath,"anyOf","0"]});return N&&{anyOf:[N,{type:"null"}]};case t.ZodOptional:var O=a,P=c;if(P.currentPath.toString()===P.propertyPath?.toString())return cq(O.innerType._def,P);let Q=cq(O.innerType._def,{...P,currentPath:[...P.currentPath,"anyOf","1"]});return Q?{anyOf:[{not:cc(P)},Q]}:cc(P);case t.ZodMap:return f=a,"record"===(g=c).mapStrategy?cn(f,g):{type:"array",maxItems:125,items:{type:"array",items:[cq(f.keyType._def,{...g,currentPath:[...g.currentPath,"items","items","0"]})||cc(g),cq(f.valueType._def,{...g,currentPath:[...g.currentPath,"items","items","1"]})||cc(g)],minItems:2,maxItems:2}};case t.ZodSet:var R=a,S=c;let T={type:"array",uniqueItems:!0,items:cq(R.valueType._def,{...S,currentPath:[...S.currentPath,"items"]})};return R.minSize&&ce(T,"minItems",R.minSize.value,R.minSize.message,S),R.maxSize&&ce(T,"maxItems",R.maxSize.value,R.maxSize.message,S),T;case t.ZodLazy:return()=>a.getter()._def;case t.ZodPromise:return cq(a.type._def,c);case t.ZodNaN:case t.ZodNever:return"openAi"===(h=c).target?void 0:{not:cc({...h,currentPath:[...h.currentPath,"not"]})};case t.ZodEffects:return i=a,"input"===(j=c).effectStrategy?cq(i.schema._def,j):cc(j);case t.ZodAny:case t.ZodUnknown:return cc(c);case t.ZodDefault:return k=a,l=c,{...cq(k.innerType._def,l),default:k.defaultValue()};case t.ZodBranded:return cf(a,c);case t.ZodReadonly:case t.ZodCatch:return cq(a.innerType._def,c);case t.ZodPipeline:var U=a,V=c;if("input"===V.pipeStrategy)return cq(U.in._def,V);if("output"===V.pipeStrategy)return cq(U.out._def,V);let W=cq(U.in._def,{...V,currentPath:[...V.currentPath,"allOf","0"]}),X=cq(U.out._def,{...V,currentPath:[...V.currentPath,"allOf",W?"1":"0"]});return{allOf:[W,X].filter(a=>void 0!==a)};case t.ZodFunction:case t.ZodVoid:case t.ZodSymbol:default:return}})(a,a.typeName,b),g="function"==typeof f?cq(f(),b):f;if(g&&cs(a,b,g),b.postProcess){let c=b.postProcess(g,a,b);return e.jsonSchema=g,c}return e.jsonSchema=g,g}let cr=(a,b)=>{switch(b.$refStrategy){case"root":return{$ref:a.path.join("/")};case"relative":return{$ref:cb(b.currentPath,a.path)};case"none":case"seen":if(a.path.length<b.currentPath.length&&a.path.every((a,c)=>b.currentPath[c]===a))return console.warn(`Recursive reference detected at ${b.currentPath.join("/")}! Defaulting to any`),cc(b);return"seen"===b.$refStrategy?cc(b):void 0}},cs=(a,b,c)=>(a.description&&(c.description=a.description,b.markdownDescription&&(c.markdownDescription=a.description)),c);function ct(...a){return a.reduce((a,b)=>({...a,...null!=b?b:{}}),{})}function cu(a){return Object.fromEntries([...a.headers])}var cv=(({prefix:a,size:b=16,alphabet:c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:d="-"}={})=>{let e=()=>{let a=c.length,d=Array(b);for(let e=0;e<b;e++)d[e]=c[Math.random()*a|0];return d.join("")};if(null==a)return e;if(c.includes(d))throw new ay({argument:"separator",message:`The separator "${d}" must not be part of the alphabet "${c}".`});return()=>`${a}${d}${e()}`})();function cw(a){return(a instanceof Error||a instanceof DOMException)&&("AbortError"===a.name||"ResponseAborted"===a.name||"TimeoutError"===a.name)}var cx=["fetch failed","failed to fetch"],cy=/"__proto__"\s*:/,cz=/"constructor"\s*:/;function cA(a){let{stackTraceLimit:b}=Error;Error.stackTraceLimit=0;try{let b=JSON.parse(a);return null===b||"object"!=typeof b||!1===cy.test(a)&&!1===cz.test(a)?b:function(a){let b=[a];for(;b.length;){let a=b;for(let c of(b=[],a)){if(Object.prototype.hasOwnProperty.call(c,"__proto__")||Object.prototype.hasOwnProperty.call(c,"constructor")&&Object.prototype.hasOwnProperty.call(c.constructor,"prototype"))throw SyntaxError("Object contains forbidden prototype property");for(let a in c){let d=c[a];d&&"object"==typeof d&&b.push(d)}}}return a}(b)}finally{Error.stackTraceLimit=b}}var cB=Symbol.for("vercel.ai.validator");async function cC({value:a,schema:b}){let c=await cD({value:a,schema:b});if(!c.success)throw aW.wrap({value:a,cause:c.error});return c.value}async function cD({value:a,schema:b}){var c;let d="object"==typeof b&&null!==b&&cB in b&&!0===b[cB]&&"validate"in b?b:(c=b,{[cB]:!0,validate:async a=>{let b=await c["~standard"].validate(a);return null==b.issues?{success:!0,value:b.value}:{success:!1,error:new aW({value:a,cause:b.issues})}}});try{if(null==d.validate)return{success:!0,value:a,rawValue:a};let b=await d.validate(a);if(b.success)return{success:!0,value:b.value,rawValue:a};return{success:!1,error:aW.wrap({value:a,cause:b.error}),rawValue:a}}catch(b){return{success:!1,error:aW.wrap({value:a,cause:b}),rawValue:a}}}async function cE({text:a,schema:b}){try{let c=cA(a);if(null==b)return c;return cC({value:c,schema:b})}catch(b){if(aG.isInstance(b)||aW.isInstance(b))throw b;throw new aG({text:a,cause:b})}}async function cF({text:a,schema:b}){try{let c=cA(a);if(null==b)return{success:!0,value:c,rawValue:c};return await cD({value:c,schema:b})}catch(b){return{success:!1,error:aG.isInstance(b)?b:new aG({text:a,cause:b}),rawValue:void 0}}}async function cG({provider:a,providerOptions:b,schema:c}){if((null==b?void 0:b[a])==null)return;let d=await cD({value:b[a],schema:c});if(!d.success)throw new ay({argument:"providerOptions",message:`invalid ${a} provider options`,cause:d.error});return d.value}var cH=()=>globalThis.fetch,cI=async({url:a,headers:b,body:c,failedResponseHandler:d,successfulResponseHandler:e,abortSignal:f,fetch:g})=>cJ({url:a,headers:{"Content-Type":"application/json",...b},body:{content:JSON.stringify(c),values:c},failedResponseHandler:d,successfulResponseHandler:e,abortSignal:f,fetch:g}),cJ=async({url:a,headers:b={},body:c,successfulResponseHandler:d,failedResponseHandler:e,abortSignal:f,fetch:g=cH()})=>{try{let h=await g(a,{method:"POST",headers:Object.fromEntries(Object.entries(b).filter(([a,b])=>null!=b)),body:c.content,signal:f}),i=cu(h);if(!h.ok){let b;try{b=await e({response:h,url:a,requestBodyValues:c.values})}catch(b){if(cw(b)||ap.isInstance(b))throw b;throw new ap({message:"Failed to process error response",cause:b,statusCode:h.status,url:a,responseHeaders:i,requestBodyValues:c.values})}throw b.value}try{return await d({response:h,url:a,requestBodyValues:c.values})}catch(b){if(b instanceof Error&&(cw(b)||ap.isInstance(b)))throw b;throw new ap({message:"Failed to process successful response",cause:b,statusCode:h.status,url:a,responseHeaders:i,requestBodyValues:c.values})}}catch(b){throw function({error:a,url:b,requestBodyValues:c}){if(cw(a))return a;if(a instanceof TypeError&&cx.includes(a.message.toLowerCase())){let d=a.cause;if(null!=d)return new ap({message:`Cannot connect to API: ${d.message}`,cause:d,url:b,requestBodyValues:c,isRetryable:!0})}return a}({error:b,url:a,requestBodyValues:c.values})}};function cK({id:a,name:b,inputSchema:c}){return({execute:d,outputSchema:e,toModelOutput:f,onInputStart:g,onInputDelta:h,onInputAvailable:i,...j})=>({type:"provider-defined",id:a,name:b,args:j,inputSchema:c,outputSchema:e,execute:d,toModelOutput:f,onInputStart:g,onInputDelta:h,onInputAvailable:i})}async function cL(a){return"function"==typeof a&&(a=a()),Promise.resolve(a)}var cM=a=>async({response:b,url:c,requestBodyValues:d})=>{let e=await b.text(),f=await cF({text:e,schema:a}),g=cu(b);if(!f.success)throw new ap({message:"Invalid JSON response",cause:f.error,statusCode:b.status,responseHeaders:g,responseBody:e,url:c,requestBodyValues:d});return{responseHeaders:g,value:f.value,rawValue:f.rawValue}};Symbol.for("vercel.ai.schema");var{btoa:cN,atob:cO}=globalThis;function cP(a){return a instanceof Uint8Array?function(a){let b="";for(let c=0;c<a.length;c++)b+=String.fromCodePoint(a[c]);return cN(b)}(a):a}function cQ(a,b,c){function d(c,d){var e;for(let f in Object.defineProperty(c,"_zod",{value:c._zod??{},enumerable:!1}),(e=c._zod).traits??(e.traits=new Set),c._zod.traits.add(a),b(c,d),g.prototype)f in c||Object.defineProperty(c,f,{value:g.prototype[f].bind(c)});c._zod.constr=g,c._zod.def=d}let e=c?.Parent??Object;class f extends e{}function g(a){var b;let e=c?.Parent?new f:this;for(let c of(d(e,a),(b=e._zod).deferred??(b.deferred=[]),e._zod.deferred))c();return e}return Object.defineProperty(f,"name",{value:a}),Object.defineProperty(g,"init",{value:d}),Object.defineProperty(g,Symbol.hasInstance,{value:b=>!!c?.Parent&&b instanceof c.Parent||b?._zod?.traits?.has(a)}),Object.defineProperty(g,"name",{value:a}),g}Object.freeze({status:"aborted"}),Symbol("zod_brand");class cR extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}let cS={};function cT(a){return a&&Object.assign(cS,a),cS}let cU=/^[cC][^\s-]{8,}$/,cV=/^[0-9a-z]+$/,cW=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,cX=/^[0-9a-vA-V]{20}$/,cY=/^[A-Za-z0-9]{27}$/,cZ=/^[a-zA-Z0-9_-]{21}$/,c$=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,c_=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,c0=a=>a?RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${a}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,c1=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,c2=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,c3=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,c4=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,c5=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,c6=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,c7=/^[A-Za-z0-9_-]*$/,c8=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,c9=/^\+(?:[0-9]){6,14}[0-9]$/,da="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",db=RegExp(`^${da}$`);function dc(a){let b="(?:[01]\\d|2[0-3]):[0-5]\\d";return"number"==typeof a.precision?-1===a.precision?`${b}`:0===a.precision?`${b}:[0-5]\\d`:`${b}:[0-5]\\d\\.\\d{${a.precision}}`:`${b}(?::[0-5]\\d(?:\\.\\d+)?)?`}let dd=/^\d+$/,de=/^-?\d+(?:\.\d+)?/i,df=/true|false/i,dg=/null/i,dh=/^[^A-Z]*$/,di=/^[^a-z]*$/;function dj(a){let b=Object.values(a).filter(a=>"number"==typeof a);return Object.entries(a).filter(([a,c])=>-1===b.indexOf(+a)).map(([a,b])=>b)}function dk(a,b){return"bigint"==typeof b?b.toString():b}function dl(a){return{get value(){{let b=a();return Object.defineProperty(this,"value",{value:b}),b}}}}function dm(a){let b=+!!a.startsWith("^"),c=a.endsWith("$")?a.length-1:a.length;return a.slice(b,c)}function dn(a,b,c){Object.defineProperty(a,b,{get(){{let d=c();return a[b]=d,d}},set(c){Object.defineProperty(a,b,{value:c})},configurable:!0})}function dp(a,b,c){Object.defineProperty(a,b,{value:c,writable:!0,enumerable:!0,configurable:!0})}function dq(a){return JSON.stringify(a)}let dr=Error.captureStackTrace?Error.captureStackTrace:(...a)=>{};function ds(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}let dt=dl(()=>{if("undefined"!=typeof navigator&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return Function(""),!0}catch(a){return!1}});function du(a){if(!1===ds(a))return!1;let b=a.constructor;if(void 0===b)return!0;let c=b.prototype;return!1!==ds(c)&&!1!==Object.prototype.hasOwnProperty.call(c,"isPrototypeOf")}let dv=new Set(["string","number","symbol"]);function dw(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function dx(a,b,c){let d=new a._zod.constr(b??a._zod.def);return(!b||c?.parent)&&(d._zod.parent=a),d}function dy(a){if(!a)return{};if("string"==typeof a)return{error:()=>a};if(a?.message!==void 0){if(a?.error!==void 0)throw Error("Cannot specify both `message` and `error` params");a.error=a.message}return(delete a.message,"string"==typeof a.error)?{...a,error:()=>a.error}:a}let dz={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-0x80000000,0x7fffffff],uint32:[0,0xffffffff],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function dA(a,b=0){for(let c=b;c<a.issues.length;c++)if(a.issues[c]?.continue!==!0)return!0;return!1}function dB(a,b){return b.map(b=>(b.path??(b.path=[]),b.path.unshift(a),b))}function dC(a){return"string"==typeof a?a:a?.message}function dD(a,b,c){let d={...a,path:a.path??[]};return a.message||(d.message=dC(a.inst?._zod.def?.error?.(a))??dC(b?.error?.(a))??dC(c.customError?.(a))??dC(c.localeError?.(a))??"Invalid input"),delete d.inst,delete d.continue,b?.reportInput||delete d.input,d}function dE(a){return Array.isArray(a)?"array":"string"==typeof a?"string":"unknown"}function dF(...a){let[b,c,d]=a;return"string"==typeof b?{message:b,code:"custom",input:c,inst:d}:{...b}}let dG=cQ("$ZodCheck",(a,b)=>{var c;a._zod??(a._zod={}),a._zod.def=b,(c=a._zod).onattach??(c.onattach=[])}),dH={number:"number",bigint:"bigint",object:"date"},dI=cQ("$ZodCheckLessThan",(a,b)=>{dG.init(a,b);let c=dH[typeof b.value];a._zod.onattach.push(a=>{let c=a._zod.bag,d=(b.inclusive?c.maximum:c.exclusiveMaximum)??1/0;b.value<d&&(b.inclusive?c.maximum=b.value:c.exclusiveMaximum=b.value)}),a._zod.check=d=>{(b.inclusive?d.value<=b.value:d.value<b.value)||d.issues.push({origin:c,code:"too_big",maximum:b.value,input:d.value,inclusive:b.inclusive,inst:a,continue:!b.abort})}}),dJ=cQ("$ZodCheckGreaterThan",(a,b)=>{dG.init(a,b);let c=dH[typeof b.value];a._zod.onattach.push(a=>{let c=a._zod.bag,d=(b.inclusive?c.minimum:c.exclusiveMinimum)??-1/0;b.value>d&&(b.inclusive?c.minimum=b.value:c.exclusiveMinimum=b.value)}),a._zod.check=d=>{(b.inclusive?d.value>=b.value:d.value>b.value)||d.issues.push({origin:c,code:"too_small",minimum:b.value,input:d.value,inclusive:b.inclusive,inst:a,continue:!b.abort})}}),dK=cQ("$ZodCheckMultipleOf",(a,b)=>{dG.init(a,b),a._zod.onattach.push(a=>{var c;(c=a._zod.bag).multipleOf??(c.multipleOf=b.value)}),a._zod.check=c=>{if(typeof c.value!=typeof b.value)throw Error("Cannot mix number and bigint in multiple_of check.");("bigint"==typeof c.value?c.value%b.value===BigInt(0):0===function(a,b){let c=(a.toString().split(".")[1]||"").length,d=(b.toString().split(".")[1]||"").length,e=c>d?c:d;return Number.parseInt(a.toFixed(e).replace(".",""))%Number.parseInt(b.toFixed(e).replace(".",""))/10**e}(c.value,b.value))||c.issues.push({origin:typeof c.value,code:"not_multiple_of",divisor:b.value,input:c.value,inst:a,continue:!b.abort})}}),dL=cQ("$ZodCheckNumberFormat",(a,b)=>{dG.init(a,b),b.format=b.format||"float64";let c=b.format?.includes("int"),d=c?"int":"number",[e,f]=dz[b.format];a._zod.onattach.push(a=>{let d=a._zod.bag;d.format=b.format,d.minimum=e,d.maximum=f,c&&(d.pattern=dd)}),a._zod.check=g=>{let h=g.value;if(c){if(!Number.isInteger(h))return void g.issues.push({expected:d,format:b.format,code:"invalid_type",input:h,inst:a});if(!Number.isSafeInteger(h))return void(h>0?g.issues.push({input:h,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:a,origin:d,continue:!b.abort}):g.issues.push({input:h,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:a,origin:d,continue:!b.abort}))}h<e&&g.issues.push({origin:"number",input:h,code:"too_small",minimum:e,inclusive:!0,inst:a,continue:!b.abort}),h>f&&g.issues.push({origin:"number",input:h,code:"too_big",maximum:f,inst:a})}}),dM=cQ("$ZodCheckMaxLength",(a,b)=>{var c;dG.init(a,b),(c=a._zod.def).when??(c.when=a=>{let b=a.value;return null!=b&&void 0!==b.length}),a._zod.onattach.push(a=>{let c=a._zod.bag.maximum??1/0;b.maximum<c&&(a._zod.bag.maximum=b.maximum)}),a._zod.check=c=>{let d=c.value;if(d.length<=b.maximum)return;let e=dE(d);c.issues.push({origin:e,code:"too_big",maximum:b.maximum,inclusive:!0,input:d,inst:a,continue:!b.abort})}}),dN=cQ("$ZodCheckMinLength",(a,b)=>{var c;dG.init(a,b),(c=a._zod.def).when??(c.when=a=>{let b=a.value;return null!=b&&void 0!==b.length}),a._zod.onattach.push(a=>{let c=a._zod.bag.minimum??-1/0;b.minimum>c&&(a._zod.bag.minimum=b.minimum)}),a._zod.check=c=>{let d=c.value;if(d.length>=b.minimum)return;let e=dE(d);c.issues.push({origin:e,code:"too_small",minimum:b.minimum,inclusive:!0,input:d,inst:a,continue:!b.abort})}}),dO=cQ("$ZodCheckLengthEquals",(a,b)=>{var c;dG.init(a,b),(c=a._zod.def).when??(c.when=a=>{let b=a.value;return null!=b&&void 0!==b.length}),a._zod.onattach.push(a=>{let c=a._zod.bag;c.minimum=b.length,c.maximum=b.length,c.length=b.length}),a._zod.check=c=>{let d=c.value,e=d.length;if(e===b.length)return;let f=dE(d),g=e>b.length;c.issues.push({origin:f,...g?{code:"too_big",maximum:b.length}:{code:"too_small",minimum:b.length},inclusive:!0,exact:!0,input:c.value,inst:a,continue:!b.abort})}}),dP=cQ("$ZodCheckStringFormat",(a,b)=>{var c,d;dG.init(a,b),a._zod.onattach.push(a=>{let c=a._zod.bag;c.format=b.format,b.pattern&&(c.patterns??(c.patterns=new Set),c.patterns.add(b.pattern))}),b.pattern?(c=a._zod).check??(c.check=c=>{b.pattern.lastIndex=0,b.pattern.test(c.value)||c.issues.push({origin:"string",code:"invalid_format",format:b.format,input:c.value,...b.pattern?{pattern:b.pattern.toString()}:{},inst:a,continue:!b.abort})}):(d=a._zod).check??(d.check=()=>{})}),dQ=cQ("$ZodCheckRegex",(a,b)=>{dP.init(a,b),a._zod.check=c=>{b.pattern.lastIndex=0,b.pattern.test(c.value)||c.issues.push({origin:"string",code:"invalid_format",format:"regex",input:c.value,pattern:b.pattern.toString(),inst:a,continue:!b.abort})}}),dR=cQ("$ZodCheckLowerCase",(a,b)=>{b.pattern??(b.pattern=dh),dP.init(a,b)}),dS=cQ("$ZodCheckUpperCase",(a,b)=>{b.pattern??(b.pattern=di),dP.init(a,b)}),dT=cQ("$ZodCheckIncludes",(a,b)=>{dG.init(a,b);let c=dw(b.includes),d=new RegExp("number"==typeof b.position?`^.{${b.position}}${c}`:c);b.pattern=d,a._zod.onattach.push(a=>{let b=a._zod.bag;b.patterns??(b.patterns=new Set),b.patterns.add(d)}),a._zod.check=c=>{c.value.includes(b.includes,b.position)||c.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:b.includes,input:c.value,inst:a,continue:!b.abort})}}),dU=cQ("$ZodCheckStartsWith",(a,b)=>{dG.init(a,b);let c=RegExp(`^${dw(b.prefix)}.*`);b.pattern??(b.pattern=c),a._zod.onattach.push(a=>{let b=a._zod.bag;b.patterns??(b.patterns=new Set),b.patterns.add(c)}),a._zod.check=c=>{c.value.startsWith(b.prefix)||c.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:b.prefix,input:c.value,inst:a,continue:!b.abort})}}),dV=cQ("$ZodCheckEndsWith",(a,b)=>{dG.init(a,b);let c=RegExp(`.*${dw(b.suffix)}$`);b.pattern??(b.pattern=c),a._zod.onattach.push(a=>{let b=a._zod.bag;b.patterns??(b.patterns=new Set),b.patterns.add(c)}),a._zod.check=c=>{c.value.endsWith(b.suffix)||c.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:b.suffix,input:c.value,inst:a,continue:!b.abort})}}),dW=cQ("$ZodCheckOverwrite",(a,b)=>{dG.init(a,b),a._zod.check=a=>{a.value=b.tx(a.value)}});class dX{constructor(a=[]){this.content=[],this.indent=0,this&&(this.args=a)}indented(a){this.indent+=1,a(this),this.indent-=1}write(a){if("function"==typeof a){a(this,{execution:"sync"}),a(this,{execution:"async"});return}let b=a.split("\n").filter(a=>a),c=Math.min(...b.map(a=>a.length-a.trimStart().length));for(let a of b.map(a=>a.slice(c)).map(a=>" ".repeat(2*this.indent)+a))this.content.push(a)}compile(){return Function(...this?.args,[...(this?.content??[""]).map(a=>`  ${a}`)].join("\n"))}}let dY=(a,b)=>{a.name="$ZodError",Object.defineProperty(a,"_zod",{value:a._zod,enumerable:!1}),Object.defineProperty(a,"issues",{value:b,enumerable:!1}),Object.defineProperty(a,"message",{get:()=>JSON.stringify(b,dk,2),enumerable:!0}),Object.defineProperty(a,"toString",{value:()=>a.message,enumerable:!1})},dZ=cQ("$ZodError",dY),d$=cQ("$ZodError",dY,{Parent:Error}),d_=a=>(b,c,d)=>{let e=d?{...d,async:!1}:{async:!1},f=b._zod.run({value:c,issues:[]},e);if(f instanceof Promise)throw new cR;return f.issues.length?{success:!1,error:new(a??dZ)(f.issues.map(a=>dD(a,e,cT())))}:{success:!0,data:f.value}},d0=d_(d$),d1=a=>async(b,c,d)=>{let e=d?Object.assign(d,{async:!0}):{async:!0},f=b._zod.run({value:c,issues:[]},e);return f instanceof Promise&&(f=await f),f.issues.length?{success:!1,error:new a(f.issues.map(a=>dD(a,e,cT())))}:{success:!0,data:f.value}},d2=d1(d$),d3={major:4,minor:0,patch:0},d4=cQ("$ZodType",(a,b)=>{var c;a??(a={}),a._zod.def=b,a._zod.bag=a._zod.bag||{},a._zod.version=d3;let d=[...a._zod.def.checks??[]];for(let b of(a._zod.traits.has("$ZodCheck")&&d.unshift(a),d))for(let c of b._zod.onattach)c(a);if(0===d.length)(c=a._zod).deferred??(c.deferred=[]),a._zod.deferred?.push(()=>{a._zod.run=a._zod.parse});else{let b=(a,b,c)=>{let d,e=dA(a);for(let f of b){if(f._zod.def.when){if(!f._zod.def.when(a))continue}else if(e)continue;let b=a.issues.length,g=f._zod.check(a);if(g instanceof Promise&&c?.async===!1)throw new cR;if(d||g instanceof Promise)d=(d??Promise.resolve()).then(async()=>{await g,a.issues.length!==b&&(e||(e=dA(a,b)))});else{if(a.issues.length===b)continue;e||(e=dA(a,b))}}return d?d.then(()=>a):a};a._zod.run=(c,e)=>{let f=a._zod.parse(c,e);if(f instanceof Promise){if(!1===e.async)throw new cR;return f.then(a=>b(a,d,e))}return b(f,d,e)}}a["~standard"]={validate:b=>{try{let c=d0(a,b);return c.success?{value:c.data}:{issues:c.error?.issues}}catch(c){return d2(a,b).then(a=>a.success?{value:a.data}:{issues:a.error?.issues})}},vendor:"zod",version:1}}),d5=cQ("$ZodString",(a,b)=>{d4.init(a,b),a._zod.pattern=[...a?._zod.bag?.patterns??[]].pop()??(a=>{let b=a?`[\\s\\S]{${a?.minimum??0},${a?.maximum??""}}`:"[\\s\\S]*";return RegExp(`^${b}$`)})(a._zod.bag),a._zod.parse=(c,d)=>{if(b.coerce)try{c.value=String(c.value)}catch(a){}return"string"==typeof c.value||c.issues.push({expected:"string",code:"invalid_type",input:c.value,inst:a}),c}}),d6=cQ("$ZodStringFormat",(a,b)=>{dP.init(a,b),d5.init(a,b)}),d7=cQ("$ZodGUID",(a,b)=>{b.pattern??(b.pattern=c_),d6.init(a,b)}),d8=cQ("$ZodUUID",(a,b)=>{if(b.version){let a={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[b.version];if(void 0===a)throw Error(`Invalid UUID version: "${b.version}"`);b.pattern??(b.pattern=c0(a))}else b.pattern??(b.pattern=c0());d6.init(a,b)}),d9=cQ("$ZodEmail",(a,b)=>{b.pattern??(b.pattern=c1),d6.init(a,b)}),ea=cQ("$ZodURL",(a,b)=>{d6.init(a,b),a._zod.check=c=>{try{let d=c.value,e=new URL(d),f=e.href;b.hostname&&(b.hostname.lastIndex=0,b.hostname.test(e.hostname)||c.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:c8.source,input:c.value,inst:a,continue:!b.abort})),b.protocol&&(b.protocol.lastIndex=0,b.protocol.test(e.protocol.endsWith(":")?e.protocol.slice(0,-1):e.protocol)||c.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:b.protocol.source,input:c.value,inst:a,continue:!b.abort})),!d.endsWith("/")&&f.endsWith("/")?c.value=f.slice(0,-1):c.value=f;return}catch(d){c.issues.push({code:"invalid_format",format:"url",input:c.value,inst:a,continue:!b.abort})}}}),eb=cQ("$ZodEmoji",(a,b)=>{b.pattern??(b.pattern=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),d6.init(a,b)}),ec=cQ("$ZodNanoID",(a,b)=>{b.pattern??(b.pattern=cZ),d6.init(a,b)}),ed=cQ("$ZodCUID",(a,b)=>{b.pattern??(b.pattern=cU),d6.init(a,b)}),ee=cQ("$ZodCUID2",(a,b)=>{b.pattern??(b.pattern=cV),d6.init(a,b)}),ef=cQ("$ZodULID",(a,b)=>{b.pattern??(b.pattern=cW),d6.init(a,b)}),eg=cQ("$ZodXID",(a,b)=>{b.pattern??(b.pattern=cX),d6.init(a,b)}),eh=cQ("$ZodKSUID",(a,b)=>{b.pattern??(b.pattern=cY),d6.init(a,b)}),ei=cQ("$ZodISODateTime",(a,b)=>{b.pattern??(b.pattern=function(a){let b=dc({precision:a.precision}),c=["Z"];a.local&&c.push(""),a.offset&&c.push("([+-]\\d{2}:\\d{2})");let d=`${b}(?:${c.join("|")})`;return RegExp(`^${da}T(?:${d})$`)}(b)),d6.init(a,b)}),ej=cQ("$ZodISODate",(a,b)=>{b.pattern??(b.pattern=db),d6.init(a,b)}),ek=cQ("$ZodISOTime",(a,b)=>{b.pattern??(b.pattern=RegExp(`^${dc(b)}$`)),d6.init(a,b)}),el=cQ("$ZodISODuration",(a,b)=>{b.pattern??(b.pattern=c$),d6.init(a,b)}),em=cQ("$ZodIPv4",(a,b)=>{b.pattern??(b.pattern=c2),d6.init(a,b),a._zod.onattach.push(a=>{a._zod.bag.format="ipv4"})}),en=cQ("$ZodIPv6",(a,b)=>{b.pattern??(b.pattern=c3),d6.init(a,b),a._zod.onattach.push(a=>{a._zod.bag.format="ipv6"}),a._zod.check=c=>{try{new URL(`http://[${c.value}]`)}catch{c.issues.push({code:"invalid_format",format:"ipv6",input:c.value,inst:a,continue:!b.abort})}}}),eo=cQ("$ZodCIDRv4",(a,b)=>{b.pattern??(b.pattern=c4),d6.init(a,b)}),ep=cQ("$ZodCIDRv6",(a,b)=>{b.pattern??(b.pattern=c5),d6.init(a,b),a._zod.check=c=>{let[d,e]=c.value.split("/");try{if(!e)throw Error();let a=Number(e);if(`${a}`!==e||a<0||a>128)throw Error();new URL(`http://[${d}]`)}catch{c.issues.push({code:"invalid_format",format:"cidrv6",input:c.value,inst:a,continue:!b.abort})}}});function eq(a){if(""===a)return!0;if(a.length%4!=0)return!1;try{return atob(a),!0}catch{return!1}}let er=cQ("$ZodBase64",(a,b)=>{b.pattern??(b.pattern=c6),d6.init(a,b),a._zod.onattach.push(a=>{a._zod.bag.contentEncoding="base64"}),a._zod.check=c=>{eq(c.value)||c.issues.push({code:"invalid_format",format:"base64",input:c.value,inst:a,continue:!b.abort})}}),es=cQ("$ZodBase64URL",(a,b)=>{b.pattern??(b.pattern=c7),d6.init(a,b),a._zod.onattach.push(a=>{a._zod.bag.contentEncoding="base64url"}),a._zod.check=c=>{!function(a){if(!c7.test(a))return!1;let b=a.replace(/[-_]/g,a=>"-"===a?"+":"/");return eq(b.padEnd(4*Math.ceil(b.length/4),"="))}(c.value)&&c.issues.push({code:"invalid_format",format:"base64url",input:c.value,inst:a,continue:!b.abort})}}),et=cQ("$ZodE164",(a,b)=>{b.pattern??(b.pattern=c9),d6.init(a,b)}),eu=cQ("$ZodJWT",(a,b)=>{d6.init(a,b),a._zod.check=c=>{!function(a,b=null){try{let c=a.split(".");if(3!==c.length)return!1;let[d]=c;if(!d)return!1;let e=JSON.parse(atob(d));if("typ"in e&&e?.typ!=="JWT"||!e.alg||b&&(!("alg"in e)||e.alg!==b))return!1;return!0}catch{return!1}}(c.value,b.alg)&&c.issues.push({code:"invalid_format",format:"jwt",input:c.value,inst:a,continue:!b.abort})}}),ev=cQ("$ZodNumber",(a,b)=>{d4.init(a,b),a._zod.pattern=a._zod.bag.pattern??de,a._zod.parse=(c,d)=>{if(b.coerce)try{c.value=Number(c.value)}catch(a){}let e=c.value;if("number"==typeof e&&!Number.isNaN(e)&&Number.isFinite(e))return c;let f="number"==typeof e?Number.isNaN(e)?"NaN":Number.isFinite(e)?void 0:"Infinity":void 0;return c.issues.push({expected:"number",code:"invalid_type",input:e,inst:a,...f?{received:f}:{}}),c}}),ew=cQ("$ZodNumber",(a,b)=>{dL.init(a,b),ev.init(a,b)}),ex=cQ("$ZodBoolean",(a,b)=>{d4.init(a,b),a._zod.pattern=df,a._zod.parse=(c,d)=>{if(b.coerce)try{c.value=!!c.value}catch(a){}let e=c.value;return"boolean"==typeof e||c.issues.push({expected:"boolean",code:"invalid_type",input:e,inst:a}),c}}),ey=cQ("$ZodNull",(a,b)=>{d4.init(a,b),a._zod.pattern=dg,a._zod.values=new Set([null]),a._zod.parse=(b,c)=>{let d=b.value;return null===d||b.issues.push({expected:"null",code:"invalid_type",input:d,inst:a}),b}}),ez=cQ("$ZodAny",(a,b)=>{d4.init(a,b),a._zod.parse=a=>a}),eA=cQ("$ZodUnknown",(a,b)=>{d4.init(a,b),a._zod.parse=a=>a}),eB=cQ("$ZodNever",(a,b)=>{d4.init(a,b),a._zod.parse=(b,c)=>(b.issues.push({expected:"never",code:"invalid_type",input:b.value,inst:a}),b)});function eC(a,b,c){a.issues.length&&b.issues.push(...dB(c,a.issues)),b.value[c]=a.value}let eD=cQ("$ZodArray",(a,b)=>{d4.init(a,b),a._zod.parse=(c,d)=>{let e=c.value;if(!Array.isArray(e))return c.issues.push({expected:"array",code:"invalid_type",input:e,inst:a}),c;c.value=Array(e.length);let f=[];for(let a=0;a<e.length;a++){let g=e[a],h=b.element._zod.run({value:g,issues:[]},d);h instanceof Promise?f.push(h.then(b=>eC(b,c,a))):eC(h,c,a)}return f.length?Promise.all(f).then(()=>c):c}});function eE(a,b,c){a.issues.length&&b.issues.push(...dB(c,a.issues)),b.value[c]=a.value}function eF(a,b,c,d){a.issues.length?void 0===d[c]?c in d?b.value[c]=void 0:b.value[c]=a.value:b.issues.push(...dB(c,a.issues)):void 0===a.value?c in d&&(b.value[c]=void 0):b.value[c]=a.value}let eG=cQ("$ZodObject",(a,b)=>{let c,d;d4.init(a,b);let e=dl(()=>{let a=Object.keys(b.shape);for(let c of a)if(!(b.shape[c]instanceof d4))throw Error(`Invalid element at key "${c}": expected a Zod schema`);let c=function(a){return Object.keys(a).filter(b=>"optional"===a[b]._zod.optin&&"optional"===a[b]._zod.optout)}(b.shape);return{shape:b.shape,keys:a,keySet:new Set(a),numKeys:a.length,optionalKeys:new Set(c)}});dn(a._zod,"propValues",()=>{let a=b.shape,c={};for(let b in a){let d=a[b]._zod;if(d.values)for(let a of(c[b]??(c[b]=new Set),d.values))c[b].add(a)}return c});let f=!cS.jitless,g=f&&dt.value,h=b.catchall;a._zod.parse=(i,j)=>{d??(d=e.value);let k=i.value;if(!ds(k))return i.issues.push({expected:"object",code:"invalid_type",input:k,inst:a}),i;let l=[];if(f&&g&&j?.async===!1&&!0!==j.jitless)c||(c=(a=>{let b=new dX(["shape","payload","ctx"]),c=e.value,d=a=>{let b=dq(a);return`shape[${b}]._zod.run({ value: input[${b}], issues: [] }, ctx)`};b.write("const input = payload.value;");let f=Object.create(null),g=0;for(let a of c.keys)f[a]=`key_${g++}`;for(let a of(b.write("const newResult = {}"),c.keys))if(c.optionalKeys.has(a)){let c=f[a];b.write(`const ${c} = ${d(a)};`);let e=dq(a);b.write(`
        if (${c}.issues.length) {
          if (input[${e}] === undefined) {
            if (${e} in input) {
              newResult[${e}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${c}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${e}, ...iss.path] : [${e}],
              }))
            );
          }
        } else if (${c}.value === undefined) {
          if (${e} in input) newResult[${e}] = undefined;
        } else {
          newResult[${e}] = ${c}.value;
        }
        `)}else{let c=f[a];b.write(`const ${c} = ${d(a)};`),b.write(`
          if (${c}.issues.length) payload.issues = payload.issues.concat(${c}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${dq(a)}, ...iss.path] : [${dq(a)}]
          })));`),b.write(`newResult[${dq(a)}] = ${c}.value`)}b.write("payload.value = newResult;"),b.write("return payload;");let h=b.compile();return(b,c)=>h(a,b,c)})(b.shape)),i=c(i,j);else{i.value={};let a=d.shape;for(let b of d.keys){let c=a[b],d=c._zod.run({value:k[b],issues:[]},j),e="optional"===c._zod.optin&&"optional"===c._zod.optout;d instanceof Promise?l.push(d.then(a=>e?eF(a,i,b,k):eE(a,i,b))):e?eF(d,i,b,k):eE(d,i,b)}}if(!h)return l.length?Promise.all(l).then(()=>i):i;let m=[],n=d.keySet,o=h._zod,p=o.def.type;for(let a of Object.keys(k)){if(n.has(a))continue;if("never"===p){m.push(a);continue}let b=o.run({value:k[a],issues:[]},j);b instanceof Promise?l.push(b.then(b=>eE(b,i,a))):eE(b,i,a)}return(m.length&&i.issues.push({code:"unrecognized_keys",keys:m,input:k,inst:a}),l.length)?Promise.all(l).then(()=>i):i}});function eH(a,b,c,d){for(let c of a)if(0===c.issues.length)return b.value=c.value,b;return b.issues.push({code:"invalid_union",input:b.value,inst:c,errors:a.map(a=>a.issues.map(a=>dD(a,d,cT())))}),b}let eI=cQ("$ZodUnion",(a,b)=>{d4.init(a,b),dn(a._zod,"optin",()=>b.options.some(a=>"optional"===a._zod.optin)?"optional":void 0),dn(a._zod,"optout",()=>b.options.some(a=>"optional"===a._zod.optout)?"optional":void 0),dn(a._zod,"values",()=>{if(b.options.every(a=>a._zod.values))return new Set(b.options.flatMap(a=>Array.from(a._zod.values)))}),dn(a._zod,"pattern",()=>{if(b.options.every(a=>a._zod.pattern)){let a=b.options.map(a=>a._zod.pattern);return RegExp(`^(${a.map(a=>dm(a.source)).join("|")})$`)}}),a._zod.parse=(c,d)=>{let e=!1,f=[];for(let a of b.options){let b=a._zod.run({value:c.value,issues:[]},d);if(b instanceof Promise)f.push(b),e=!0;else{if(0===b.issues.length)return b;f.push(b)}}return e?Promise.all(f).then(b=>eH(b,c,a,d)):eH(f,c,a,d)}}),eJ=cQ("$ZodDiscriminatedUnion",(a,b)=>{eI.init(a,b);let c=a._zod.parse;dn(a._zod,"propValues",()=>{let a={};for(let c of b.options){let d=c._zod.propValues;if(!d||0===Object.keys(d).length)throw Error(`Invalid discriminated union option at index "${b.options.indexOf(c)}"`);for(let[b,c]of Object.entries(d))for(let d of(a[b]||(a[b]=new Set),c))a[b].add(d)}return a});let d=dl(()=>{let a=b.options,c=new Map;for(let d of a){let a=d._zod.propValues[b.discriminator];if(!a||0===a.size)throw Error(`Invalid discriminated union option at index "${b.options.indexOf(d)}"`);for(let b of a){if(c.has(b))throw Error(`Duplicate discriminator value "${String(b)}"`);c.set(b,d)}}return c});a._zod.parse=(e,f)=>{let g=e.value;if(!ds(g))return e.issues.push({code:"invalid_type",expected:"object",input:g,inst:a}),e;let h=d.value.get(g?.[b.discriminator]);return h?h._zod.run(e,f):b.unionFallback?c(e,f):(e.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:g,path:[b.discriminator],inst:a}),e)}}),eK=cQ("$ZodIntersection",(a,b)=>{d4.init(a,b),a._zod.parse=(a,c)=>{let d=a.value,e=b.left._zod.run({value:d,issues:[]},c),f=b.right._zod.run({value:d,issues:[]},c);return e instanceof Promise||f instanceof Promise?Promise.all([e,f]).then(([b,c])=>eL(a,b,c)):eL(a,e,f)}});function eL(a,b,c){if(b.issues.length&&a.issues.push(...b.issues),c.issues.length&&a.issues.push(...c.issues),dA(a))return a;let d=function a(b,c){if(b===c||b instanceof Date&&c instanceof Date&&+b==+c)return{valid:!0,data:b};if(du(b)&&du(c)){let d=Object.keys(c),e=Object.keys(b).filter(a=>-1!==d.indexOf(a)),f={...b,...c};for(let d of e){let e=a(b[d],c[d]);if(!e.valid)return{valid:!1,mergeErrorPath:[d,...e.mergeErrorPath]};f[d]=e.data}return{valid:!0,data:f}}if(Array.isArray(b)&&Array.isArray(c)){if(b.length!==c.length)return{valid:!1,mergeErrorPath:[]};let d=[];for(let e=0;e<b.length;e++){let f=a(b[e],c[e]);if(!f.valid)return{valid:!1,mergeErrorPath:[e,...f.mergeErrorPath]};d.push(f.data)}return{valid:!0,data:d}}return{valid:!1,mergeErrorPath:[]}}(b.value,c.value);if(!d.valid)throw Error(`Unmergable intersection. Error path: ${JSON.stringify(d.mergeErrorPath)}`);return a.value=d.data,a}let eM=cQ("$ZodRecord",(a,b)=>{d4.init(a,b),a._zod.parse=(c,d)=>{let e=c.value;if(!du(e))return c.issues.push({expected:"record",code:"invalid_type",input:e,inst:a}),c;let f=[];if(b.keyType._zod.values){let g,h=b.keyType._zod.values;for(let a of(c.value={},h))if("string"==typeof a||"number"==typeof a||"symbol"==typeof a){let g=b.valueType._zod.run({value:e[a],issues:[]},d);g instanceof Promise?f.push(g.then(b=>{b.issues.length&&c.issues.push(...dB(a,b.issues)),c.value[a]=b.value})):(g.issues.length&&c.issues.push(...dB(a,g.issues)),c.value[a]=g.value)}for(let a in e)h.has(a)||(g=g??[]).push(a);g&&g.length>0&&c.issues.push({code:"unrecognized_keys",input:e,inst:a,keys:g})}else for(let g of(c.value={},Reflect.ownKeys(e))){if("__proto__"===g)continue;let h=b.keyType._zod.run({value:g,issues:[]},d);if(h instanceof Promise)throw Error("Async schemas not supported in object keys currently");if(h.issues.length){c.issues.push({origin:"record",code:"invalid_key",issues:h.issues.map(a=>dD(a,d,cT())),input:g,path:[g],inst:a}),c.value[h.value]=h.value;continue}let i=b.valueType._zod.run({value:e[g],issues:[]},d);i instanceof Promise?f.push(i.then(a=>{a.issues.length&&c.issues.push(...dB(g,a.issues)),c.value[h.value]=a.value})):(i.issues.length&&c.issues.push(...dB(g,i.issues)),c.value[h.value]=i.value)}return f.length?Promise.all(f).then(()=>c):c}}),eN=cQ("$ZodEnum",(a,b)=>{d4.init(a,b);let c=dj(b.entries);a._zod.values=new Set(c),a._zod.pattern=RegExp(`^(${c.filter(a=>dv.has(typeof a)).map(a=>"string"==typeof a?dw(a):a.toString()).join("|")})$`),a._zod.parse=(b,d)=>{let e=b.value;return a._zod.values.has(e)||b.issues.push({code:"invalid_value",values:c,input:e,inst:a}),b}}),eO=cQ("$ZodLiteral",(a,b)=>{d4.init(a,b),a._zod.values=new Set(b.values),a._zod.pattern=RegExp(`^(${b.values.map(a=>"string"==typeof a?dw(a):a?a.toString():String(a)).join("|")})$`),a._zod.parse=(c,d)=>{let e=c.value;return a._zod.values.has(e)||c.issues.push({code:"invalid_value",values:b.values,input:e,inst:a}),c}}),eP=cQ("$ZodTransform",(a,b)=>{d4.init(a,b),a._zod.parse=(a,c)=>{let d=b.transform(a.value,a);if(c.async)return(d instanceof Promise?d:Promise.resolve(d)).then(b=>(a.value=b,a));if(d instanceof Promise)throw new cR;return a.value=d,a}}),eQ=cQ("$ZodOptional",(a,b)=>{d4.init(a,b),a._zod.optin="optional",a._zod.optout="optional",dn(a._zod,"values",()=>b.innerType._zod.values?new Set([...b.innerType._zod.values,void 0]):void 0),dn(a._zod,"pattern",()=>{let a=b.innerType._zod.pattern;return a?RegExp(`^(${dm(a.source)})?$`):void 0}),a._zod.parse=(a,c)=>"optional"===b.innerType._zod.optin?b.innerType._zod.run(a,c):void 0===a.value?a:b.innerType._zod.run(a,c)}),eR=cQ("$ZodNullable",(a,b)=>{d4.init(a,b),dn(a._zod,"optin",()=>b.innerType._zod.optin),dn(a._zod,"optout",()=>b.innerType._zod.optout),dn(a._zod,"pattern",()=>{let a=b.innerType._zod.pattern;return a?RegExp(`^(${dm(a.source)}|null)$`):void 0}),dn(a._zod,"values",()=>b.innerType._zod.values?new Set([...b.innerType._zod.values,null]):void 0),a._zod.parse=(a,c)=>null===a.value?a:b.innerType._zod.run(a,c)}),eS=cQ("$ZodDefault",(a,b)=>{d4.init(a,b),a._zod.optin="optional",dn(a._zod,"values",()=>b.innerType._zod.values),a._zod.parse=(a,c)=>{if(void 0===a.value)return a.value=b.defaultValue,a;let d=b.innerType._zod.run(a,c);return d instanceof Promise?d.then(a=>eT(a,b)):eT(d,b)}});function eT(a,b){return void 0===a.value&&(a.value=b.defaultValue),a}let eU=cQ("$ZodPrefault",(a,b)=>{d4.init(a,b),a._zod.optin="optional",dn(a._zod,"values",()=>b.innerType._zod.values),a._zod.parse=(a,c)=>(void 0===a.value&&(a.value=b.defaultValue),b.innerType._zod.run(a,c))}),eV=cQ("$ZodNonOptional",(a,b)=>{d4.init(a,b),dn(a._zod,"values",()=>{let a=b.innerType._zod.values;return a?new Set([...a].filter(a=>void 0!==a)):void 0}),a._zod.parse=(c,d)=>{let e=b.innerType._zod.run(c,d);return e instanceof Promise?e.then(b=>eW(b,a)):eW(e,a)}});function eW(a,b){return a.issues.length||void 0!==a.value||a.issues.push({code:"invalid_type",expected:"nonoptional",input:a.value,inst:b}),a}let eX=cQ("$ZodCatch",(a,b)=>{d4.init(a,b),a._zod.optin="optional",dn(a._zod,"optout",()=>b.innerType._zod.optout),dn(a._zod,"values",()=>b.innerType._zod.values),a._zod.parse=(a,c)=>{let d=b.innerType._zod.run(a,c);return d instanceof Promise?d.then(d=>(a.value=d.value,d.issues.length&&(a.value=b.catchValue({...a,error:{issues:d.issues.map(a=>dD(a,c,cT()))},input:a.value}),a.issues=[]),a)):(a.value=d.value,d.issues.length&&(a.value=b.catchValue({...a,error:{issues:d.issues.map(a=>dD(a,c,cT()))},input:a.value}),a.issues=[]),a)}}),eY=cQ("$ZodPipe",(a,b)=>{d4.init(a,b),dn(a._zod,"values",()=>b.in._zod.values),dn(a._zod,"optin",()=>b.in._zod.optin),dn(a._zod,"optout",()=>b.out._zod.optout),a._zod.parse=(a,c)=>{let d=b.in._zod.run(a,c);return d instanceof Promise?d.then(a=>eZ(a,b,c)):eZ(d,b,c)}});function eZ(a,b,c){return dA(a)?a:b.out._zod.run({value:a.value,issues:a.issues},c)}let e$=cQ("$ZodReadonly",(a,b)=>{d4.init(a,b),dn(a._zod,"propValues",()=>b.innerType._zod.propValues),dn(a._zod,"values",()=>b.innerType._zod.values),dn(a._zod,"optin",()=>b.innerType._zod.optin),dn(a._zod,"optout",()=>b.innerType._zod.optout),a._zod.parse=(a,c)=>{let d=b.innerType._zod.run(a,c);return d instanceof Promise?d.then(e_):e_(d)}});function e_(a){return a.value=Object.freeze(a.value),a}let e0=cQ("$ZodLazy",(a,b)=>{d4.init(a,b),dn(a._zod,"innerType",()=>b.getter()),dn(a._zod,"pattern",()=>a._zod.innerType._zod.pattern),dn(a._zod,"propValues",()=>a._zod.innerType._zod.propValues),dn(a._zod,"optin",()=>a._zod.innerType._zod.optin),dn(a._zod,"optout",()=>a._zod.innerType._zod.optout),a._zod.parse=(b,c)=>a._zod.innerType._zod.run(b,c)}),e1=cQ("$ZodCustom",(a,b)=>{dG.init(a,b),d4.init(a,b),a._zod.parse=(a,b)=>a,a._zod.check=c=>{let d=c.value,e=b.fn(d);if(e instanceof Promise)return e.then(b=>e2(b,c,d,a));e2(e,c,d,a)}});function e2(a,b,c,d){if(!a){let a={code:"custom",input:c,inst:d,path:[...d._zod.def.path??[]],continue:!d._zod.def.abort};d._zod.def.params&&(a.params=d._zod.def.params),b.issues.push(dF(a))}}Symbol("ZodOutput"),Symbol("ZodInput");class e3{constructor(){this._map=new Map,this._idmap=new Map}add(a,...b){let c=b[0];if(this._map.set(a,c),c&&"object"==typeof c&&"id"in c){if(this._idmap.has(c.id))throw Error(`ID ${c.id} already exists in the registry`);this._idmap.set(c.id,a)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(a){let b=this._map.get(a);return b&&"object"==typeof b&&"id"in b&&this._idmap.delete(b.id),this._map.delete(a),this}get(a){let b=a._zod.parent;if(b){let c={...this.get(b)??{}};return delete c.id,{...c,...this._map.get(a)}}return this._map.get(a)}has(a){return this._map.has(a)}}let e4=new e3;function e5(a,b){return new a({type:"string",format:"guid",check:"string_format",abort:!1,...dy(b)})}function e6(a,b){return new a({type:"string",format:"base64",check:"string_format",abort:!1,...dy(b)})}function e7(a,b){return new dI({check:"less_than",...dy(b),value:a,inclusive:!1})}function e8(a,b){return new dI({check:"less_than",...dy(b),value:a,inclusive:!0})}function e9(a,b){return new dJ({check:"greater_than",...dy(b),value:a,inclusive:!1})}function fa(a,b){return new dJ({check:"greater_than",...dy(b),value:a,inclusive:!0})}function fb(a,b){return new dK({check:"multiple_of",...dy(b),value:a})}function fc(a,b){return new dM({check:"max_length",...dy(b),maximum:a})}function fd(a,b){return new dN({check:"min_length",...dy(b),minimum:a})}function fe(a,b){return new dO({check:"length_equals",...dy(b),length:a})}function ff(a){return new dW({check:"overwrite",tx:a})}let fg=cQ("ZodISODateTime",(a,b)=>{ei.init(a,b),fu.init(a,b)}),fh=cQ("ZodISODate",(a,b)=>{ej.init(a,b),fu.init(a,b)}),fi=cQ("ZodISOTime",(a,b)=>{ek.init(a,b),fu.init(a,b)}),fj=cQ("ZodISODuration",(a,b)=>{el.init(a,b),fu.init(a,b)}),fk=(a,b)=>{dZ.init(a,b),a.name="ZodError",Object.defineProperties(a,{format:{value:b=>(function(a,b){let c=b||function(a){return a.message},d={_errors:[]},e=a=>{for(let b of a.issues)if("invalid_union"===b.code&&b.errors.length)b.errors.map(a=>e({issues:a}));else if("invalid_key"===b.code)e({issues:b.issues});else if("invalid_element"===b.code)e({issues:b.issues});else if(0===b.path.length)d._errors.push(c(b));else{let a=d,e=0;for(;e<b.path.length;){let d=b.path[e];e===b.path.length-1?(a[d]=a[d]||{_errors:[]},a[d]._errors.push(c(b))):a[d]=a[d]||{_errors:[]},a=a[d],e++}}};return e(a),d})(a,b)},flatten:{value:b=>(function(a,b=a=>a.message){let c={},d=[];for(let e of a.issues)e.path.length>0?(c[e.path[0]]=c[e.path[0]]||[],c[e.path[0]].push(b(e))):d.push(b(e));return{formErrors:d,fieldErrors:c}})(a,b)},addIssue:{value:b=>a.issues.push(b)},addIssues:{value:b=>a.issues.push(...b)},isEmpty:{get:()=>0===a.issues.length}})};cQ("ZodError",fk);let fl=cQ("ZodError",fk,{Parent:Error}),fm=(a,b,c,d)=>{let e=c?Object.assign(c,{async:!1}):{async:!1},f=a._zod.run({value:b,issues:[]},e);if(f instanceof Promise)throw new cR;if(f.issues.length){let a=new(d?.Err??fl)(f.issues.map(a=>dD(a,e,cT())));throw dr(a,d?.callee),a}return f.value},fn=async(a,b,c,d)=>{let e=c?Object.assign(c,{async:!0}):{async:!0},f=a._zod.run({value:b,issues:[]},e);if(f instanceof Promise&&(f=await f),f.issues.length){let a=new(d?.Err??fl)(f.issues.map(a=>dD(a,e,cT())));throw dr(a,d?.callee),a}return f.value},fo=d_(fl),fp=d1(fl),fq=cQ("ZodType",(a,b)=>(d4.init(a,b),a.def=b,Object.defineProperty(a,"_def",{value:b}),a.check=(...c)=>a.clone({...b,checks:[...b.checks??[],...c.map(a=>"function"==typeof a?{_zod:{check:a,def:{check:"custom"},onattach:[]}}:a)]}),a.clone=(b,c)=>dx(a,b,c),a.brand=()=>a,a.register=(b,c)=>(b.add(a,c),a),a.parse=(b,c)=>fm(a,b,c,{callee:a.parse}),a.safeParse=(b,c)=>fo(a,b,c),a.parseAsync=async(b,c)=>fn(a,b,c,{callee:a.parseAsync}),a.safeParseAsync=async(b,c)=>fp(a,b,c),a.spa=a.safeParseAsync,a.refine=(b,c)=>a.check(function(a,b={}){return new gs({type:"custom",check:"custom",fn:a,...dy(b)})}(b,c)),a.superRefine=b=>a.check(function(a){let b=function(a){let b=new dG({check:"custom"});return b._zod.check=a,b}(c=>(c.addIssue=a=>{"string"==typeof a?c.issues.push(dF(a,c.value,b._zod.def)):(a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=c.value),a.inst??(a.inst=b),a.continue??(a.continue=!b._zod.def.abort),c.issues.push(dF(a)))},a(c.value,c)));return b}(b)),a.overwrite=b=>a.check(ff(b)),a.optional=()=>gh(a),a.nullable=()=>gj(a),a.nullish=()=>gh(gj(a)),a.nonoptional=b=>new gm({type:"nonoptional",innerType:a,...dy(b)}),a.array=()=>f0(a),a.or=b=>f6([a,b]),a.and=b=>new f8({type:"intersection",left:a,right:b}),a.transform=b=>gp(a,new gf({type:"transform",transform:b})),a.default=b=>(function(a,b){return new gk({type:"default",innerType:a,get defaultValue(){return"function"==typeof b?b():b}})})(a,b),a.prefault=b=>(function(a,b){return new gl({type:"prefault",innerType:a,get defaultValue(){return"function"==typeof b?b():b}})})(a,b),a.catch=b=>(function(a,b){return new gn({type:"catch",innerType:a,catchValue:"function"==typeof b?b:()=>b})})(a,b),a.pipe=b=>gp(a,b),a.readonly=()=>new gq({type:"readonly",innerType:a}),a.describe=b=>{let c=a.clone();return e4.add(c,{description:b}),c},Object.defineProperty(a,"description",{get:()=>e4.get(a)?.description,configurable:!0}),a.meta=(...b)=>{if(0===b.length)return e4.get(a);let c=a.clone();return e4.add(c,b[0]),c},a.isOptional=()=>a.safeParse(void 0).success,a.isNullable=()=>a.safeParse(null).success,a)),fr=cQ("_ZodString",(a,b)=>{d5.init(a,b),fq.init(a,b);let c=a._zod.bag;a.format=c.format??null,a.minLength=c.minimum??null,a.maxLength=c.maximum??null,a.regex=(...b)=>a.check(function(a,b){return new dQ({check:"string_format",format:"regex",...dy(b),pattern:a})}(...b)),a.includes=(...b)=>a.check(function(a,b){return new dT({check:"string_format",format:"includes",...dy(b),includes:a})}(...b)),a.startsWith=(...b)=>a.check(function(a,b){return new dU({check:"string_format",format:"starts_with",...dy(b),prefix:a})}(...b)),a.endsWith=(...b)=>a.check(function(a,b){return new dV({check:"string_format",format:"ends_with",...dy(b),suffix:a})}(...b)),a.min=(...b)=>a.check(fd(...b)),a.max=(...b)=>a.check(fc(...b)),a.length=(...b)=>a.check(fe(...b)),a.nonempty=(...b)=>a.check(fd(1,...b)),a.lowercase=b=>a.check(new dR({check:"string_format",format:"lowercase",...dy(b)})),a.uppercase=b=>a.check(new dS({check:"string_format",format:"uppercase",...dy(b)})),a.trim=()=>a.check(ff(a=>a.trim())),a.normalize=(...b)=>a.check(function(a){return ff(b=>b.normalize(a))}(...b)),a.toLowerCase=()=>a.check(ff(a=>a.toLowerCase())),a.toUpperCase=()=>a.check(ff(a=>a.toUpperCase()))}),fs=cQ("ZodString",(a,b)=>{d5.init(a,b),fr.init(a,b),a.email=b=>a.check(new fv({type:"string",format:"email",check:"string_format",abort:!1,...dy(b)})),a.url=b=>a.check(new fy({type:"string",format:"url",check:"string_format",abort:!1,...dy(b)})),a.jwt=b=>a.check(new fN({type:"string",format:"jwt",check:"string_format",abort:!1,...dy(b)})),a.emoji=b=>a.check(new fz({type:"string",format:"emoji",check:"string_format",abort:!1,...dy(b)})),a.guid=b=>a.check(e5(fw,b)),a.uuid=b=>a.check(new fx({type:"string",format:"uuid",check:"string_format",abort:!1,...dy(b)})),a.uuidv4=b=>a.check(new fx({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...dy(b)})),a.uuidv6=b=>a.check(new fx({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...dy(b)})),a.uuidv7=b=>a.check(new fx({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...dy(b)})),a.nanoid=b=>a.check(new fA({type:"string",format:"nanoid",check:"string_format",abort:!1,...dy(b)})),a.guid=b=>a.check(e5(fw,b)),a.cuid=b=>a.check(new fB({type:"string",format:"cuid",check:"string_format",abort:!1,...dy(b)})),a.cuid2=b=>a.check(new fC({type:"string",format:"cuid2",check:"string_format",abort:!1,...dy(b)})),a.ulid=b=>a.check(new fD({type:"string",format:"ulid",check:"string_format",abort:!1,...dy(b)})),a.base64=b=>a.check(e6(fK,b)),a.base64url=b=>a.check(new fL({type:"string",format:"base64url",check:"string_format",abort:!1,...dy(b)})),a.xid=b=>a.check(new fE({type:"string",format:"xid",check:"string_format",abort:!1,...dy(b)})),a.ksuid=b=>a.check(new fF({type:"string",format:"ksuid",check:"string_format",abort:!1,...dy(b)})),a.ipv4=b=>a.check(new fG({type:"string",format:"ipv4",check:"string_format",abort:!1,...dy(b)})),a.ipv6=b=>a.check(new fH({type:"string",format:"ipv6",check:"string_format",abort:!1,...dy(b)})),a.cidrv4=b=>a.check(new fI({type:"string",format:"cidrv4",check:"string_format",abort:!1,...dy(b)})),a.cidrv6=b=>a.check(new fJ({type:"string",format:"cidrv6",check:"string_format",abort:!1,...dy(b)})),a.e164=b=>a.check(new fM({type:"string",format:"e164",check:"string_format",abort:!1,...dy(b)})),a.datetime=b=>a.check(new fg({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...dy(b)})),a.date=b=>a.check(new fh({type:"string",format:"date",check:"string_format",...dy(b)})),a.time=b=>a.check(new fi({type:"string",format:"time",check:"string_format",precision:null,...dy(b)})),a.duration=b=>a.check(new fj({type:"string",format:"duration",check:"string_format",...dy(b)}))});function ft(a){return new fs({type:"string",...dy(a)})}let fu=cQ("ZodStringFormat",(a,b)=>{d6.init(a,b),fr.init(a,b)}),fv=cQ("ZodEmail",(a,b)=>{d9.init(a,b),fu.init(a,b)}),fw=cQ("ZodGUID",(a,b)=>{d7.init(a,b),fu.init(a,b)}),fx=cQ("ZodUUID",(a,b)=>{d8.init(a,b),fu.init(a,b)}),fy=cQ("ZodURL",(a,b)=>{ea.init(a,b),fu.init(a,b)}),fz=cQ("ZodEmoji",(a,b)=>{eb.init(a,b),fu.init(a,b)}),fA=cQ("ZodNanoID",(a,b)=>{ec.init(a,b),fu.init(a,b)}),fB=cQ("ZodCUID",(a,b)=>{ed.init(a,b),fu.init(a,b)}),fC=cQ("ZodCUID2",(a,b)=>{ee.init(a,b),fu.init(a,b)}),fD=cQ("ZodULID",(a,b)=>{ef.init(a,b),fu.init(a,b)}),fE=cQ("ZodXID",(a,b)=>{eg.init(a,b),fu.init(a,b)}),fF=cQ("ZodKSUID",(a,b)=>{eh.init(a,b),fu.init(a,b)}),fG=cQ("ZodIPv4",(a,b)=>{em.init(a,b),fu.init(a,b)}),fH=cQ("ZodIPv6",(a,b)=>{en.init(a,b),fu.init(a,b)}),fI=cQ("ZodCIDRv4",(a,b)=>{eo.init(a,b),fu.init(a,b)}),fJ=cQ("ZodCIDRv6",(a,b)=>{ep.init(a,b),fu.init(a,b)}),fK=cQ("ZodBase64",(a,b)=>{er.init(a,b),fu.init(a,b)}),fL=cQ("ZodBase64URL",(a,b)=>{es.init(a,b),fu.init(a,b)}),fM=cQ("ZodE164",(a,b)=>{et.init(a,b),fu.init(a,b)}),fN=cQ("ZodJWT",(a,b)=>{eu.init(a,b),fu.init(a,b)}),fO=cQ("ZodNumber",(a,b)=>{ev.init(a,b),fq.init(a,b),a.gt=(b,c)=>a.check(e9(b,c)),a.gte=(b,c)=>a.check(fa(b,c)),a.min=(b,c)=>a.check(fa(b,c)),a.lt=(b,c)=>a.check(e7(b,c)),a.lte=(b,c)=>a.check(e8(b,c)),a.max=(b,c)=>a.check(e8(b,c)),a.int=b=>a.check(fR(b)),a.safe=b=>a.check(fR(b)),a.positive=b=>a.check(e9(0,b)),a.nonnegative=b=>a.check(fa(0,b)),a.negative=b=>a.check(e7(0,b)),a.nonpositive=b=>a.check(e8(0,b)),a.multipleOf=(b,c)=>a.check(fb(b,c)),a.step=(b,c)=>a.check(fb(b,c)),a.finite=()=>a;let c=a._zod.bag;a.minValue=Math.max(c.minimum??-1/0,c.exclusiveMinimum??-1/0)??null,a.maxValue=Math.min(c.maximum??1/0,c.exclusiveMaximum??1/0)??null,a.isInt=(c.format??"").includes("int")||Number.isSafeInteger(c.multipleOf??.5),a.isFinite=!0,a.format=c.format??null});function fP(a){return new fO({type:"number",checks:[],...dy(a)})}let fQ=cQ("ZodNumberFormat",(a,b)=>{ew.init(a,b),fO.init(a,b)});function fR(a){return new fQ({type:"number",check:"number_format",abort:!1,format:"safeint",...dy(a)})}let fS=cQ("ZodBoolean",(a,b)=>{ex.init(a,b),fq.init(a,b)});function fT(a){return new fS({type:"boolean",...dy(a)})}let fU=cQ("ZodNull",(a,b)=>{ey.init(a,b),fq.init(a,b)}),fV=cQ("ZodAny",(a,b)=>{ez.init(a,b),fq.init(a,b)});function fW(){return new fV({type:"any"})}let fX=cQ("ZodUnknown",(a,b)=>{eA.init(a,b),fq.init(a,b)});function fY(){return new fX({type:"unknown"})}let fZ=cQ("ZodNever",(a,b)=>{eB.init(a,b),fq.init(a,b)});function f$(a){return new fZ({type:"never",...dy(a)})}let f_=cQ("ZodArray",(a,b)=>{eD.init(a,b),fq.init(a,b),a.element=b.element,a.min=(b,c)=>a.check(fd(b,c)),a.nonempty=b=>a.check(fd(1,b)),a.max=(b,c)=>a.check(fc(b,c)),a.length=(b,c)=>a.check(fe(b,c)),a.unwrap=()=>a.element});function f0(a,b){return new f_({type:"array",element:a,...dy(b)})}let f1=cQ("ZodObject",(a,b)=>{eG.init(a,b),fq.init(a,b),dn(a,"shape",()=>b.shape),a.keyof=()=>gc(Object.keys(a._zod.def.shape)),a.catchall=b=>a.clone({...a._zod.def,catchall:b}),a.passthrough=()=>a.clone({...a._zod.def,catchall:fY()}),a.loose=()=>a.clone({...a._zod.def,catchall:fY()}),a.strict=()=>a.clone({...a._zod.def,catchall:f$()}),a.strip=()=>a.clone({...a._zod.def,catchall:void 0}),a.extend=b=>(function(a,b){if(!du(b))throw Error("Invalid input to extend: expected a plain object");let c={...a._zod.def,get shape(){let c={...a._zod.def.shape,...b};return dp(this,"shape",c),c},checks:[]};return dx(a,c)})(a,b),a.merge=b=>(function(a,b){return dx(a,{...a._zod.def,get shape(){let c={...a._zod.def.shape,...b._zod.def.shape};return dp(this,"shape",c),c},catchall:b._zod.def.catchall,checks:[]})})(a,b),a.pick=b=>(function(a,b){let c={},d=a._zod.def;for(let a in b){if(!(a in d.shape))throw Error(`Unrecognized key: "${a}"`);b[a]&&(c[a]=d.shape[a])}return dx(a,{...a._zod.def,shape:c,checks:[]})})(a,b),a.omit=b=>(function(a,b){let c={...a._zod.def.shape},d=a._zod.def;for(let a in b){if(!(a in d.shape))throw Error(`Unrecognized key: "${a}"`);b[a]&&delete c[a]}return dx(a,{...a._zod.def,shape:c,checks:[]})})(a,b),a.partial=(...b)=>(function(a,b,c){let d=b._zod.def.shape,e={...d};if(c)for(let b in c){if(!(b in d))throw Error(`Unrecognized key: "${b}"`);c[b]&&(e[b]=a?new a({type:"optional",innerType:d[b]}):d[b])}else for(let b in d)e[b]=a?new a({type:"optional",innerType:d[b]}):d[b];return dx(b,{...b._zod.def,shape:e,checks:[]})})(gg,a,b[0]),a.required=(...b)=>(function(a,b,c){let d=b._zod.def.shape,e={...d};if(c)for(let b in c){if(!(b in e))throw Error(`Unrecognized key: "${b}"`);c[b]&&(e[b]=new a({type:"nonoptional",innerType:d[b]}))}else for(let b in d)e[b]=new a({type:"nonoptional",innerType:d[b]});return dx(b,{...b._zod.def,shape:e,checks:[]})})(gm,a,b[0])});function f2(a,b){return new f1({type:"object",get shape(){return dp(this,"shape",{...a}),this.shape},...dy(b)})}function f3(a,b){return new f1({type:"object",get shape(){return dp(this,"shape",{...a}),this.shape},catchall:f$(),...dy(b)})}function f4(a,b){return new f1({type:"object",get shape(){return dp(this,"shape",{...a}),this.shape},catchall:fY(),...dy(b)})}let f5=cQ("ZodUnion",(a,b)=>{eI.init(a,b),fq.init(a,b),a.options=b.options});function f6(a,b){return new f5({type:"union",options:a,...dy(b)})}let f7=cQ("ZodDiscriminatedUnion",(a,b)=>{f5.init(a,b),eJ.init(a,b)}),f8=cQ("ZodIntersection",(a,b)=>{eK.init(a,b),fq.init(a,b)}),f9=cQ("ZodRecord",(a,b)=>{eM.init(a,b),fq.init(a,b),a.keyType=b.keyType,a.valueType=b.valueType});function ga(a,b,c){return new f9({type:"record",keyType:a,valueType:b,...dy(c)})}let gb=cQ("ZodEnum",(a,b)=>{eN.init(a,b),fq.init(a,b),a.enum=b.entries,a.options=Object.values(b.entries);let c=new Set(Object.keys(b.entries));a.extract=(a,d)=>{let e={};for(let d of a)if(c.has(d))e[d]=b.entries[d];else throw Error(`Key ${d} not found in enum`);return new gb({...b,checks:[],...dy(d),entries:e})},a.exclude=(a,d)=>{let e={...b.entries};for(let b of a)if(c.has(b))delete e[b];else throw Error(`Key ${b} not found in enum`);return new gb({...b,checks:[],...dy(d),entries:e})}});function gc(a,b){return new gb({type:"enum",entries:Array.isArray(a)?Object.fromEntries(a.map(a=>[a,a])):a,...dy(b)})}let gd=cQ("ZodLiteral",(a,b)=>{eO.init(a,b),fq.init(a,b),a.values=new Set(b.values),Object.defineProperty(a,"value",{get(){if(b.values.length>1)throw Error("This schema contains multiple valid literal values. Use `.values` instead.");return b.values[0]}})});function ge(a,b){return new gd({type:"literal",values:Array.isArray(a)?a:[a],...dy(b)})}let gf=cQ("ZodTransform",(a,b)=>{eP.init(a,b),fq.init(a,b),a._zod.parse=(c,d)=>{c.addIssue=d=>{"string"==typeof d?c.issues.push(dF(d,c.value,b)):(d.fatal&&(d.continue=!1),d.code??(d.code="custom"),d.input??(d.input=c.value),d.inst??(d.inst=a),d.continue??(d.continue=!0),c.issues.push(dF(d)))};let e=b.transform(c.value,c);return e instanceof Promise?e.then(a=>(c.value=a,c)):(c.value=e,c)}}),gg=cQ("ZodOptional",(a,b)=>{eQ.init(a,b),fq.init(a,b),a.unwrap=()=>a._zod.def.innerType});function gh(a){return new gg({type:"optional",innerType:a})}let gi=cQ("ZodNullable",(a,b)=>{eR.init(a,b),fq.init(a,b),a.unwrap=()=>a._zod.def.innerType});function gj(a){return new gi({type:"nullable",innerType:a})}let gk=cQ("ZodDefault",(a,b)=>{eS.init(a,b),fq.init(a,b),a.unwrap=()=>a._zod.def.innerType,a.removeDefault=a.unwrap}),gl=cQ("ZodPrefault",(a,b)=>{eU.init(a,b),fq.init(a,b),a.unwrap=()=>a._zod.def.innerType}),gm=cQ("ZodNonOptional",(a,b)=>{eV.init(a,b),fq.init(a,b),a.unwrap=()=>a._zod.def.innerType}),gn=cQ("ZodCatch",(a,b)=>{eX.init(a,b),fq.init(a,b),a.unwrap=()=>a._zod.def.innerType,a.removeCatch=a.unwrap}),go=cQ("ZodPipe",(a,b)=>{eY.init(a,b),fq.init(a,b),a.in=b.in,a.out=b.out});function gp(a,b){return new go({type:"pipe",in:a,out:b})}let gq=cQ("ZodReadonly",(a,b)=>{e$.init(a,b),fq.init(a,b)}),gr=cQ("ZodLazy",(a,b)=>{e0.init(a,b),fq.init(a,b),a.unwrap=()=>a._zod.def.getter()}),gs=cQ("ZodCustom",(a,b)=>{e1.init(a,b),fq.init(a,b)});function gt(a,b={error:`Input not instance of ${a.name}`}){let c=new gs({type:"custom",check:"custom",fn:b=>b instanceof a,abort:!0,...dy(b)});return c._zod.bag.Class=a,c}var gu=(({errorSchema:a,errorToMessage:b,isRetryable:c})=>async({response:d,url:e,requestBodyValues:f})=>{let g=await d.text(),h=cu(d);if(""===g.trim())return{responseHeaders:h,value:new ap({message:d.statusText,url:e,requestBodyValues:f,statusCode:d.status,responseHeaders:h,responseBody:g,isRetryable:null==c?void 0:c(d)})};try{let i=await cE({text:g,schema:a});return{responseHeaders:h,value:new ap({message:b(i),url:e,requestBodyValues:f,statusCode:d.status,responseHeaders:h,responseBody:g,data:i,isRetryable:null==c?void 0:c(d,i)})}}catch(a){return{responseHeaders:h,value:new ap({message:d.statusText,url:e,requestBodyValues:f,statusCode:d.status,responseHeaders:h,responseBody:g,isRetryable:null==c?void 0:c(d)})}}})({errorSchema:f2({error:f2({code:fP().nullable(),message:ft(),status:ft()})}),errorToMessage:a=>a.error.message}),gv=f2({outputDimensionality:fP().optional(),taskType:gc(["SEMANTIC_SIMILARITY","CLASSIFICATION","CLUSTERING","RETRIEVAL_DOCUMENT","RETRIEVAL_QUERY","QUESTION_ANSWERING","FACT_VERIFICATION","CODE_RETRIEVAL_QUERY"]).optional()}),gw=class{constructor(a,b){this.specificationVersion="v2",this.maxEmbeddingsPerCall=2048,this.supportsParallelCalls=!0,this.modelId=a,this.config=b}get provider(){return this.config.provider}async doEmbed({values:a,headers:b,abortSignal:c,providerOptions:d}){let e=await cG({provider:"google",providerOptions:d,schema:gv});if(a.length>this.maxEmbeddingsPerCall)throw new aS({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:a});let f=ct(await cL(this.config.headers),b);if(1===a.length){let{responseHeaders:b,value:d,rawValue:g}=await cI({url:`${this.config.baseURL}/models/${this.modelId}:embedContent`,headers:f,body:{model:`models/${this.modelId}`,content:{parts:[{text:a[0]}]},outputDimensionality:null==e?void 0:e.outputDimensionality,taskType:null==e?void 0:e.taskType},failedResponseHandler:gu,successfulResponseHandler:cM(gy),abortSignal:c,fetch:this.config.fetch});return{embeddings:[d.embedding.values],usage:void 0,response:{headers:b,body:g}}}let{responseHeaders:g,value:h,rawValue:i}=await cI({url:`${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,headers:f,body:{requests:a.map(a=>({model:`models/${this.modelId}`,content:{role:"user",parts:[{text:a}]},outputDimensionality:null==e?void 0:e.outputDimensionality,taskType:null==e?void 0:e.taskType}))},failedResponseHandler:gu,successfulResponseHandler:cM(gx),abortSignal:c,fetch:this.config.fetch});return{embeddings:h.embeddings.map(a=>a.values),usage:void 0,response:{headers:g,body:i}}}},gx=f2({embeddings:f0(f2({values:f0(fP())}))}),gy=f2({embedding:f2({values:f0(fP())})});function gz(a){var b;if(null==a||null!=(b=a)&&"object"==typeof b&&"object"===b.type&&(null==b.properties||0===Object.keys(b.properties).length)&&!b.additionalProperties)return;if("boolean"==typeof a)return{type:"boolean",properties:{}};let{type:c,description:d,required:e,properties:f,items:g,allOf:h,anyOf:i,oneOf:j,format:k,const:l,minLength:m,enum:n}=a,o={};if(d&&(o.description=d),e&&(o.required=e),k&&(o.format=k),void 0!==l&&(o.enum=[l]),c&&(Array.isArray(c)?c.includes("null")?(o.type=c.filter(a=>"null"!==a)[0],o.nullable=!0):o.type=c:"null"===c?o.type="null":o.type=c),void 0!==n&&(o.enum=n),null!=f&&(o.properties=Object.entries(f).reduce((a,[b,c])=>(a[b]=gz(c),a),{})),g&&(o.items=Array.isArray(g)?g.map(gz):gz(g)),h&&(o.allOf=h.map(gz)),i)if(i.some(a=>"object"==typeof a&&(null==a?void 0:a.type)==="null")){let a=i.filter(a=>"object"!=typeof a||(null==a?void 0:a.type)!=="null");if(1===a.length){let b=gz(a[0]);"object"==typeof b&&(o.nullable=!0,Object.assign(o,b))}else o.anyOf=a.map(gz),o.nullable=!0}else o.anyOf=i.map(gz);return j&&(o.oneOf=j.map(gz)),void 0!==m&&(o.minLength=m),o}function gA(a){return a.includes("/")?a:`models/${a}`}var gB=f2({responseModalities:f0(gc(["TEXT","IMAGE"])).optional(),thinkingConfig:f2({thinkingBudget:fP().optional(),includeThoughts:fT().optional()}).optional(),cachedContent:ft().optional(),structuredOutputs:fT().optional(),safetySettings:f0(f2({category:gc(["HARM_CATEGORY_UNSPECIFIED","HARM_CATEGORY_HATE_SPEECH","HARM_CATEGORY_DANGEROUS_CONTENT","HARM_CATEGORY_HARASSMENT","HARM_CATEGORY_SEXUALLY_EXPLICIT","HARM_CATEGORY_CIVIC_INTEGRITY"]),threshold:gc(["HARM_BLOCK_THRESHOLD_UNSPECIFIED","BLOCK_LOW_AND_ABOVE","BLOCK_MEDIUM_AND_ABOVE","BLOCK_ONLY_HIGH","BLOCK_NONE","OFF"])})).optional(),threshold:gc(["HARM_BLOCK_THRESHOLD_UNSPECIFIED","BLOCK_LOW_AND_ABOVE","BLOCK_MEDIUM_AND_ABOVE","BLOCK_ONLY_HIGH","BLOCK_NONE","OFF"]).optional(),audioTimestamp:fT().optional(),labels:ga(ft(),ft()).optional()});function gC({finishReason:a,hasToolCalls:b}){switch(a){case"STOP":return b?"tool-calls":"stop";case"MAX_TOKENS":return"length";case"IMAGE_SAFETY":case"RECITATION":case"SAFETY":case"BLOCKLIST":case"PROHIBITED_CONTENT":case"SPII":return"content-filter";case"FINISH_REASON_UNSPECIFIED":case"OTHER":return"other";case"MALFORMED_FUNCTION_CALL":return"error";default:return"unknown"}}var gD=f2({web:f2({uri:ft(),title:ft()}).nullish(),retrievedContext:f2({uri:ft(),title:ft()}).nullish()}),gE=f2({webSearchQueries:f0(ft()).nullish(),retrievalQueries:f0(ft()).nullish(),searchEntryPoint:f2({renderedContent:ft()}).nullish(),groundingChunks:f0(gD).nullish(),groundingSupports:f0(f2({segment:f2({startIndex:fP().nullish(),endIndex:fP().nullish(),text:ft().nullish()}),segment_text:ft().nullish(),groundingChunkIndices:f0(fP()).nullish(),supportChunkIndices:f0(fP()).nullish(),confidenceScores:f0(fP()).nullish(),confidenceScore:f0(fP()).nullish()})).nullish(),retrievalMetadata:f6([f2({webDynamicRetrievalScore:fP()}),f2({})]).nullish()}),gF=cK({id:"google.google_search",name:"google_search",inputSchema:f2({mode:gc(["MODE_DYNAMIC","MODE_UNSPECIFIED"]).default("MODE_UNSPECIFIED"),dynamicThreshold:fP().default(1)})}),gG=f2({retrievedUrl:ft(),urlRetrievalStatus:ft()}),gH=f2({urlMetadata:f0(gG)}),gI=cK({id:"google.url_context",name:"url_context",inputSchema:f2({})}),gJ=class{constructor(a,b){var c;this.specificationVersion="v2",this.modelId=a,this.config=b,this.generateId=null!=(c=b.generateId)?c:cv}get provider(){return this.config.provider}get supportedUrls(){var a,b,c;return null!=(c=null==(b=(a=this.config).supportedUrls)?void 0:b.call(a))?c:{}}async getArgs({prompt:a,maxOutputTokens:b,temperature:c,topP:d,topK:e,frequencyPenalty:f,presencePenalty:g,stopSequences:h,responseFormat:i,seed:j,tools:k,toolChoice:l,providerOptions:m}){var n,o;let p=[],q=await cG({provider:"google",providerOptions:m,schema:gB});(null==(n=null==q?void 0:q.thinkingConfig)?void 0:n.includeThoughts)!==!0||this.config.provider.startsWith("google.vertex.")||p.push({type:"other",message:`The 'includeThoughts' option is only supported with the Google Vertex provider and might not be supported or could behave unexpectedly with the current Google provider (${this.config.provider}).`});let r=this.modelId.toLowerCase().startsWith("gemma-"),{contents:s,systemInstruction:t}=function(a,b){var c;let d=[],e=[],f=!0,g=null!=(c=null==b?void 0:b.isGemmaModel)&&c;for(let{role:b,content:c}of a)switch(b){case"system":if(!f)throw new a$({functionality:"system messages are only supported at the beginning of the conversation"});d.push({text:c});break;case"user":{f=!1;let a=[];for(let b of c)switch(b.type){case"text":a.push({text:b.text});break;case"file":{let c="image/*"===b.mediaType?"image/jpeg":b.mediaType;a.push(b.data instanceof URL?{fileData:{mimeType:c,fileUri:b.data.toString()}}:{inlineData:{mimeType:c,data:cP(b.data)}})}}e.push({role:"user",parts:a});break}case"assistant":f=!1,e.push({role:"model",parts:c.map(a=>{var b,c,d,e,f,g;switch(a.type){case"text":return 0===a.text.length?void 0:{text:a.text,thoughtSignature:null==(c=null==(b=a.providerOptions)?void 0:b.google)?void 0:c.thoughtSignature};case"reasoning":return 0===a.text.length?void 0:{text:a.text,thought:!0,thoughtSignature:null==(e=null==(d=a.providerOptions)?void 0:d.google)?void 0:e.thoughtSignature};case"file":if("image/png"!==a.mediaType)throw new a$({functionality:"Only PNG images are supported in assistant messages"});if(a.data instanceof URL)throw new a$({functionality:"File data URLs in assistant messages are not supported"});return{inlineData:{mimeType:a.mediaType,data:cP(a.data)}};case"tool-call":return{functionCall:{name:a.toolName,args:a.input},thoughtSignature:null==(g=null==(f=a.providerOptions)?void 0:f.google)?void 0:g.thoughtSignature}}}).filter(a=>void 0!==a)});break;case"tool":f=!1,e.push({role:"user",parts:c.map(a=>({functionResponse:{name:a.toolName,response:{name:a.toolName,content:a.output.value}}}))})}if(g&&d.length>0&&e.length>0&&"user"===e[0].role){let a=d.map(a=>a.text).join("\n\n");e[0].parts.unshift({text:a+"\n\n"})}return{systemInstruction:d.length>0&&!g?{parts:d}:void 0,contents:e}}(a,{isGemmaModel:r}),{tools:u,toolConfig:v,toolWarnings:w}=function({tools:a,toolChoice:b,modelId:c}){var d;a=(null==a?void 0:a.length)?a:void 0;let e=[],f=c.includes("gemini-2"),g=c.includes("gemini-1.5-flash")&&!c.includes("-8b");if(null==a)return{tools:void 0,toolConfig:void 0,toolWarnings:e};let h=a.some(a=>"function"===a.type),i=a.some(a=>"provider-defined"===a.type);if(h&&i&&e.push({type:"unsupported-tool",tool:a.find(a=>"function"===a.type),details:"Cannot mix function tools with provider-defined tools in the same request. Please use either function tools or provider-defined tools, but not both."}),i){let b={};return a.filter(a=>"provider-defined"===a.type).forEach(a=>{switch(a.id){case"google.google_search":f?b.googleSearch={}:g?b.googleSearchRetrieval={dynamicRetrievalConfig:{mode:a.args.mode,dynamicThreshold:a.args.dynamicThreshold}}:b.googleSearchRetrieval={};break;case"google.url_context":f?b.urlContext={}:e.push({type:"unsupported-tool",tool:a,details:"The URL context tool is not supported with other Gemini models than Gemini 2."});break;case"google.code_execution":f?b.codeExecution={}:e.push({type:"unsupported-tool",tool:a,details:"The code execution tools is not supported with other Gemini models than Gemini 2."});break;default:e.push({type:"unsupported-tool",tool:a})}}),{tools:Object.keys(b).length>0?b:void 0,toolConfig:void 0,toolWarnings:e}}let j=[];for(let b of a)"function"===b.type?j.push({name:b.name,description:null!=(d=b.description)?d:"",parameters:gz(b.inputSchema)}):e.push({type:"unsupported-tool",tool:b});if(null==b)return{tools:{functionDeclarations:j},toolConfig:void 0,toolWarnings:e};let k=b.type;switch(k){case"auto":return{tools:{functionDeclarations:j},toolConfig:{functionCallingConfig:{mode:"AUTO"}},toolWarnings:e};case"none":return{tools:{functionDeclarations:j},toolConfig:{functionCallingConfig:{mode:"NONE"}},toolWarnings:e};case"required":return{tools:{functionDeclarations:j},toolConfig:{functionCallingConfig:{mode:"ANY"}},toolWarnings:e};case"tool":return{tools:{functionDeclarations:j},toolConfig:{functionCallingConfig:{mode:"ANY",allowedFunctionNames:[b.toolName]}},toolWarnings:e};default:throw new a$({functionality:`tool choice type: ${k}`})}}({tools:k,toolChoice:l,modelId:this.modelId});return{args:{generationConfig:{maxOutputTokens:b,temperature:c,topK:e,topP:d,frequencyPenalty:f,presencePenalty:g,stopSequences:h,seed:j,responseMimeType:(null==i?void 0:i.type)==="json"?"application/json":void 0,responseSchema:(null==i?void 0:i.type)==="json"&&null!=i.schema&&(null==(o=null==q?void 0:q.structuredOutputs)||o)?gz(i.schema):void 0,...(null==q?void 0:q.audioTimestamp)&&{audioTimestamp:q.audioTimestamp},responseModalities:null==q?void 0:q.responseModalities,thinkingConfig:null==q?void 0:q.thinkingConfig},contents:s,systemInstruction:r?void 0:t,safetySettings:null==q?void 0:q.safetySettings,tools:u,toolConfig:v,cachedContent:null==q?void 0:q.cachedContent,labels:null==q?void 0:q.labels},warnings:[...p,...w]}}async doGenerate(a){var b,c,d,e,f,g,h,i,j,k,l,m;let n,{args:o,warnings:p}=await this.getArgs(a),q=JSON.stringify(o),r=ct(await cL(this.config.headers),a.headers),{responseHeaders:s,value:t,rawValue:u}=await cI({url:`${this.config.baseURL}/${gA(this.modelId)}:generateContent`,headers:r,body:o,failedResponseHandler:gu,successfulResponseHandler:cM(gO),abortSignal:a.abortSignal,fetch:this.config.fetch}),v=t.candidates[0],w=[],x=null!=(c=null==(b=v.content)?void 0:b.parts)?c:[],y=t.usageMetadata;for(let a of x)if("executableCode"in a&&(null==(d=a.executableCode)?void 0:d.code)){let b=this.config.generateId();n=b,w.push({type:"tool-call",toolCallId:b,toolName:"code_execution",input:JSON.stringify(a.executableCode),providerExecuted:!0})}else"codeExecutionResult"in a&&a.codeExecutionResult?(w.push({type:"tool-result",toolCallId:n,toolName:"code_execution",result:{outcome:a.codeExecutionResult.outcome,output:a.codeExecutionResult.output},providerExecuted:!0}),n=void 0):"text"in a&&null!=a.text&&a.text.length>0?w.push({type:!0===a.thought?"reasoning":"text",text:a.text,providerMetadata:a.thoughtSignature?{google:{thoughtSignature:a.thoughtSignature}}:void 0}):"functionCall"in a?w.push({type:"tool-call",toolCallId:this.config.generateId(),toolName:a.functionCall.name,input:JSON.stringify(a.functionCall.args),providerMetadata:a.thoughtSignature?{google:{thoughtSignature:a.thoughtSignature}}:void 0}):"inlineData"in a&&w.push({type:"file",data:a.inlineData.data,mediaType:a.inlineData.mimeType});for(let a of null!=(e=gK({groundingMetadata:v.groundingMetadata,generateId:this.config.generateId}))?e:[])w.push(a);return{content:w,finishReason:gC({finishReason:v.finishReason,hasToolCalls:w.some(a=>"tool-call"===a.type)}),usage:{inputTokens:null!=(f=null==y?void 0:y.promptTokenCount)?f:void 0,outputTokens:null!=(g=null==y?void 0:y.candidatesTokenCount)?g:void 0,totalTokens:null!=(h=null==y?void 0:y.totalTokenCount)?h:void 0,reasoningTokens:null!=(i=null==y?void 0:y.thoughtsTokenCount)?i:void 0,cachedInputTokens:null!=(j=null==y?void 0:y.cachedContentTokenCount)?j:void 0},warnings:p,providerMetadata:{google:{groundingMetadata:null!=(k=v.groundingMetadata)?k:null,urlContextMetadata:null!=(l=v.urlContextMetadata)?l:null,safetyRatings:null!=(m=v.safetyRatings)?m:null,usageMetadata:null!=y?y:null}},request:{body:q},response:{headers:s,body:u}}}async doStream(a){let b,c,{args:d,warnings:e}=await this.getArgs(a),f=JSON.stringify(d),g=ct(await cL(this.config.headers),a.headers),{responseHeaders:h,value:i}=await cI({url:`${this.config.baseURL}/${gA(this.modelId)}:streamGenerateContent?alt=sse`,headers:g,body:d,failedResponseHandler:gu,successfulResponseHandler:async({response:a})=>{let b=cu(a);if(null==a.body)throw new at({});return{responseHeaders:b,value:function({stream:a,schema:b}){return a.pipeThrough(new TextDecoderStream).pipeThrough(new a1).pipeThrough(new TransformStream({async transform({data:a},c){"[DONE]"!==a&&c.enqueue(await cF({text:a,schema:b}))}}))}({stream:a.body,schema:gP})}},abortSignal:a.abortSignal,fetch:this.config.fetch}),j="unknown",k={inputTokens:void 0,outputTokens:void 0,totalTokens:void 0},l=this.config.generateId,m=!1,n=null,o=null,p=0,q=new Set;return{stream:i.pipeThrough(new TransformStream({start(a){a.enqueue({type:"stream-start",warnings:e})},transform(d,e){var f,g,h,i,r,s,t,u,v,w,x,y;if(a.includeRawChunks&&e.enqueue({type:"raw",rawValue:d.rawValue}),!d.success)return void e.enqueue({type:"error",error:d.error});let z=d.value,A=z.usageMetadata;null!=A&&(k.inputTokens=null!=(f=A.promptTokenCount)?f:void 0,k.outputTokens=null!=(g=A.candidatesTokenCount)?g:void 0,k.totalTokens=null!=(h=A.totalTokenCount)?h:void 0,k.reasoningTokens=null!=(i=A.thoughtsTokenCount)?i:void 0,k.cachedInputTokens=null!=(r=A.cachedContentTokenCount)?r:void 0);let B=null==(s=z.candidates)?void 0:s[0];if(null==B)return;let C=B.content,D=gK({groundingMetadata:B.groundingMetadata,generateId:l});if(null!=D)for(let a of D)"url"!==a.sourceType||q.has(a.url)||(q.add(a.url),e.enqueue(a));if(null!=C){for(let a of null!=(t=C.parts)?t:[])if("executableCode"in a&&(null==(u=a.executableCode)?void 0:u.code)){let c=l();b=c,e.enqueue({type:"tool-call",toolCallId:c,toolName:"code_execution",input:JSON.stringify(a.executableCode),providerExecuted:!0}),m=!0}else if("codeExecutionResult"in a&&a.codeExecutionResult){let c=b;c&&(e.enqueue({type:"tool-result",toolCallId:c,toolName:"code_execution",result:{outcome:a.codeExecutionResult.outcome,output:a.codeExecutionResult.output},providerExecuted:!0}),b=void 0)}else"text"in a&&null!=a.text&&a.text.length>0&&(!0===a.thought?(null!==n&&(e.enqueue({type:"text-end",id:n}),n=null),null===o&&(o=String(p++),e.enqueue({type:"reasoning-start",id:o,providerMetadata:a.thoughtSignature?{google:{thoughtSignature:a.thoughtSignature}}:void 0})),e.enqueue({type:"reasoning-delta",id:o,delta:a.text,providerMetadata:a.thoughtSignature?{google:{thoughtSignature:a.thoughtSignature}}:void 0})):(null!==o&&(e.enqueue({type:"reasoning-end",id:o}),o=null),null===n&&(n=String(p++),e.enqueue({type:"text-start",id:n,providerMetadata:a.thoughtSignature?{google:{thoughtSignature:a.thoughtSignature}}:void 0})),e.enqueue({type:"text-delta",id:n,delta:a.text,providerMetadata:a.thoughtSignature?{google:{thoughtSignature:a.thoughtSignature}}:void 0})));let a=null==(y=C.parts)?void 0:y.filter(a=>"inlineData"in a);if(null!=a)for(let b of a)e.enqueue({type:"file",mediaType:b.inlineData.mimeType,data:b.inlineData.data});let c=function({parts:a,generateId:b}){let c=null==a?void 0:a.filter(a=>"functionCall"in a);return null==c||0===c.length?void 0:c.map(a=>({type:"tool-call",toolCallId:b(),toolName:a.functionCall.name,args:JSON.stringify(a.functionCall.args),providerMetadata:a.thoughtSignature?{google:{thoughtSignature:a.thoughtSignature}}:void 0}))}({parts:C.parts,generateId:l});if(null!=c)for(let a of c)e.enqueue({type:"tool-input-start",id:a.toolCallId,toolName:a.toolName,providerMetadata:a.providerMetadata}),e.enqueue({type:"tool-input-delta",id:a.toolCallId,delta:a.args,providerMetadata:a.providerMetadata}),e.enqueue({type:"tool-input-end",id:a.toolCallId,providerMetadata:a.providerMetadata}),e.enqueue({type:"tool-call",toolCallId:a.toolCallId,toolName:a.toolName,input:a.args,providerMetadata:a.providerMetadata}),m=!0}null!=B.finishReason&&(j=gC({finishReason:B.finishReason,hasToolCalls:m}),c={google:{groundingMetadata:null!=(v=B.groundingMetadata)?v:null,urlContextMetadata:null!=(w=B.urlContextMetadata)?w:null,safetyRatings:null!=(x=B.safetyRatings)?x:null}},null!=A&&(c.google.usageMetadata=A))},flush(a){null!==n&&a.enqueue({type:"text-end",id:n}),null!==o&&a.enqueue({type:"reasoning-end",id:o}),a.enqueue({type:"finish",finishReason:j,usage:k,providerMetadata:c})}})),response:{headers:h},request:{body:f}}}};function gK({groundingMetadata:a,generateId:b}){var c;return null==(c=null==a?void 0:a.groundingChunks)?void 0:c.filter(a=>null!=a.web).map(a=>({type:"source",sourceType:"url",id:b(),url:a.web.uri,title:a.web.title}))}var gL=f2({parts:f0(f6([f2({functionCall:f2({name:ft(),args:fY()}),thoughtSignature:ft().nullish()}),f2({inlineData:f2({mimeType:ft(),data:ft()})}),f2({executableCode:f2({language:ft(),code:ft()}).nullish(),codeExecutionResult:f2({outcome:ft(),output:ft()}).nullish(),text:ft().nullish(),thought:fT().nullish(),thoughtSignature:ft().nullish()})])).nullish()}),gM=f2({category:ft().nullish(),probability:ft().nullish(),probabilityScore:fP().nullish(),severity:ft().nullish(),severityScore:fP().nullish(),blocked:fT().nullish()}),gN=f2({cachedContentTokenCount:fP().nullish(),thoughtsTokenCount:fP().nullish(),promptTokenCount:fP().nullish(),candidatesTokenCount:fP().nullish(),totalTokenCount:fP().nullish()}),gO=f2({candidates:f0(f2({content:gL.nullish().or(f2({}).strict()),finishReason:ft().nullish(),safetyRatings:f0(gM).nullish(),groundingMetadata:gE.nullish(),urlContextMetadata:gH.nullish()})),usageMetadata:gN.nullish()}),gP=f2({candidates:f0(f2({content:gL.nullish(),finishReason:ft().nullish(),safetyRatings:f0(gM).nullish(),groundingMetadata:gE.nullish(),urlContextMetadata:gH.nullish()})).nullish(),usageMetadata:gN.nullish()}),gQ={googleSearch:gF,urlContext:gI,codeExecution:function({id:a,name:b,inputSchema:c,outputSchema:d}){return({execute:e,toModelOutput:f,onInputStart:g,onInputDelta:h,onInputAvailable:i,...j})=>({type:"provider-defined",id:a,name:b,args:j,inputSchema:c,outputSchema:d,execute:e,toModelOutput:f,onInputStart:g,onInputDelta:h,onInputAvailable:i})}({id:"google.code_execution",name:"code_execution",inputSchema:f2({language:ft().describe("The programming language of the code."),code:ft().describe("The code to be executed.")}),outputSchema:f2({outcome:ft().describe('The outcome of the execution (e.g., "OUTCOME_OK").'),output:ft().describe("The output from the code execution.")})})},gR=class{constructor(a,b,c){this.modelId=a,this.settings=b,this.config=c,this.specificationVersion="v2"}get maxImagesPerCall(){var a;return null!=(a=this.settings.maxImagesPerCall)?a:4}get provider(){return this.config.provider}async doGenerate(a){var b,c,d;let{prompt:e,n:f=1,size:g="1024x1024",aspectRatio:h="1:1",seed:i,providerOptions:j,headers:k,abortSignal:l}=a,m=[];null!=g&&m.push({type:"unsupported-setting",setting:"size",details:"This model does not support the `size` option. Use `aspectRatio` instead."}),null!=i&&m.push({type:"unsupported-setting",setting:"seed",details:"This model does not support the `seed` option through this provider."});let n=await cG({provider:"google",providerOptions:j,schema:gT}),o=null!=(d=null==(c=null==(b=this.config._internal)?void 0:b.currentDate)?void 0:c.call(b))?d:new Date,p={sampleCount:f};null!=h&&(p.aspectRatio=h),n&&Object.assign(p,n);let{responseHeaders:q,value:r}=await cI({url:`${this.config.baseURL}/models/${this.modelId}:predict`,headers:ct(await cL(this.config.headers),k),body:{instances:[{prompt:e}],parameters:p},failedResponseHandler:gu,successfulResponseHandler:cM(gS),abortSignal:l,fetch:this.config.fetch});return{images:r.predictions.map(a=>a.bytesBase64Encoded),warnings:null!=m?m:[],providerMetadata:{google:{images:r.predictions.map(a=>({}))}},response:{timestamp:o,modelId:this.modelId,headers:q}}}},gS=f2({predictions:f0(f2({bytesBase64Encoded:ft()})).default([])}),gT=f2({personGeneration:gc(["dont_allow","allow_adult","allow_all"]).nullish(),aspectRatio:gc(["1:1","3:4","4:3","9:16","16:9"]).nullish()}),gU=function(a={}){var b,c;let d=null!=(b=null==(c=a.baseURL)?void 0:c.replace(/\/$/,""))?b:"https://generativelanguage.googleapis.com/v1beta",e=()=>({"x-goog-api-key":function({apiKey:a,environmentVariableName:b,apiKeyParameterName:c="apiKey",description:d}){if("string"==typeof a)return a;if(null!=a)throw new aK({message:`${d} API key must be a string.`});if("undefined"==typeof process)throw new aK({message:`${d} API key is missing. Pass it using the '${c}' parameter. Environment variables is not supported in this environment.`});if(null==(a=process.env[b]))throw new aK({message:`${d} API key is missing. Pass it using the '${c}' parameter or the ${b} environment variable.`});if("string"!=typeof a)throw new aK({message:`${d} API key must be a string. The value of the ${b} environment variable is not a string.`});return a}({apiKey:a.apiKey,environmentVariableName:"GOOGLE_GENERATIVE_AI_API_KEY",description:"Google Generative AI"}),...a.headers}),f=b=>{var c;return new gJ(b,{provider:"google.generative-ai",baseURL:d,headers:e,generateId:null!=(c=a.generateId)?c:cv,supportedUrls:()=>({"*":[RegExp(`^${d}/files/.*$`),RegExp("^https://(?:www\\.)?youtube\\.com/watch\\?v=[\\w-]+(?:&[\\w=&.-]*)?$"),RegExp("^https://youtu\\.be/[\\w-]+(?:\\?[\\w=&.-]*)?$")]}),fetch:a.fetch})},g=b=>new gw(b,{provider:"google.generative-ai",baseURL:d,headers:e,fetch:a.fetch}),h=(b,c={})=>new gR(b,c,{provider:"google.generative-ai",baseURL:d,headers:e,fetch:a.fetch}),i=function(a){if(new.target)throw Error("The Google Generative AI model function cannot be called with the new keyword.");return f(a)};return i.languageModel=f,i.chat=f,i.generativeAI=f,i.embedding=g,i.textEmbedding=g,i.textEmbeddingModel=g,i.image=h,i.imageModel=h,i.tools=gQ,i}();class gV{constructor(a){this.counter=0,this.metadataRegistry=a?.metadata??e4,this.target=a?.target??"draft-2020-12",this.unrepresentable=a?.unrepresentable??"throw",this.override=a?.override??(()=>{}),this.io=a?.io??"output",this.seen=new Map}process(a,b={path:[],schemaPath:[]}){var c;let d=a._zod.def,e=this.seen.get(a);if(e)return e.count++,b.schemaPath.includes(a)&&(e.cycle=b.path),e.schema;let f={schema:{},count:1,cycle:void 0,path:b.path};this.seen.set(a,f);let g=a._zod.toJSONSchema?.();if(g)f.schema=g;else{let c={...b,schemaPath:[...b.schemaPath,a],path:b.path},e=a._zod.parent;if(e)f.ref=e,this.process(e,c),this.seen.get(e).isParent=!0;else{let b=f.schema;switch(d.type){case"string":{b.type="string";let{minimum:c,maximum:d,format:e,patterns:g,contentEncoding:h}=a._zod.bag;if("number"==typeof c&&(b.minLength=c),"number"==typeof d&&(b.maxLength=d),e&&(b.format=({guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""})[e]??e,""===b.format&&delete b.format),h&&(b.contentEncoding=h),g&&g.size>0){let a=[...g];1===a.length?b.pattern=a[0].source:a.length>1&&(f.schema.allOf=[...a.map(a=>({..."draft-7"===this.target?{type:"string"}:{},pattern:a.source}))])}break}case"number":{let{minimum:c,maximum:d,format:e,multipleOf:f,exclusiveMaximum:g,exclusiveMinimum:h}=a._zod.bag;"string"==typeof e&&e.includes("int")?b.type="integer":b.type="number","number"==typeof h&&(b.exclusiveMinimum=h),"number"==typeof c&&(b.minimum=c,"number"==typeof h&&(h>=c?delete b.minimum:delete b.exclusiveMinimum)),"number"==typeof g&&(b.exclusiveMaximum=g),"number"==typeof d&&(b.maximum=d,"number"==typeof g&&(g<=d?delete b.maximum:delete b.exclusiveMaximum)),"number"==typeof f&&(b.multipleOf=f);break}case"boolean":case"success":b.type="boolean";break;case"bigint":if("throw"===this.unrepresentable)throw Error("BigInt cannot be represented in JSON Schema");break;case"symbol":if("throw"===this.unrepresentable)throw Error("Symbols cannot be represented in JSON Schema");break;case"null":b.type="null";break;case"any":case"unknown":break;case"undefined":if("throw"===this.unrepresentable)throw Error("Undefined cannot be represented in JSON Schema");break;case"void":if("throw"===this.unrepresentable)throw Error("Void cannot be represented in JSON Schema");break;case"never":b.not={};break;case"date":if("throw"===this.unrepresentable)throw Error("Date cannot be represented in JSON Schema");break;case"array":{let{minimum:e,maximum:f}=a._zod.bag;"number"==typeof e&&(b.minItems=e),"number"==typeof f&&(b.maxItems=f),b.type="array",b.items=this.process(d.element,{...c,path:[...c.path,"items"]});break}case"object":{b.type="object",b.properties={};let a=d.shape;for(let d in a)b.properties[d]=this.process(a[d],{...c,path:[...c.path,"properties",d]});let e=new Set([...new Set(Object.keys(a))].filter(a=>{let b=d.shape[a]._zod;return"input"===this.io?void 0===b.optin:void 0===b.optout}));e.size>0&&(b.required=Array.from(e)),d.catchall?._zod.def.type==="never"?b.additionalProperties=!1:d.catchall?d.catchall&&(b.additionalProperties=this.process(d.catchall,{...c,path:[...c.path,"additionalProperties"]})):"output"===this.io&&(b.additionalProperties=!1);break}case"union":b.anyOf=d.options.map((a,b)=>this.process(a,{...c,path:[...c.path,"anyOf",b]}));break;case"intersection":{let a=this.process(d.left,{...c,path:[...c.path,"allOf",0]}),e=this.process(d.right,{...c,path:[...c.path,"allOf",1]}),f=a=>"allOf"in a&&1===Object.keys(a).length;b.allOf=[...f(a)?a.allOf:[a],...f(e)?e.allOf:[e]];break}case"tuple":{b.type="array";let e=d.items.map((a,b)=>this.process(a,{...c,path:[...c.path,"prefixItems",b]}));if("draft-2020-12"===this.target?b.prefixItems=e:b.items=e,d.rest){let a=this.process(d.rest,{...c,path:[...c.path,"items"]});"draft-2020-12"===this.target?b.items=a:b.additionalItems=a}d.rest&&(b.items=this.process(d.rest,{...c,path:[...c.path,"items"]}));let{minimum:f,maximum:g}=a._zod.bag;"number"==typeof f&&(b.minItems=f),"number"==typeof g&&(b.maxItems=g);break}case"record":b.type="object",b.propertyNames=this.process(d.keyType,{...c,path:[...c.path,"propertyNames"]}),b.additionalProperties=this.process(d.valueType,{...c,path:[...c.path,"additionalProperties"]});break;case"map":if("throw"===this.unrepresentable)throw Error("Map cannot be represented in JSON Schema");break;case"set":if("throw"===this.unrepresentable)throw Error("Set cannot be represented in JSON Schema");break;case"enum":{let a=dj(d.entries);a.every(a=>"number"==typeof a)&&(b.type="number"),a.every(a=>"string"==typeof a)&&(b.type="string"),b.enum=a;break}case"literal":{let a=[];for(let b of d.values)if(void 0===b){if("throw"===this.unrepresentable)throw Error("Literal `undefined` cannot be represented in JSON Schema")}else if("bigint"==typeof b)if("throw"===this.unrepresentable)throw Error("BigInt literals cannot be represented in JSON Schema");else a.push(Number(b));else a.push(b);if(0===a.length);else if(1===a.length){let c=a[0];b.type=null===c?"null":typeof c,b.const=c}else a.every(a=>"number"==typeof a)&&(b.type="number"),a.every(a=>"string"==typeof a)&&(b.type="string"),a.every(a=>"boolean"==typeof a)&&(b.type="string"),a.every(a=>null===a)&&(b.type="null"),b.enum=a;break}case"file":{let c={type:"string",format:"binary",contentEncoding:"binary"},{minimum:d,maximum:e,mime:f}=a._zod.bag;void 0!==d&&(c.minLength=d),void 0!==e&&(c.maxLength=e),f?1===f.length?(c.contentMediaType=f[0],Object.assign(b,c)):b.anyOf=f.map(a=>({...c,contentMediaType:a})):Object.assign(b,c);break}case"transform":if("throw"===this.unrepresentable)throw Error("Transforms cannot be represented in JSON Schema");break;case"nullable":b.anyOf=[this.process(d.innerType,c),{type:"null"}];break;case"nonoptional":case"promise":case"optional":this.process(d.innerType,c),f.ref=d.innerType;break;case"default":this.process(d.innerType,c),f.ref=d.innerType,b.default=JSON.parse(JSON.stringify(d.defaultValue));break;case"prefault":this.process(d.innerType,c),f.ref=d.innerType,"input"===this.io&&(b._prefault=JSON.parse(JSON.stringify(d.defaultValue)));break;case"catch":{let a;this.process(d.innerType,c),f.ref=d.innerType;try{a=d.catchValue(void 0)}catch{throw Error("Dynamic catch values are not supported in JSON Schema")}b.default=a;break}case"nan":if("throw"===this.unrepresentable)throw Error("NaN cannot be represented in JSON Schema");break;case"template_literal":{let c=a._zod.pattern;if(!c)throw Error("Pattern not found in template literal");b.type="string",b.pattern=c.source;break}case"pipe":{let a="input"===this.io?"transform"===d.in._zod.def.type?d.out:d.in:d.out;this.process(a,c),f.ref=a;break}case"readonly":this.process(d.innerType,c),f.ref=d.innerType,b.readOnly=!0;break;case"lazy":{let b=a._zod.innerType;this.process(b,c),f.ref=b;break}case"custom":if("throw"===this.unrepresentable)throw Error("Custom types cannot be represented in JSON Schema")}}}let h=this.metadataRegistry.get(a);return h&&Object.assign(f.schema,h),"input"===this.io&&function a(b,c){let d=c??{seen:new Set};if(d.seen.has(b))return!1;d.seen.add(b);let e=b._zod.def;switch(e.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":case"custom":case"success":case"catch":return!1;case"array":return a(e.element,d);case"object":for(let b in e.shape)if(a(e.shape[b],d))return!0;return!1;case"union":for(let b of e.options)if(a(b,d))return!0;return!1;case"intersection":return a(e.left,d)||a(e.right,d);case"tuple":for(let b of e.items)if(a(b,d))return!0;if(e.rest&&a(e.rest,d))return!0;return!1;case"record":case"map":return a(e.keyType,d)||a(e.valueType,d);case"set":return a(e.valueType,d);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":case"default":case"prefault":return a(e.innerType,d);case"lazy":return a(e.getter(),d);case"transform":return!0;case"pipe":return a(e.in,d)||a(e.out,d)}throw Error(`Unknown schema type: ${e.type}`)}(a)&&(delete f.schema.examples,delete f.schema.default),"input"===this.io&&f.schema._prefault&&((c=f.schema).default??(c.default=f.schema._prefault)),delete f.schema._prefault,this.seen.get(a).schema}emit(a,b){let c={cycles:b?.cycles??"ref",reused:b?.reused??"inline",external:b?.external??void 0},d=this.seen.get(a);if(!d)throw Error("Unprocessed schema. This is a bug in Zod.");let e=a=>{let b="draft-2020-12"===this.target?"$defs":"definitions";if(c.external){let d=c.external.registry.get(a[0])?.id,e=c.external.uri??(a=>a);if(d)return{ref:e(d)};let f=a[1].defId??a[1].schema.id??`schema${this.counter++}`;return a[1].defId=f,{defId:f,ref:`${e("__shared")}#/${b}/${f}`}}if(a[1]===d)return{ref:"#"};let e=`#/${b}/`,f=a[1].schema.id??`__schema${this.counter++}`;return{defId:f,ref:e+f}},f=a=>{if(a[1].schema.$ref)return;let b=a[1],{ref:c,defId:d}=e(a);b.def={...b.schema},d&&(b.defId=d);let f=b.schema;for(let a in f)delete f[a];f.$ref=c};if("throw"===c.cycles)for(let a of this.seen.entries()){let b=a[1];if(b.cycle)throw Error(`Cycle detected: #/${b.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let b of this.seen.entries()){let d=b[1];if(a===b[0]){f(b);continue}if(c.external){let d=c.external.registry.get(b[0])?.id;if(a!==b[0]&&d){f(b);continue}}if(this.metadataRegistry.get(b[0])?.id||d.cycle||d.count>1&&"ref"===c.reused){f(b);continue}}let g=(a,b)=>{let c=this.seen.get(a),d=c.def??c.schema,e={...d};if(null===c.ref)return;let f=c.ref;if(c.ref=null,f){g(f,b);let a=this.seen.get(f).schema;a.$ref&&"draft-7"===b.target?(d.allOf=d.allOf??[],d.allOf.push(a)):(Object.assign(d,a),Object.assign(d,e))}c.isParent||this.override({zodSchema:a,jsonSchema:d,path:c.path??[]})};for(let a of[...this.seen.entries()].reverse())g(a[0],{target:this.target});let h={};if("draft-2020-12"===this.target?h.$schema="https://json-schema.org/draft/2020-12/schema":"draft-7"===this.target?h.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.target}`),c.external?.uri){let b=c.external.registry.get(a)?.id;if(!b)throw Error("Schema is missing an `id` property");h.$id=c.external.uri(b)}Object.assign(h,d.def);let i=c.external?.defs??{};for(let a of this.seen.entries()){let b=a[1];b.def&&b.defId&&(i[b.defId]=b.def)}c.external||Object.keys(i).length>0&&("draft-2020-12"===this.target?h.$defs=i:h.definitions=i);try{return JSON.parse(JSON.stringify(h))}catch(a){throw Error("Error converting schema to JSON.")}}}function gW(...a){return a.reduce((a,b)=>({...a,...null!=b?b:{}}),{})}async function gX(a,b){if(null==a)return Promise.resolve();let c=null==b?void 0:b.abortSignal;return new Promise((b,d)=>{if(null==c?void 0:c.aborted)return void d(gY());let e=setTimeout(()=>{f(),b()},a),f=()=>{clearTimeout(e),null==c||c.removeEventListener("abort",g)},g=()=>{f(),d(gY())};null==c||c.addEventListener("abort",g)})}function gY(){return new DOMException("Delay was aborted","AbortError")}function gZ(a){return Object.fromEntries([...a.headers])}var g$=({prefix:a,size:b=16,alphabet:c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:d="-"}={})=>{let e=()=>{let a=c.length,d=Array(b);for(let e=0;e<b;e++)d[e]=c[Math.random()*a|0];return d.join("")};if(null==a)return e;if(c.includes(d))throw new ay({argument:"separator",message:`The separator "${d}" must not be part of the alphabet "${c}".`});return()=>`${a}${d}${e()}`},g_=g$();function g0(a){return null==a?"unknown error":"string"==typeof a?a:a instanceof Error?a.message:JSON.stringify(a)}function g1(a){return(a instanceof Error||a instanceof DOMException)&&("AbortError"===a.name||"ResponseAborted"===a.name||"TimeoutError"===a.name)}var g2=["fetch failed","failed to fetch"];function g3({error:a,url:b,requestBodyValues:c}){if(g1(a))return a;if(a instanceof TypeError&&g2.includes(a.message.toLowerCase())){let d=a.cause;if(null!=d)return new ap({message:`Cannot connect to API: ${d.message}`,cause:d,url:b,requestBodyValues:c,isRetryable:!0})}return a}function g4(a){return Object.fromEntries(Object.entries(a).filter(([a,b])=>null!=b))}var g5=()=>globalThis.fetch,g6=async({url:a,headers:b={},successfulResponseHandler:c,failedResponseHandler:d,abortSignal:e,fetch:f=g5()})=>{try{let g=await f(a,{method:"GET",headers:g4(b),signal:e}),h=gZ(g);if(!g.ok){let b;try{b=await d({response:g,url:a,requestBodyValues:{}})}catch(b){if(g1(b)||ap.isInstance(b))throw b;throw new ap({message:"Failed to process error response",cause:b,statusCode:g.status,url:a,responseHeaders:h,requestBodyValues:{}})}throw b.value}try{return await c({response:g,url:a,requestBodyValues:{}})}catch(b){if(b instanceof Error&&(g1(b)||ap.isInstance(b)))throw b;throw new ap({message:"Failed to process successful response",cause:b,statusCode:g.status,url:a,responseHeaders:h,requestBodyValues:{}})}}catch(b){throw g3({error:b,url:a,requestBodyValues:{}})}};function g7({settingValue:a,environmentVariableName:b}){return"string"==typeof a?a:null!=a||"undefined"==typeof process?void 0:null!=(a=process.env[b])&&"string"==typeof a?a:void 0}var g8=/"__proto__"\s*:/,g9=/"constructor"\s*:/;function ha(a){let{stackTraceLimit:b}=Error;Error.stackTraceLimit=0;try{let b=JSON.parse(a);return null===b||"object"!=typeof b||!1===g8.test(a)&&!1===g9.test(a)?b:function(a){let b=[a];for(;b.length;){let a=b;for(let c of(b=[],a)){if(Object.prototype.hasOwnProperty.call(c,"__proto__")||Object.prototype.hasOwnProperty.call(c,"constructor")&&Object.prototype.hasOwnProperty.call(c.constructor,"prototype"))throw SyntaxError("Object contains forbidden prototype property");for(let a in c){let d=c[a];d&&"object"==typeof d&&b.push(d)}}}return a}(b)}finally{Error.stackTraceLimit=b}}var hb=Symbol.for("vercel.ai.validator");async function hc({value:a,schema:b}){let c=await hd({value:a,schema:b});if(!c.success)throw aW.wrap({value:a,cause:c.error});return c.value}async function hd({value:a,schema:b}){var c;let d="object"==typeof b&&null!==b&&hb in b&&!0===b[hb]&&"validate"in b?b:(c=b,{[hb]:!0,validate:async a=>{let b=await c["~standard"].validate(a);return null==b.issues?{success:!0,value:b.value}:{success:!1,error:new aW({value:a,cause:b.issues})}}});try{if(null==d.validate)return{success:!0,value:a,rawValue:a};let b=await d.validate(a);if(b.success)return{success:!0,value:b.value,rawValue:a};return{success:!1,error:aW.wrap({value:a,cause:b.error}),rawValue:a}}catch(b){return{success:!1,error:aW.wrap({value:a,cause:b}),rawValue:a}}}async function he({text:a,schema:b}){try{let c=ha(a);if(null==b)return c;return hc({value:c,schema:b})}catch(b){if(aG.isInstance(b)||aW.isInstance(b))throw b;throw new aG({text:a,cause:b})}}async function hf({text:a,schema:b}){try{let c=ha(a);if(null==b)return{success:!0,value:c,rawValue:c};return await hd({value:c,schema:b})}catch(b){return{success:!1,error:aG.isInstance(b)?b:new aG({text:a,cause:b}),rawValue:void 0}}}var hg=()=>globalThis.fetch,hh=async({url:a,headers:b,body:c,failedResponseHandler:d,successfulResponseHandler:e,abortSignal:f,fetch:g})=>hi({url:a,headers:{"Content-Type":"application/json",...b},body:{content:JSON.stringify(c),values:c},failedResponseHandler:d,successfulResponseHandler:e,abortSignal:f,fetch:g}),hi=async({url:a,headers:b={},body:c,successfulResponseHandler:d,failedResponseHandler:e,abortSignal:f,fetch:g=hg()})=>{try{let h=await g(a,{method:"POST",headers:g4(b),body:c.content,signal:f}),i=gZ(h);if(!h.ok){let b;try{b=await e({response:h,url:a,requestBodyValues:c.values})}catch(b){if(g1(b)||ap.isInstance(b))throw b;throw new ap({message:"Failed to process error response",cause:b,statusCode:h.status,url:a,responseHeaders:i,requestBodyValues:c.values})}throw b.value}try{return await d({response:h,url:a,requestBodyValues:c.values})}catch(b){if(b instanceof Error&&(g1(b)||ap.isInstance(b)))throw b;throw new ap({message:"Failed to process successful response",cause:b,statusCode:h.status,url:a,responseHeaders:i,requestBodyValues:c.values})}}catch(b){throw g3({error:b,url:a,requestBodyValues:c.values})}};async function hj(a){return"function"==typeof a&&(a=a()),Promise.resolve(a)}var hk=({errorSchema:a,errorToMessage:b,isRetryable:c})=>async({response:d,url:e,requestBodyValues:f})=>{let g=await d.text(),h=gZ(d);if(""===g.trim())return{responseHeaders:h,value:new ap({message:d.statusText,url:e,requestBodyValues:f,statusCode:d.status,responseHeaders:h,responseBody:g,isRetryable:null==c?void 0:c(d)})};try{let i=await he({text:g,schema:a});return{responseHeaders:h,value:new ap({message:b(i),url:e,requestBodyValues:f,statusCode:d.status,responseHeaders:h,responseBody:g,data:i,isRetryable:null==c?void 0:c(d,i)})}}catch(a){return{responseHeaders:h,value:new ap({message:d.statusText,url:e,requestBodyValues:f,statusCode:d.status,responseHeaders:h,responseBody:g,isRetryable:null==c?void 0:c(d)})}}},hl=a=>async({response:b,url:c,requestBodyValues:d})=>{let e=await b.text(),f=await hf({text:e,schema:a}),g=gZ(b);if(!f.success)throw new ap({message:"Invalid JSON response",cause:f.error,statusCode:b.status,responseHeaders:g,responseBody:e,url:c,requestBodyValues:d});return{responseHeaders:g,value:f.value,rawValue:f.rawValue}},hm=Symbol.for("vercel.ai.schema");function hn(a,{validate:b}={}){return{[hm]:!0,_type:void 0,[hb]:!0,jsonSchema:a,validate:b}}function ho(a){return null==a?hn({properties:{},additionalProperties:!1}):"object"==typeof a&&null!==a&&hm in a&&!0===a[hm]&&"jsonSchema"in a&&"validate"in a?a:function(a,b){var c;return"_zod"in a?hn(function(a,b){if(a instanceof e3){let c=new gV(b),d={};for(let b of a._idmap.entries()){let[a,d]=b;c.process(d)}let e={},f={registry:a,uri:b?.uri,defs:d};for(let d of a._idmap.entries()){let[a,g]=d;e[a]=c.emit(g,{...b,external:f})}return Object.keys(d).length>0&&(e.__shared={["draft-2020-12"===c.target?"$defs":"definitions"]:d}),{schemas:e}}let c=new gV(b);return c.process(a),c.emit(a,b)}(a,{target:"draft-7",io:"output",reused:"inline"}),{validate:async b=>{let c=await fp(a,b);return c.success?{success:!0,value:c.data}:{success:!1,error:c.error}}}):hn(((a,b)=>{let c=(a=>{let b,c="string"==typeof(b=a)?{...a3,name:b}:{...a3,...b},d=void 0!==c.name?[...c.basePath,c.definitionPath,c.name]:c.basePath;return{...c,flags:{hasReferencedOpenAiAnyType:!1},currentPath:d,propertyPath:void 0,seen:new Map(Object.entries(c.definitions).map(([a,b])=>[b._def,{def:b._def,path:[...c.basePath,c.definitionPath,a],jsonSchema:void 0}]))}})(b),d="object"==typeof b&&b.definitions?Object.entries(b.definitions).reduce((a,[b,d])=>({...a,[b]:cq(d._def,{...c,currentPath:[...c.basePath,c.definitionPath,b]},!0)??cc(c)}),{}):void 0,e="string"==typeof b?b:b?.nameStrategy==="title"?void 0:b?.name,f=cq(a._def,void 0===e?c:{...c,currentPath:[...c.basePath,c.definitionPath,e]},!1)??cc(c),g="object"==typeof b&&void 0!==b.name&&"title"===b.nameStrategy?b.name:void 0;void 0!==g&&(f.title=g),c.flags.hasReferencedOpenAiAnyType&&(d||(d={}),d[c.openAiAnyTypeName]||(d[c.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:"relative"===c.$refStrategy?"1":[...c.basePath,c.definitionPath,c.openAiAnyTypeName].join("/")}}));let h=void 0===e?d?{...f,[c.definitionPath]:d}:f:{$ref:[..."relative"===c.$refStrategy?[]:c.basePath,c.definitionPath,e].join("/"),[c.definitionPath]:{...d,[e]:f}};return"jsonSchema7"===c.target?h.$schema="http://json-schema.org/draft-07/schema#":("jsonSchema2019-09"===c.target||"openAi"===c.target)&&(h.$schema="https://json-schema.org/draft/2019-09/schema#"),"openAi"===c.target&&("anyOf"in h||"oneOf"in h||"allOf"in h||"type"in h&&Array.isArray(h.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),h})(a,{$refStrategy:(c=void 0,"none"),target:"jsonSchema7"}),{validate:async b=>{let c=await a.safeParseAsync(b);return c.success?{success:!0,value:c.data}:{success:!1,error:c.error}}})}(a)}var{btoa:hp,atob:hq}=globalThis;function hr(a){let b=hq(a.replace(/-/g,"+").replace(/_/g,"/"));return Uint8Array.from(b,a=>a.codePointAt(0))}function hs(a){let b="";for(let c=0;c<a.length;c++)b+=String.fromCodePoint(a[c]);return hp(b)}async function*ht({execute:a,input:b,options:c}){let d=a(b,c);if(null!=d&&"function"==typeof d[Symbol.asyncIterator]){let a;for await(let b of d)a=b,yield{type:"preliminary",output:b};yield{type:"final",output:a}}else yield{type:"final",output:await d}}var hu=Symbol.for("vercel.ai.gateway.error"),hv=class a extends(v=Error,u=hu,v){constructor({message:a,statusCode:b=500,cause:c}){super(a),this[u]=!0,this.statusCode=b,this.cause=c}static isInstance(b){return a.hasMarker(b)}static hasMarker(a){return"object"==typeof a&&null!==a&&hu in a&&!0===a[hu]}},hw="GatewayAuthenticationError",hx=Symbol.for(`vercel.ai.gateway.error.${hw}`),hy=class a extends(x=hv,w=hx,x){constructor({message:a="Authentication failed",statusCode:b=401,cause:c}={}){super({message:a,statusCode:b,cause:c}),this[w]=!0,this.name=hw,this.type="authentication_error"}static isInstance(a){return hv.hasMarker(a)&&hx in a}static createContextualError({apiKeyProvided:b,oidcTokenProvided:c,message:d="Authentication failed",statusCode:e=401,cause:f}){return new a({message:b?`AI Gateway authentication failed: Invalid API key provided.

The token is expected to be provided via the 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`:c?`AI Gateway authentication failed: Invalid OIDC token provided.

The token is expected to be provided via the 'VERCEL_OIDC_TOKEN' environment variable. It expires every 12 hours.
- make sure your Vercel project settings have OIDC enabled
- if running locally with 'vercel dev', the token is automatically obtained and refreshed
- if running locally with your own dev server, run 'vercel env pull' to fetch the token
- in production/preview, the token is automatically obtained and refreshed

Alternative: Provide an API key via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`:`AI Gateway authentication failed: No authentication provided.

Provide either an API key or OIDC token.

API key instructions:

The token is expected to be provided via the 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.

OIDC token instructions:

The token is expected to be provided via the 'VERCEL_OIDC_TOKEN' environment variable. It expires every 12 hours.
- make sure your Vercel project settings have OIDC enabled
- if running locally with 'vercel dev', the token is automatically obtained and refreshed
- if running locally with your own dev server, run 'vercel env pull' to fetch the token
- in production/preview, the token is automatically obtained and refreshed`,statusCode:e,cause:f})}},hz="GatewayInvalidRequestError",hA=Symbol.for(`vercel.ai.gateway.error.${hz}`),hB=class extends(z=hv,y=hA,z){constructor({message:a="Invalid request",statusCode:b=400,cause:c}={}){super({message:a,statusCode:b,cause:c}),this[y]=!0,this.name=hz,this.type="invalid_request_error"}static isInstance(a){return hv.hasMarker(a)&&hA in a}},hC="GatewayRateLimitError",hD=Symbol.for(`vercel.ai.gateway.error.${hC}`),hE=class extends(B=hv,A=hD,B){constructor({message:a="Rate limit exceeded",statusCode:b=429,cause:c}={}){super({message:a,statusCode:b,cause:c}),this[A]=!0,this.name=hC,this.type="rate_limit_exceeded"}static isInstance(a){return hv.hasMarker(a)&&hD in a}},hF="GatewayModelNotFoundError",hG=Symbol.for(`vercel.ai.gateway.error.${hF}`),hH=f2({modelId:ft()}),hI=class extends(D=hv,C=hG,D){constructor({message:a="Model not found",statusCode:b=404,modelId:c,cause:d}={}){super({message:a,statusCode:b,cause:d}),this[C]=!0,this.name=hF,this.type="model_not_found",this.modelId=c}static isInstance(a){return hv.hasMarker(a)&&hG in a}},hJ="GatewayInternalServerError",hK=Symbol.for(`vercel.ai.gateway.error.${hJ}`),hL=class extends(F=hv,E=hK,F){constructor({message:a="Internal server error",statusCode:b=500,cause:c}={}){super({message:a,statusCode:b,cause:c}),this[E]=!0,this.name=hJ,this.type="internal_server_error"}static isInstance(a){return hv.hasMarker(a)&&hK in a}},hM="GatewayResponseError",hN=Symbol.for(`vercel.ai.gateway.error.${hM}`),hO=class extends(H=hv,G=hN,H){constructor({message:a="Invalid response from Gateway",statusCode:b=502,response:c,validationError:d,cause:e}={}){super({message:a,statusCode:b,cause:e}),this[G]=!0,this.name=hM,this.type="response_error",this.response=c,this.validationError=d}static isInstance(a){return hv.hasMarker(a)&&hN in a}};function hP({response:a,statusCode:b,defaultMessage:c="Gateway request failed",cause:d,authMethod:e}){let f=hQ.safeParse(a);if(!f.success)return new hO({message:`Invalid error response format: ${c}`,statusCode:b,response:a,validationError:f.error,cause:d});let g=f.data,h=g.error.type,i=g.error.message;switch(h){case"authentication_error":return hy.createContextualError({apiKeyProvided:"api-key"===e,oidcTokenProvided:"oidc"===e,statusCode:b,cause:d});case"invalid_request_error":return new hB({message:i,statusCode:b,cause:d});case"rate_limit_exceeded":return new hE({message:i,statusCode:b,cause:d});case"model_not_found":{let a=hH.safeParse(g.error.param);return new hI({message:i,statusCode:b,modelId:a.success?a.data.modelId:void 0,cause:d})}default:return new hL({message:i,statusCode:b,cause:d})}}var hQ=f2({error:f2({message:ft(),type:ft().nullish(),param:fY().nullish(),code:f6([ft(),fP()]).nullish()})});function hR(a,b){var c;return hv.isInstance(a)?a:ap.isInstance(a)?hP({response:function(a){if(void 0!==a.data)return a.data;if(null!=a.responseBody)try{return JSON.parse(a.responseBody)}catch(b){return a.responseBody}return{}}(a),statusCode:null!=(c=a.statusCode)?c:500,defaultMessage:"Gateway request failed",cause:a,authMethod:b}):hP({response:{},statusCode:500,defaultMessage:a instanceof Error?`Gateway request failed: ${a.message}`:"Unknown Gateway error",cause:a,authMethod:b})}var hS="ai-gateway-auth-method";function hT(a){let b=hU.safeParse(a[hS]);return b.success?b.data:void 0}var hU=f6([ge("api-key"),ge("oidc")]),hV=class{constructor(a){this.config=a}async getAvailableModels(){try{let{value:a}=await g6({url:`${this.config.baseURL}/config`,headers:await hj(this.config.headers()),successfulResponseHandler:hl(hZ),failedResponseHandler:hk({errorSchema:fW(),errorToMessage:a=>a}),fetch:this.config.fetch});return a}catch(a){throw hR(a)}}},hW=f2({specificationVersion:ge("v2"),provider:ft(),modelId:ft()}),hX=f2({input:ft(),output:ft()}),hY=f2({id:ft(),name:ft(),description:ft().nullish(),pricing:hX.nullish(),specification:hW}),hZ=f2({models:f0(hY)}),h$=class{constructor(a,b){this.modelId=a,this.config=b,this.specificationVersion="v2",this.supportedUrls={"*/*":[/.*/]}}get provider(){return this.config.provider}async getArgs(a){let{abortSignal:b,...c}=a;return{args:this.maybeEncodeFileParts(c),warnings:[]}}async doGenerate(a){let{args:b,warnings:c}=await this.getArgs(a),{abortSignal:d}=a,e=await hj(this.config.headers());try{let{responseHeaders:f,value:g,rawValue:h}=await hh({url:this.getUrl(),headers:gW(e,a.headers,this.getModelConfigHeaders(this.modelId,!1),await hj(this.config.o11yHeaders)),body:b,successfulResponseHandler:hl(fW()),failedResponseHandler:hk({errorSchema:fW(),errorToMessage:a=>a}),...d&&{abortSignal:d},fetch:this.config.fetch});return{...g,request:{body:b},response:{headers:f,body:h},warnings:c}}catch(a){throw hR(a,hT(e))}}async doStream(a){let{args:b,warnings:c}=await this.getArgs(a),{abortSignal:d}=a,e=await hj(this.config.headers());try{let f,{value:g,responseHeaders:h}=await hh({url:this.getUrl(),headers:gW(e,a.headers,this.getModelConfigHeaders(this.modelId,!0),await hj(this.config.o11yHeaders)),body:b,successfulResponseHandler:(f=fW(),async({response:a})=>{let b=gZ(a);if(null==a.body)throw new at({});return{responseHeaders:b,value:function({stream:a,schema:b}){return a.pipeThrough(new TextDecoderStream).pipeThrough(new a1).pipeThrough(new TransformStream({async transform({data:a},c){"[DONE]"!==a&&c.enqueue(await hf({text:a,schema:b}))}}))}({stream:a.body,schema:f})}}),failedResponseHandler:hk({errorSchema:fW(),errorToMessage:a=>a}),...d&&{abortSignal:d},fetch:this.config.fetch});return{stream:g.pipeThrough(new TransformStream({start(a){c.length>0&&a.enqueue({type:"stream-start",warnings:c})},transform(b,c){if(b.success){let d=b.value;("raw"!==d.type||a.includeRawChunks)&&("response-metadata"===d.type&&d.timestamp&&"string"==typeof d.timestamp&&(d.timestamp=new Date(d.timestamp)),c.enqueue(d))}else c.error(b.error)}})),request:{body:b},response:{headers:h}}}catch(a){throw hR(a,hT(e))}}isFilePart(a){return a&&"object"==typeof a&&"type"in a&&"file"===a.type}maybeEncodeFileParts(a){for(let b of a.prompt)for(let a of b.content)if(this.isFilePart(a)&&a.data instanceof Uint8Array){let b=Uint8Array.from(a.data),c=Buffer.from(b).toString("base64");a.data=new URL(`data:${a.mediaType||"application/octet-stream"};base64,${c}`)}return a}getUrl(){return`${this.config.baseURL}/language-model`}getModelConfigHeaders(a,b){return{"ai-language-model-specification-version":"2","ai-language-model-id":a,"ai-language-model-streaming":String(b)}}},h_=class{constructor(a,b){this.modelId=a,this.config=b,this.specificationVersion="v2",this.maxEmbeddingsPerCall=2048,this.supportsParallelCalls=!0}get provider(){return this.config.provider}async doEmbed({values:a,headers:b,abortSignal:c,providerOptions:d}){var e;let f=await hj(this.config.headers());try{let{responseHeaders:g,value:h,rawValue:i}=await hh({url:this.getUrl(),headers:gW(f,null!=b?b:{},this.getModelConfigHeaders(),await hj(this.config.o11yHeaders)),body:{input:1===a.length?a[0]:a,...null!=d?d:{}},successfulResponseHandler:hl(h0),failedResponseHandler:hk({errorSchema:fW(),errorToMessage:a=>a}),...c&&{abortSignal:c},fetch:this.config.fetch});return{embeddings:h.embeddings,usage:null!=(e=h.usage)?e:void 0,providerMetadata:h.providerMetadata,response:{headers:g,body:i}}}catch(a){throw hR(a,hT(f))}}getUrl(){return`${this.config.baseURL}/embedding-model`}getModelConfigHeaders(){return{"ai-embedding-model-specification-version":"2","ai-model-id":this.modelId}}},h0=f2({embeddings:f0(f0(fP())),usage:f2({tokens:fP()}).nullish(),providerMetadata:ga(ft(),ga(ft(),fY())).optional()});async function h1(){var a,b;let c=null!=(b=null==(a=h4().headers)?void 0:a["x-vercel-oidc-token"])?b:process.env.VERCEL_OIDC_TOKEN;if(!c)throw new hy({message:"OIDC token not available",statusCode:401});return c}async function h2(){var a;return null==(a=h4().headers)?void 0:a["x-vercel-id"]}var h3=Symbol.for("@vercel/request-context");function h4(){var a,b,c;return null!=(c=null==(b=null==(a=globalThis[h3])?void 0:a.get)?void 0:b.call(a))?c:{}}var h5=function(a={}){var b,c,d;let e=null,f=null,g=null!=(b=a.metadataCacheRefreshMillis)?b:3e5,h=0,i=null!=(c=null==(d=a.baseURL)?void 0:d.replace(/\/$/,""))?c:"https://ai-gateway.vercel.sh/v1/ai",j=async()=>{let b=await h6(a);if(b)return{Authorization:`Bearer ${b.token}`,"ai-gateway-protocol-version":"0.0.1",[hS]:b.authMethod,...a.headers};throw hy.createContextualError({apiKeyProvided:!1,oidcTokenProvided:!1,statusCode:401})},k=()=>{let a=g7({settingValue:void 0,environmentVariableName:"VERCEL_DEPLOYMENT_ID"}),b=g7({settingValue:void 0,environmentVariableName:"VERCEL_ENV"}),c=g7({settingValue:void 0,environmentVariableName:"VERCEL_REGION"});return async()=>{let d=await h2();return{...a&&{"ai-o11y-deployment-id":a},...b&&{"ai-o11y-environment":b},...c&&{"ai-o11y-region":c},...d&&{"ai-o11y-request-id":d}}}},l=b=>new h$(b,{provider:"gateway",baseURL:i,headers:j,fetch:a.fetch,o11yHeaders:k()}),m=function(a){if(new.target)throw Error("The Gateway Provider model function cannot be called with the new keyword.");return l(a)};return m.getAvailableModels=async()=>{var b,c,d;let k=null!=(d=null==(c=null==(b=a._internal)?void 0:b.currentDate)?void 0:c.call(b).getTime())?d:Date.now();return(!e||k-h>g)&&(h=k,e=new hV({baseURL:i,headers:j,fetch:a.fetch}).getAvailableModels().then(a=>(f=a,a)).catch(async a=>{throw hR(a,hT(await j()))})),f?Promise.resolve(f):e},m.imageModel=a=>{throw new aO({modelId:a,modelType:"imageModel"})},m.languageModel=l,m.textEmbeddingModel=b=>new h_(b,{provider:"gateway",baseURL:i,headers:j,fetch:a.fetch,o11yHeaders:k()}),m}();async function h6(a){let b=g7({settingValue:a.apiKey,environmentVariableName:"AI_GATEWAY_API_KEY"});if(b)return{token:b,authMethod:"api-key"};try{return{token:await h1(),authMethod:"oidc"}}catch(a){return null}}var h7=c(76895),h8=c(89131),h9=Object.defineProperty,ia="AI_NoOutputSpecifiedError",ib=`vercel.ai.error.${ia}`,ic=Symbol.for(ib),id=class extends al{constructor({message:a="No output specified."}={}){super({name:ia,message:a}),this[I]=!0}static isInstance(a){return al.hasMarker(a,ib)}};I=ic;var ie="AI_InvalidArgumentError",ig=`vercel.ai.error.${ie}`,ih=Symbol.for(ig),ii=class extends al{constructor({parameter:a,value:b,message:c}){super({name:ie,message:`Invalid argument for parameter ${a}: ${c}`}),this[J]=!0,this.parameter=a,this.value=b}static isInstance(a){return al.hasMarker(a,ig)}};J=ih,Symbol.for("vercel.ai.error.AI_InvalidStreamPartError");var ij="AI_InvalidToolInputError",ik=`vercel.ai.error.${ij}`,il=Symbol.for(ik),im=class extends al{constructor({toolInput:a,toolName:b,cause:c,message:d=`Invalid input for tool ${b}: ${au(c)}`}){super({name:ij,message:d,cause:c}),this[K]=!0,this.toolInput=a,this.toolName=b}static isInstance(a){return al.hasMarker(a,ik)}};K=il,Symbol.for("vercel.ai.error.AI_MCPClientError"),Symbol.for("vercel.ai.error.AI_NoImageGeneratedError");var io="AI_NoObjectGeneratedError",ip=`vercel.ai.error.${io}`,iq=Symbol.for(ip),ir=class extends al{constructor({message:a="No object generated.",cause:b,text:c,response:d,usage:e,finishReason:f}){super({name:io,message:a,cause:b}),this[L]=!0,this.text=c,this.response=d,this.usage=e,this.finishReason=f}static isInstance(a){return al.hasMarker(a,ip)}};L=iq;var is="AI_NoOutputGeneratedError",it=`vercel.ai.error.${is}`,iu=Symbol.for(it),iv=class extends al{constructor({message:a="No output generated.",cause:b}={}){super({name:is,message:a,cause:b}),this[M]=!0}static isInstance(a){return al.hasMarker(a,it)}};M=iu;var iw="AI_NoSuchToolError",ix=`vercel.ai.error.${iw}`,iy=Symbol.for(ix),iz=class extends al{constructor({toolName:a,availableTools:b,message:c=`Model tried to call unavailable tool '${a}'. ${void 0===b?"No tools are available.":`Available tools: ${b.join(", ")}.`}`}){super({name:iw,message:c}),this[N]=!0,this.toolName=a,this.availableTools=b}static isInstance(a){return al.hasMarker(a,ix)}};N=iy;var iA="AI_ToolCallRepairError",iB=`vercel.ai.error.${iA}`,iC=Symbol.for(iB),iD=class extends al{constructor({cause:a,originalError:b,message:c=`Error repairing tool call: ${au(a)}`}){super({name:iA,message:c,cause:a}),this[O]=!0,this.originalError=b}static isInstance(a){return al.hasMarker(a,iB)}};O=iC;var iE=class extends al{constructor(a){super({name:"AI_UnsupportedModelVersionError",message:`Unsupported model version ${a.version} for provider "${a.provider}" and model "${a.modelId}". AI SDK 5 only supports models that implement specification version "v2".`}),this.version=a.version,this.provider=a.provider,this.modelId=a.modelId}},iF=(Symbol.for("vercel.ai.error.AI_InvalidDataContentError"),"AI_InvalidMessageRoleError"),iG=`vercel.ai.error.${iF}`,iH=Symbol.for(iG),iI=class extends al{constructor({role:a,message:b=`Invalid message role: '${a}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:iF,message:b}),this[P]=!0,this.role=a}static isInstance(a){return al.hasMarker(a,iG)}};P=iH;var iJ="AI_MessageConversionError",iK=`vercel.ai.error.${iJ}`,iL=Symbol.for(iK),iM=class extends al{constructor({originalMessage:a,message:b}){super({name:iJ,message:b}),this[Q]=!0,this.originalMessage=a}static isInstance(a){return al.hasMarker(a,iK)}};Q=iL;var iN="AI_DownloadError",iO=`vercel.ai.error.${iN}`,iP=Symbol.for(iO),iQ=class extends al{constructor({url:a,statusCode:b,statusText:c,cause:d,message:e=null==d?`Failed to download ${a}: ${b} ${c}`:`Failed to download ${a}: ${d}`}){super({name:iN,message:e,cause:d}),this[R]=!0,this.url=a,this.statusCode=b,this.statusText=c}static isInstance(a){return al.hasMarker(a,iO)}};R=iP;var iR="AI_RetryError",iS=`vercel.ai.error.${iR}`,iT=Symbol.for(iS),iU=class extends al{constructor({message:a,reason:b,errors:c}){super({name:iR,message:a}),this[S]=!0,this.reason=b,this.errors=c,this.lastError=c[c.length-1]}static isInstance(a){return al.hasMarker(a,iS)}};function iV(a){var b;if("string"!=typeof a){if("v2"!==a.specificationVersion)throw new iE({version:a.specificationVersion,provider:a.provider,modelId:a.modelId});return a}return(null!=(b=globalThis.AI_SDK_DEFAULT_PROVIDER)?b:h5).languageModel(a)}S=iT;var iW=[{mediaType:"image/gif",bytesPrefix:[71,73,70],base64Prefix:"R0lG"},{mediaType:"image/png",bytesPrefix:[137,80,78,71],base64Prefix:"iVBORw"},{mediaType:"image/jpeg",bytesPrefix:[255,216],base64Prefix:"/9j/"},{mediaType:"image/webp",bytesPrefix:[82,73,70,70],base64Prefix:"UklGRg"},{mediaType:"image/bmp",bytesPrefix:[66,77],base64Prefix:"Qk"},{mediaType:"image/tiff",bytesPrefix:[73,73,42,0],base64Prefix:"SUkqAA"},{mediaType:"image/tiff",bytesPrefix:[77,77,0,42],base64Prefix:"TU0AKg"},{mediaType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102],base64Prefix:"AAAAIGZ0eXBhdmlm"},{mediaType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99],base64Prefix:"AAAAIGZ0eXBoZWlj"}];async function iX({url:a}){var b;let c=a.toString();try{let a=await fetch(c);if(!a.ok)throw new iQ({url:c,statusCode:a.status,statusText:a.statusText});return{data:new Uint8Array(await a.arrayBuffer()),mediaType:null!=(b=a.headers.get("content-type"))?b:void 0}}catch(a){if(iQ.isInstance(a))throw a;throw new iQ({url:c,cause:a})}}var iY=f6([ft(),gt(Uint8Array),gt(ArrayBuffer),function(a,b){let c=dy(b);return c.abort??(c.abort=!0),new gs({type:"custom",check:"custom",fn:a??(()=>!0),...c})}(a=>{var b,c;return null!=(c=null==(b=globalThis.Buffer)?void 0:b.isBuffer(a))&&c},{message:"Must be a Buffer"})]);function iZ(a){if(a instanceof Uint8Array)return{data:a,mediaType:void 0};if(a instanceof ArrayBuffer)return{data:new Uint8Array(a),mediaType:void 0};if("string"==typeof a)try{a=new URL(a)}catch(a){}if(a instanceof URL&&"data:"===a.protocol){let{mediaType:b,base64Content:c}=function(a){try{let[b,c]=a.split(",");return{mediaType:b.split(";")[0].split(":")[1],base64Content:c}}catch(a){return{mediaType:void 0,base64Content:void 0}}}(a.toString());if(null==b||null==c)throw new al({name:"InvalidDataContentError",message:`Invalid data URL format in content ${a.toString()}`});return{data:c,mediaType:b}}return{data:a,mediaType:void 0}}async function i$({prompt:a,supportedUrls:b,downloadImplementation:c=iX}){let d=await i_(a.messages,c,b);return[...null!=a.system?[{role:"system",content:a.system}]:[],...a.messages.map(a=>(function({message:a,downloadedAssets:b}){let c=a.role;switch(c){case"system":return{role:"system",content:a.content,providerOptions:a.providerOptions};case"user":if("string"==typeof a.content)return{role:"user",content:[{type:"text",text:a.content}],providerOptions:a.providerOptions};return{role:"user",content:a.content.map(a=>(function(a,b){var c;let d;if("text"===a.type)return{type:"text",text:a.text,providerOptions:a.providerOptions};let e=a.type;switch(e){case"image":d=a.image;break;case"file":d=a.data;break;default:throw Error(`Unsupported part type: ${e}`)}let{data:f,mediaType:g}=iZ(d),h=null!=g?g:a.mediaType,i=f;if(i instanceof URL){let a=b[i.toString()];a&&(i=a.data,null!=h||(h=a.mediaType))}switch(e){case"image":return(i instanceof Uint8Array||"string"==typeof i)&&(h=null!=(c=function({data:a,signatures:b}){let c="string"==typeof a&&a.startsWith("SUQz")||"string"!=typeof a&&a.length>10&&73===a[0]&&68===a[1]&&51===a[2]?(a=>{let b="string"==typeof a?hr(a):a,c=(127&b[6])<<21|(127&b[7])<<14|(127&b[8])<<7|127&b[9];return b.slice(c+10)})(a):a;for(let a of b)if("string"==typeof c?c.startsWith(a.base64Prefix):c.length>=a.bytesPrefix.length&&a.bytesPrefix.every((a,b)=>c[b]===a))return a.mediaType}({data:i,signatures:iW}))?c:h),{type:"file",mediaType:null!=h?h:"image/*",filename:void 0,data:i,providerOptions:a.providerOptions};case"file":if(null==h)throw Error("Media type is missing for file part");return{type:"file",mediaType:h,filename:a.filename,data:i,providerOptions:a.providerOptions}}})(a,b)).filter(a=>"text"!==a.type||""!==a.text),providerOptions:a.providerOptions};case"assistant":if("string"==typeof a.content)return{role:"assistant",content:[{type:"text",text:a.content}],providerOptions:a.providerOptions};return{role:"assistant",content:a.content.filter(a=>"text"!==a.type||""!==a.text).map(a=>{let b=a.providerOptions;switch(a.type){case"file":{let{data:c,mediaType:d}=iZ(a.data);return{type:"file",data:c,filename:a.filename,mediaType:null!=d?d:a.mediaType,providerOptions:b}}case"reasoning":return{type:"reasoning",text:a.text,providerOptions:b};case"text":return{type:"text",text:a.text,providerOptions:b};case"tool-call":return{type:"tool-call",toolCallId:a.toolCallId,toolName:a.toolName,input:a.input,providerExecuted:a.providerExecuted,providerOptions:b};case"tool-result":return{type:"tool-result",toolCallId:a.toolCallId,toolName:a.toolName,output:a.output,providerOptions:b}}}),providerOptions:a.providerOptions};case"tool":return{role:"tool",content:a.content.map(a=>({type:"tool-result",toolCallId:a.toolCallId,toolName:a.toolName,output:a.output,providerOptions:a.providerOptions})),providerOptions:a.providerOptions};default:throw new iI({role:c})}})({message:a,downloadedAssets:d}))]}async function i_(a,b,c){let d=a.filter(a=>"user"===a.role).map(a=>a.content).filter(a=>Array.isArray(a)).flat().filter(a=>"image"===a.type||"file"===a.type).map(a=>{var b;let c=null!=(b=a.mediaType)?b:"image"===a.type?"image/*":void 0,d="image"===a.type?a.image:a.data;if("string"==typeof d)try{d=new URL(d)}catch(a){}return{mediaType:c,data:d}}).filter(a=>a.data instanceof URL&&null!=a.mediaType&&!function({mediaType:a,url:b,supportedUrls:c}){return b=b.toLowerCase(),a=a.toLowerCase(),Object.entries(c).map(([a,b])=>{let c=a.toLowerCase();return"*"===c||"*/*"===c?{mediaTypePrefix:"",regexes:b}:{mediaTypePrefix:c.replace(/\*/,""),regexes:b}}).filter(({mediaTypePrefix:b})=>a.startsWith(b)).flatMap(({regexes:a})=>a).some(a=>a.test(b))}({url:a.data.toString(),mediaType:a.mediaType,supportedUrls:c})).map(a=>a.data);return Object.fromEntries((await Promise.all(d.map(async a=>({url:a,data:await b({url:a})})))).map(({url:a,data:b})=>[a.toString(),b]))}var i0=new gr({type:"lazy",getter:()=>f6([new fU({type:"null",...dy(void 0)}),ft(),fP(),fT(),ga(ft(),i0),f0(i0)])}),i1=ga(ft(),ga(ft(),i0)),i2=f2({type:ge("text"),text:ft(),providerOptions:i1.optional()}),i3=f2({type:ge("image"),image:f6([iY,gt(URL)]),mediaType:ft().optional(),providerOptions:i1.optional()}),i4=f2({type:ge("file"),data:f6([iY,gt(URL)]),filename:ft().optional(),mediaType:ft(),providerOptions:i1.optional()}),i5=f2({type:ge("reasoning"),text:ft(),providerOptions:i1.optional()}),i6=f2({type:ge("tool-call"),toolCallId:ft(),toolName:ft(),input:fY(),providerOptions:i1.optional(),providerExecuted:fT().optional()}),i7=new f7({type:"union",options:[f2({type:ge("text"),value:ft()}),f2({type:ge("json"),value:i0}),f2({type:ge("error-text"),value:ft()}),f2({type:ge("error-json"),value:i0}),f2({type:ge("content"),value:f0(f6([f2({type:ge("text"),text:ft()}),f2({type:ge("media"),data:ft(),mediaType:ft()})]))})],discriminator:"type",...dy(void 0)}),i8=f2({type:ge("tool-result"),toolCallId:ft(),toolName:ft(),output:i7,providerOptions:i1.optional()}),i9=f2({role:ge("system"),content:ft(),providerOptions:i1.optional()}),ja=f2({role:ge("user"),content:f6([ft(),f0(f6([i2,i3,i4]))]),providerOptions:i1.optional()}),jb=f2({role:ge("assistant"),content:f6([ft(),f0(f6([i2,i4,i5,i6,i8]))]),providerOptions:i1.optional()}),jc=f6([i9,ja,jb,f2({role:ge("tool"),content:f0(i8),providerOptions:i1.optional()})]);async function jd(a){let b;if(null==a.prompt&&null==a.messages)throw new aC({prompt:a,message:"prompt or messages must be defined"});if(null!=a.prompt&&null!=a.messages)throw new aC({prompt:a,message:"prompt and messages cannot be defined at the same time"});if(null!=a.system&&"string"!=typeof a.system)throw new aC({prompt:a,message:"system must be a string"});if(null!=a.prompt&&"string"==typeof a.prompt)b=[{role:"user",content:a.prompt}];else if(null!=a.prompt&&Array.isArray(a.prompt))b=a.prompt;else if(null!=a.messages)b=a.messages;else throw new aC({prompt:a,message:"prompt or messages must be defined"});if(0===b.length)throw new aC({prompt:a,message:"messages must not be empty"});let c=await hd({value:b,schema:f0(jc)});if(!c.success)throw new aC({prompt:a,message:"The messages must be a ModelMessage[]. If you have passed a UIMessage[], you can use convertToModelMessages to convert them.",cause:c.error});return{messages:b,system:a.system}}function je({operationId:a,telemetry:b}){return{"operation.name":`${a}${(null==b?void 0:b.functionId)!=null?` ${b.functionId}`:""}`,"resource.name":null==b?void 0:b.functionId,"ai.operationId":a,"ai.telemetry.functionId":null==b?void 0:b.functionId}}var jf={startSpan:()=>jg,startActiveSpan:(a,b,c,d)=>"function"==typeof b?b(jg):"function"==typeof c?c(jg):"function"==typeof d?d(jg):void 0},jg={spanContext:()=>jh,setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording:()=>!1,recordException(){return this}},jh={traceId:"",spanId:"",traceFlags:0};function ji({name:a,tracer:b,attributes:c,fn:d,endWhenDone:e=!0}){return b.startActiveSpan(a,{attributes:c},async a=>{try{let b=await d(a);return e&&a.end(),b}catch(b){try{jj(a,b)}finally{a.end()}throw b}})}function jj(a,b){b instanceof Error?(a.recordException({name:b.name,message:b.message,stack:b.stack}),a.setStatus({code:h8.s.ERROR,message:b.message})):a.setStatus({code:h8.s.ERROR})}function jk({telemetry:a,attributes:b}){return(null==a?void 0:a.isEnabled)!==!0?{}:Object.entries(b).reduce((b,[c,d])=>{if(null==d)return b;if("object"==typeof d&&"input"in d&&"function"==typeof d.input){if((null==a?void 0:a.recordInputs)===!1)return b;let e=d.input();return null==e?b:{...b,[c]:e}}if("object"==typeof d&&"output"in d&&"function"==typeof d.output){if((null==a?void 0:a.recordOutputs)===!1)return b;let e=d.output();return null==e?b:{...b,[c]:e}}return{...b,[c]:d}},{})}function jl(a,b){return null==a&&null==b?void 0:(null!=a?a:0)+(null!=b?b:0)}function jm(a){return void 0===a?[]:Array.isArray(a)?a:[a]}async function jn(a,{maxRetries:b,delayInMs:c,backoffFactor:d,abortSignal:e},f=[]){try{return await a()}catch(j){if(g1(j)||0===b)throw j;let g=g0(j),h=[...f,j],i=h.length;if(i>b)throw new iU({message:`Failed after ${i} attempts. Last error: ${g}`,reason:"maxRetriesExceeded",errors:h});if(j instanceof Error&&ap.isInstance(j)&&!0===j.isRetryable&&i<=b)return await gX(function({error:a,exponentialBackoffDelay:b}){let c,d=a.responseHeaders;if(!d)return b;let e=d["retry-after-ms"];if(e){let a=parseFloat(e);Number.isNaN(a)||(c=a)}let f=d["retry-after"];if(f&&void 0===c){let a=parseFloat(f);c=Number.isNaN(a)?Date.parse(f)-Date.now():1e3*a}return null!=c&&!Number.isNaN(c)&&0<=c&&(c<6e4||c<b)?c:b}({error:j,exponentialBackoffDelay:c}),{abortSignal:e}),jn(a,{maxRetries:b,delayInMs:d*c,backoffFactor:d,abortSignal:e},h);if(1===i)throw j;throw new iU({message:`Failed after ${i} attempts with non-retryable error: '${g}'`,reason:"errorNotRetryable",errors:h})}}var jo=class{constructor({data:a,mediaType:b}){let c=a instanceof Uint8Array;this.base64Data=c?void 0:a,this.uint8ArrayData=c?a:void 0,this.mediaType=b}get base64(){return null==this.base64Data&&(this.base64Data=hs(this.uint8ArrayData)),this.base64Data}get uint8Array(){return null==this.uint8ArrayData&&(this.uint8ArrayData=hr(this.base64Data)),this.uint8ArrayData}},jp=class extends jo{constructor(a){super(a),this.type="file"}};async function jq({toolCall:a,tools:b,repairToolCall:c,system:d,messages:e}){try{if(null==b)throw new iz({toolName:a.toolName});try{return await jr({toolCall:a,tools:b})}catch(g){if(null==c||!(iz.isInstance(g)||im.isInstance(g)))throw g;let f=null;try{f=await c({toolCall:a,tools:b,inputSchema:({toolName:a})=>{let{inputSchema:c}=b[a];return ho(c).jsonSchema},system:d,messages:e,error:g})}catch(a){throw new iD({cause:a,originalError:g})}if(null==f)throw g;return await jr({toolCall:f,tools:b})}}catch(b){return{type:"tool-call",toolCallId:a.toolCallId,toolName:a.toolName,input:a.input,dynamic:!0,invalid:!0,error:b}}}async function jr({toolCall:a,tools:b}){let c=a.toolName,d=b[c];if(null==d)throw new iz({toolName:a.toolName,availableTools:Object.keys(b)});let e=ho(d.inputSchema),f=""===a.input.trim()?await hd({value:{},schema:e}):await hf({text:a.input,schema:e});if(!1===f.success)throw new im({toolName:c,toolInput:a.input,cause:f.error});return"dynamic"===d.type?{type:"tool-call",toolCallId:a.toolCallId,toolName:a.toolName,input:f.value,providerExecuted:a.providerExecuted,providerMetadata:a.providerMetadata,dynamic:!0}:{type:"tool-call",toolCallId:a.toolCallId,toolName:c,input:f.value,providerExecuted:a.providerExecuted,providerMetadata:a.providerMetadata}}var js=class{constructor({content:a,finishReason:b,usage:c,warnings:d,request:e,response:f,providerMetadata:g}){this.content=a,this.finishReason=b,this.usage=c,this.warnings=d,this.request=e,this.response=f,this.providerMetadata=g}get text(){return this.content.filter(a=>"text"===a.type).map(a=>a.text).join("")}get reasoning(){return this.content.filter(a=>"reasoning"===a.type)}get reasoningText(){return 0===this.reasoning.length?void 0:this.reasoning.map(a=>a.text).join("")}get files(){return this.content.filter(a=>"file"===a.type).map(a=>a.file)}get sources(){return this.content.filter(a=>"source"===a.type)}get toolCalls(){return this.content.filter(a=>"tool-call"===a.type)}get staticToolCalls(){return this.toolCalls.filter(a=>!1===a.dynamic)}get dynamicToolCalls(){return this.toolCalls.filter(a=>!0===a.dynamic)}get toolResults(){return this.content.filter(a=>"tool-result"===a.type)}get staticToolResults(){return this.toolResults.filter(a=>!1===a.dynamic)}get dynamicToolResults(){return this.toolResults.filter(a=>!0===a.dynamic)}};async function jt({stopConditions:a,steps:b}){return(await Promise.all(a.map(a=>a({steps:b})))).some(a=>a)}function ju({output:a,tool:b,errorMode:c}){return"text"===c?{type:"error-text",value:au(a)}:"json"===c?{type:"error-json",value:jv(a)}:(null==b?void 0:b.toModelOutput)?b.toModelOutput(a):"string"==typeof a?{type:"text",value:a}:{type:"json",value:jv(a)}}function jv(a){return void 0===a?null:a}function jw({content:a,tools:b}){let c=[],d=a.filter(a=>"source"!==a.type).filter(a=>("tool-result"!==a.type||a.providerExecuted)&&("tool-error"!==a.type||a.providerExecuted)).filter(a=>"text"!==a.type||a.text.length>0).map(a=>{switch(a.type){case"text":return{type:"text",text:a.text,providerOptions:a.providerMetadata};case"reasoning":return{type:"reasoning",text:a.text,providerOptions:a.providerMetadata};case"file":return{type:"file",data:a.file.base64,mediaType:a.file.mediaType,providerOptions:a.providerMetadata};case"tool-call":return{type:"tool-call",toolCallId:a.toolCallId,toolName:a.toolName,input:a.input,providerExecuted:a.providerExecuted,providerOptions:a.providerMetadata};case"tool-result":return{type:"tool-result",toolCallId:a.toolCallId,toolName:a.toolName,output:ju({tool:null==b?void 0:b[a.toolName],output:a.output,errorMode:"none"}),providerExecuted:!0,providerOptions:a.providerMetadata};case"tool-error":return{type:"tool-result",toolCallId:a.toolCallId,toolName:a.toolName,output:ju({tool:null==b?void 0:b[a.toolName],output:a.error,errorMode:"json"}),providerOptions:a.providerMetadata}}});d.length>0&&c.push({role:"assistant",content:d});let e=a.filter(a=>"tool-result"===a.type||"tool-error"===a.type).filter(a=>!a.providerExecuted).map(a=>({type:"tool-result",toolCallId:a.toolCallId,toolName:a.toolName,output:ju({tool:null==b?void 0:b[a.toolName],output:"tool-result"===a.type?a.output:a.error,errorMode:"tool-error"===a.type?"text":"none"})}));return e.length>0&&c.push({role:"tool",content:e}),c}function jx(a,b){let c=new Headers(null!=a?a:{});for(let[a,d]of Object.entries(b))c.has(a)||c.set(a,d);return c}function jy({response:a,status:b,statusText:c,headers:d,stream:e}){a.writeHead(null!=b?b:200,c,d);let f=e.getReader();(async()=>{try{for(;;){let{done:b,value:c}=await f.read();if(b)break;a.write(c)}}catch(a){throw a}finally{a.end()}})()}g$({prefix:"aitxt",size:24});var jz=class extends TransformStream{constructor(){super({transform(a,b){b.enqueue(`data: ${JSON.stringify(a)}

`)},flush(a){a.enqueue("data: [DONE]\n\n")}})}},jA={"content-type":"text/event-stream","cache-control":"no-cache",connection:"keep-alive","x-vercel-ai-ui-message-stream":"v1","x-accel-buffering":"no"};async function jB(a){if(void 0===a)return{value:void 0,state:"undefined-input"};let b=await hf({text:a});return b.success?{value:b.value,state:"successful-parse"}:(b=await hf({text:function(a){let b=["ROOT"],c=-1,d=null;function e(a,e,f){switch(a){case'"':c=e,b.pop(),b.push(f),b.push("INSIDE_STRING");break;case"f":case"t":case"n":c=e,d=e,b.pop(),b.push(f),b.push("INSIDE_LITERAL");break;case"-":b.pop(),b.push(f),b.push("INSIDE_NUMBER");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":c=e,b.pop(),b.push(f),b.push("INSIDE_NUMBER");break;case"{":c=e,b.pop(),b.push(f),b.push("INSIDE_OBJECT_START");break;case"[":c=e,b.pop(),b.push(f),b.push("INSIDE_ARRAY_START")}}function f(a,d){switch(a){case",":b.pop(),b.push("INSIDE_OBJECT_AFTER_COMMA");break;case"}":c=d,b.pop()}}function g(a,d){switch(a){case",":b.pop(),b.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":c=d,b.pop()}}for(let h=0;h<a.length;h++){let i=a[h];switch(b[b.length-1]){case"ROOT":e(i,h,"FINISH");break;case"INSIDE_OBJECT_START":switch(i){case'"':b.pop(),b.push("INSIDE_OBJECT_KEY");break;case"}":c=h,b.pop()}break;case"INSIDE_OBJECT_AFTER_COMMA":'"'===i&&(b.pop(),b.push("INSIDE_OBJECT_KEY"));break;case"INSIDE_OBJECT_KEY":'"'===i&&(b.pop(),b.push("INSIDE_OBJECT_AFTER_KEY"));break;case"INSIDE_OBJECT_AFTER_KEY":":"===i&&(b.pop(),b.push("INSIDE_OBJECT_BEFORE_VALUE"));break;case"INSIDE_OBJECT_BEFORE_VALUE":e(i,h,"INSIDE_OBJECT_AFTER_VALUE");break;case"INSIDE_OBJECT_AFTER_VALUE":f(i,h);break;case"INSIDE_STRING":switch(i){case'"':b.pop(),c=h;break;case"\\":b.push("INSIDE_STRING_ESCAPE");break;default:c=h}break;case"INSIDE_ARRAY_START":"]"===i?(c=h,b.pop()):(c=h,e(i,h,"INSIDE_ARRAY_AFTER_VALUE"));break;case"INSIDE_ARRAY_AFTER_VALUE":switch(i){case",":b.pop(),b.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":c=h,b.pop();break;default:c=h}break;case"INSIDE_ARRAY_AFTER_COMMA":e(i,h,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_STRING_ESCAPE":b.pop(),c=h;break;case"INSIDE_NUMBER":switch(i){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":c=h;break;case"e":case"E":case"-":case".":break;case",":b.pop(),"INSIDE_ARRAY_AFTER_VALUE"===b[b.length-1]&&g(i,h),"INSIDE_OBJECT_AFTER_VALUE"===b[b.length-1]&&f(i,h);break;case"}":b.pop(),"INSIDE_OBJECT_AFTER_VALUE"===b[b.length-1]&&f(i,h);break;case"]":b.pop(),"INSIDE_ARRAY_AFTER_VALUE"===b[b.length-1]&&g(i,h);break;default:b.pop()}break;case"INSIDE_LITERAL":{let e=a.substring(d,h+1);"false".startsWith(e)||"true".startsWith(e)||"null".startsWith(e)?c=h:(b.pop(),"INSIDE_OBJECT_AFTER_VALUE"===b[b.length-1]?f(i,h):"INSIDE_ARRAY_AFTER_VALUE"===b[b.length-1]&&g(i,h))}}}let h=a.slice(0,c+1);for(let c=b.length-1;c>=0;c--)switch(b[c]){case"INSIDE_STRING":h+='"';break;case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":h+="}";break;case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":h+="]";break;case"INSIDE_LITERAL":{let b=a.substring(d,a.length);"true".startsWith(b)?h+="true".slice(b.length):"false".startsWith(b)?h+="false".slice(b.length):"null".startsWith(b)&&(h+="null".slice(b.length))}}return h}(a)})).success?{value:b.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"}}function jC(a){return a.type.startsWith("tool-")}function jD(a){return a.type.split("-").slice(1).join("-")}function jE(a){let b=a.pipeThrough(new TransformStream);return b[Symbol.asyncIterator]=()=>{let a=b.getReader();return{async next(){let{done:b,value:c}=await a.read();return b?{done:!0,value:void 0}:{done:!1,value:c}}}},b}async function jF({stream:a,onError:b}){let c=a.getReader();try{for(;;){let{done:a}=await c.read();if(a)break}}catch(a){null==b||b(a)}finally{c.releaseLock()}}function jG(){let a,b;return{promise:new Promise((c,d)=>{a=c,b=d}),resolve:a,reject:b}}f6([f3({type:ge("text-start"),id:ft(),providerMetadata:i1.optional()}),f3({type:ge("text-delta"),id:ft(),delta:ft(),providerMetadata:i1.optional()}),f3({type:ge("text-end"),id:ft(),providerMetadata:i1.optional()}),f3({type:ge("error"),errorText:ft()}),f3({type:ge("tool-input-start"),toolCallId:ft(),toolName:ft(),providerExecuted:fT().optional(),dynamic:fT().optional()}),f3({type:ge("tool-input-delta"),toolCallId:ft(),inputTextDelta:ft()}),f3({type:ge("tool-input-available"),toolCallId:ft(),toolName:ft(),input:fY(),providerExecuted:fT().optional(),providerMetadata:i1.optional(),dynamic:fT().optional()}),f3({type:ge("tool-input-error"),toolCallId:ft(),toolName:ft(),input:fY(),providerExecuted:fT().optional(),providerMetadata:i1.optional(),dynamic:fT().optional(),errorText:ft()}),f3({type:ge("tool-output-available"),toolCallId:ft(),output:fY(),providerExecuted:fT().optional(),dynamic:fT().optional(),preliminary:fT().optional()}),f3({type:ge("tool-output-error"),toolCallId:ft(),errorText:ft(),providerExecuted:fT().optional(),dynamic:fT().optional()}),f3({type:ge("reasoning"),text:ft(),providerMetadata:i1.optional()}),f3({type:ge("reasoning-start"),id:ft(),providerMetadata:i1.optional()}),f3({type:ge("reasoning-delta"),id:ft(),delta:ft(),providerMetadata:i1.optional()}),f3({type:ge("reasoning-end"),id:ft(),providerMetadata:i1.optional()}),f3({type:ge("reasoning-part-finish")}),f3({type:ge("source-url"),sourceId:ft(),url:ft(),title:ft().optional(),providerMetadata:i1.optional()}),f3({type:ge("source-document"),sourceId:ft(),mediaType:ft(),title:ft(),filename:ft().optional(),providerMetadata:i1.optional()}),f3({type:ge("file"),url:ft(),mediaType:ft(),providerMetadata:i1.optional()}),f3({type:ft().startsWith("data-"),id:ft().optional(),data:fY(),transient:fT().optional()}),f3({type:ge("start-step")}),f3({type:ge("finish-step")}),f3({type:ge("start"),messageId:ft().optional(),messageMetadata:fY().optional()}),f3({type:ge("finish"),messageMetadata:fY().optional()}),f3({type:ge("abort")}),f3({type:ge("message-metadata"),messageMetadata:fY()})]);var jH=class{constructor(){this.status={type:"pending"},this._resolve=void 0,this._reject=void 0}get promise(){return this._promise||(this._promise=new Promise((a,b)=>{"resolved"===this.status.type?a(this.status.value):"rejected"===this.status.type&&b(this.status.error),this._resolve=a,this._reject=b})),this._promise}resolve(a){var b;this.status={type:"resolved",value:a},this._promise&&(null==(b=this._resolve)||b.call(this,a))}reject(a){var b;this.status={type:"rejected",error:a},this._promise&&(null==(b=this._reject)||b.call(this,a))}},jI=g$({prefix:"aitxt",size:24}),jJ=class{constructor({model:a,telemetry:b,headers:c,settings:d,maxRetries:e,abortSignal:f,system:g,prompt:h,messages:i,tools:j,toolChoice:k,transforms:l,activeTools:m,repairToolCall:n,stopConditions:o,output:p,providerOptions:q,prepareStep:r,includeRawChunks:s,now:t,currentDate:u,generateId:v,onChunk:w,onError:x,onFinish:y,onAbort:z,onStepFinish:A,experimental_context:B}){let C,D,E,F;this._totalUsage=new jH,this._finishReason=new jH,this._steps=new jH,this.output=p,this.includeRawChunks=s,this.tools=j;let G=[],H=[],I={},J=[],K=[],L={},M={},N=new TransformStream({async transform(a,b){var c,d,e,f;b.enqueue(a);let{part:g}=a;if(("text-delta"===g.type||"reasoning-delta"===g.type||"source"===g.type||"tool-call"===g.type||"tool-result"===g.type||"tool-input-start"===g.type||"tool-input-delta"===g.type||"raw"===g.type)&&await (null==w?void 0:w({chunk:g})),"error"===g.type&&await x({error:(f=g.error,hy.isInstance(f)||hI.isInstance(f)?new al({name:"GatewayError",message:"Vercel AI Gateway access failed. If you want to use AI SDK providers directly, use the providers, e.g. @ai-sdk/openai, or register a different global default provider.",cause:f}):f)}),"text-start"===g.type&&(L[g.id]={type:"text",text:"",providerMetadata:g.providerMetadata},G.push(L[g.id])),"text-delta"===g.type){let a=L[g.id];if(null==a)return void b.enqueue({part:{type:"error",error:`text part ${g.id} not found`},partialOutput:void 0});a.text+=g.text,a.providerMetadata=null!=(c=g.providerMetadata)?c:a.providerMetadata}if("text-end"===g.type&&delete L[g.id],"reasoning-start"===g.type&&(M[g.id]={type:"reasoning",text:"",providerMetadata:g.providerMetadata},G.push(M[g.id])),"reasoning-delta"===g.type){let a=M[g.id];if(null==a)return void b.enqueue({part:{type:"error",error:`reasoning part ${g.id} not found`},partialOutput:void 0});a.text+=g.text,a.providerMetadata=null!=(d=g.providerMetadata)?d:a.providerMetadata}if("reasoning-end"===g.type){let a=M[g.id];if(null==a)return void b.enqueue({part:{type:"error",error:`reasoning part ${g.id} not found`},partialOutput:void 0});a.providerMetadata=null!=(e=g.providerMetadata)?e:a.providerMetadata,delete M[g.id]}if("file"===g.type&&G.push({type:"file",file:g.file}),"source"===g.type&&G.push(g),"tool-call"===g.type&&G.push(g),"tool-result"!==g.type||g.preliminary||G.push(g),"tool-error"===g.type&&G.push(g),"start-step"===g.type&&(I=g.request,J=g.warnings),"finish-step"===g.type){let a=jw({content:G,tools:j}),b=new js({content:G,finishReason:g.finishReason,usage:g.usage,warnings:J,request:I,response:{...g.response,messages:[...H,...a]},providerMetadata:g.providerMetadata});await (null==A?void 0:A(b)),K.push(b),G=[],M={},L={},H.push(...a),C.resolve()}"finish"===g.type&&(F=g.totalUsage,E=g.finishReason)},async flush(a){try{if(0===K.length){let a=new iv({message:"No output generated. Check the stream for errors."});V._finishReason.reject(a),V._totalUsage.reject(a),V._steps.reject(a);return}let a=null!=E?E:"unknown",c=null!=F?F:{inputTokens:void 0,outputTokens:void 0,totalTokens:void 0};V._finishReason.resolve(a),V._totalUsage.resolve(c),V._steps.resolve(K);let d=K[K.length-1];await (null==y?void 0:y({finishReason:a,totalUsage:c,usage:d.usage,content:d.content,text:d.text,reasoningText:d.reasoningText,reasoning:d.reasoning,files:d.files,sources:d.sources,toolCalls:d.toolCalls,staticToolCalls:d.staticToolCalls,dynamicToolCalls:d.dynamicToolCalls,toolResults:d.toolResults,staticToolResults:d.staticToolResults,dynamicToolResults:d.dynamicToolResults,request:d.request,response:d.response,warnings:d.warnings,providerMetadata:d.providerMetadata,steps:K})),D.setAttributes(jk({telemetry:b,attributes:{"ai.response.finishReason":a,"ai.response.text":{output:()=>d.text},"ai.response.toolCalls":{output:()=>{var a;return(null==(a=d.toolCalls)?void 0:a.length)?JSON.stringify(d.toolCalls):void 0}},"ai.response.providerMetadata":JSON.stringify(d.providerMetadata),"ai.usage.inputTokens":c.inputTokens,"ai.usage.outputTokens":c.outputTokens,"ai.usage.totalTokens":c.totalTokens,"ai.usage.reasoningTokens":c.reasoningTokens,"ai.usage.cachedInputTokens":c.cachedInputTokens}}))}catch(b){a.error(b)}finally{D.end()}}}),O=function(){let a=[],b=null,c=!1,d=jG(),e=()=>{c=!0,d.resolve(),a.forEach(a=>a.cancel()),a=[],null==b||b.close()},f=async()=>{if(c&&0===a.length){null==b||b.close();return}if(0===a.length)return d=jG(),await d.promise,f();try{let{value:d,done:e}=await a[0].read();e?(a.shift(),a.length>0?await f():c&&(null==b||b.close())):null==b||b.enqueue(d)}catch(c){null==b||b.error(c),a.shift(),e()}};return{stream:new ReadableStream({start(a){b=a},pull:f,async cancel(){for(let b of a)await b.cancel();a=[],c=!0}}),addStream:b=>{if(c)throw Error("Cannot add inner stream: outer stream is closed");a.push(b.getReader()),d.resolve()},close:()=>{c=!0,d.resolve(),0===a.length&&(null==b||b.close())},terminate:e}}();this.addStream=O.addStream,this.closeStream=O.close;let P=O.stream;for(let a of(P=(P=function(a,b){return new ReadableStream({async start(c){let d=a.getReader();try{for(;;){let{done:a,value:b}=await d.read();if(a){c.close();break}c.enqueue(b)}}catch(a){await b({error:a,controller:c})}},cancel:b=>a.cancel(b)})}(P,({error:a,controller:b})=>{g1(a)&&(null==f?void 0:f.aborted)?(null==z||z({steps:K}),b.enqueue({type:"abort"}),b.close()):b.error(a)})).pipeThrough(new TransformStream({start(a){a.enqueue({type:"start"})}})),l))P=P.pipeThrough(a({tools:j,stopStream(){O.terminate()}}));this.baseStream=P.pipeThrough(function(a){let b;if(!a)return new TransformStream({transform(a,b){b.enqueue({part:a,partialOutput:void 0})}});let c="",d="",e="";function f({controller:a,partialOutput:c}){a.enqueue({part:{type:"text-delta",id:b,text:d},partialOutput:c}),d=""}return new TransformStream({async transform(g,h){if("finish-step"===g.type&&d.length>0&&f({controller:h}),"text-delta"!==g.type&&"text-start"!==g.type&&"text-end"!==g.type)return void h.enqueue({part:g,partialOutput:void 0});if(null==b)b=g.id;else if(g.id!==b)return void h.enqueue({part:g,partialOutput:void 0});if("text-start"===g.type)return void h.enqueue({part:g,partialOutput:void 0});if("text-end"===g.type){d.length>0&&f({controller:h}),h.enqueue({part:g,partialOutput:void 0});return}c+=g.text,d+=g.text;let i=await a.parsePartial({text:c});if(null!=i){let a=JSON.stringify(i.partial);a!==e&&(f({controller:h,partialOutput:i.partial}),e=a)}}})}(p)).pipeThrough(N);let{maxRetries:Q,retry:R}=function({maxRetries:a,abortSignal:b}){if(null!=a){if(!Number.isInteger(a))throw new ii({parameter:"maxRetries",value:a,message:"maxRetries must be an integer"});if(a<0)throw new ii({parameter:"maxRetries",value:a,message:"maxRetries must be >= 0"})}let c=null!=a?a:2;return{maxRetries:c,retry:(({maxRetries:a=2,initialDelayInMs:b=2e3,backoffFactor:c=2,abortSignal:d}={})=>async e=>jn(e,{maxRetries:a,delayInMs:b,backoffFactor:c,abortSignal:d}))({maxRetries:c,abortSignal:b})}}({maxRetries:e,abortSignal:f}),S=function({isEnabled:a=!1,tracer:b}={}){return a?b||h7.u.getTracer("ai"):jf}(b),T=function({maxOutputTokens:a,temperature:b,topP:c,topK:d,presencePenalty:e,frequencyPenalty:f,seed:g,stopSequences:h}){if(null!=a){if(!Number.isInteger(a))throw new ii({parameter:"maxOutputTokens",value:a,message:"maxOutputTokens must be an integer"});if(a<1)throw new ii({parameter:"maxOutputTokens",value:a,message:"maxOutputTokens must be >= 1"})}if(null!=b&&"number"!=typeof b)throw new ii({parameter:"temperature",value:b,message:"temperature must be a number"});if(null!=c&&"number"!=typeof c)throw new ii({parameter:"topP",value:c,message:"topP must be a number"});if(null!=d&&"number"!=typeof d)throw new ii({parameter:"topK",value:d,message:"topK must be a number"});if(null!=e&&"number"!=typeof e)throw new ii({parameter:"presencePenalty",value:e,message:"presencePenalty must be a number"});if(null!=f&&"number"!=typeof f)throw new ii({parameter:"frequencyPenalty",value:f,message:"frequencyPenalty must be a number"});if(null!=g&&!Number.isInteger(g))throw new ii({parameter:"seed",value:g,message:"seed must be an integer"});return{maxOutputTokens:a,temperature:b,topP:c,topK:d,presencePenalty:e,frequencyPenalty:f,stopSequences:h,seed:g}}(d),U=function({model:a,settings:b,telemetry:c,headers:d}){var e;return{"ai.model.provider":a.provider,"ai.model.id":a.modelId,...Object.entries(b).reduce((a,[b,c])=>(a[`ai.settings.${b}`]=c,a),{}),...Object.entries(null!=(e=null==c?void 0:c.metadata)?e:{}).reduce((a,[b,c])=>(a[`ai.telemetry.metadata.${b}`]=c,a),{}),...Object.entries(null!=d?d:{}).reduce((a,[b,c])=>(void 0!==c&&(a[`ai.request.headers.${b}`]=c),a),{})}}({model:a,telemetry:b,headers:c,settings:{...T,maxRetries:Q}}),V=this;ji({name:"ai.streamText",attributes:jk({telemetry:b,attributes:{...je({operationId:"ai.streamText",telemetry:b}),...U,"ai.prompt":{input:()=>JSON.stringify({system:g,prompt:h,messages:i})}}}),tracer:S,endWhenDone:!1,fn:async d=>{async function e({currentStep:d,responseMessages:l,usage:s}){var w,x,y,z,A;let D,E,F=V.includeRawChunks;C=new jH;let G=await jd({system:g,prompt:h,messages:i}),H=[...G.messages,...l],I=await (null==r?void 0:r({model:a,steps:K,stepNumber:K.length,messages:H})),J=await i$({prompt:{system:null!=(w=null==I?void 0:I.system)?w:G.system,messages:null!=(x=null==I?void 0:I.messages)?x:H},supportedUrls:await a.supportedUrls}),L=iV(null!=(y=null==I?void 0:I.model)?y:a),{toolChoice:M,tools:N}=function({tools:a,toolChoice:b,activeTools:c}){return null!=a&&Object.keys(a).length>0?{tools:(null!=c?Object.entries(a).filter(([a])=>c.includes(a)):Object.entries(a)).map(([a,b])=>{let c=b.type;switch(c){case void 0:case"dynamic":case"function":return{type:"function",name:a,description:b.description,inputSchema:ho(b.inputSchema).jsonSchema,providerOptions:b.providerOptions};case"provider-defined":return{type:"provider-defined",name:a,id:b.id,args:b.args};default:throw Error(`Unsupported tool type: ${c}`)}}),toolChoice:null==b?{type:"auto"}:"string"==typeof b?{type:b}:{type:"tool",toolName:b.toolName}}:{tools:void 0,toolChoice:void 0}}({tools:j,toolChoice:null!=(z=null==I?void 0:I.toolChoice)?z:k,activeTools:null!=(A=null==I?void 0:I.activeTools)?A:m}),{result:{stream:O,response:P,request:Q},doStreamSpan:W,startTimestampMs:X}=await R(()=>ji({name:"ai.streamText.doStream",attributes:jk({telemetry:b,attributes:{...je({operationId:"ai.streamText.doStream",telemetry:b}),...U,"ai.model.provider":L.provider,"ai.model.id":L.modelId,"ai.prompt.messages":{input:()=>JSON.stringify(J.map(a=>({...a,content:"string"==typeof a.content?a.content:a.content.map(a=>{var b;return"file"===a.type?{...a,data:a.data instanceof Uint8Array?"string"==typeof(b=a.data)?b:b instanceof ArrayBuffer?hs(new Uint8Array(b)):hs(b):a.data}:a})})))},"ai.prompt.tools":{input:()=>null==N?void 0:N.map(a=>JSON.stringify(a))},"ai.prompt.toolChoice":{input:()=>null!=M?JSON.stringify(M):void 0},"gen_ai.system":L.provider,"gen_ai.request.model":L.modelId,"gen_ai.request.frequency_penalty":T.frequencyPenalty,"gen_ai.request.max_tokens":T.maxOutputTokens,"gen_ai.request.presence_penalty":T.presencePenalty,"gen_ai.request.stop_sequences":T.stopSequences,"gen_ai.request.temperature":T.temperature,"gen_ai.request.top_k":T.topK,"gen_ai.request.top_p":T.topP}}),tracer:S,endWhenDone:!1,fn:async a=>({startTimestampMs:t(),doStreamSpan:a,result:await L.doStream({...T,tools:N,toolChoice:M,responseFormat:null==p?void 0:p.responseFormat,prompt:J,providerOptions:q,abortSignal:f,headers:c,includeRawChunks:F})})})),Y=function({tools:a,generatorStream:b,tracer:c,telemetry:d,system:e,messages:f,abortSignal:g,repairToolCall:h,experimental_context:i}){let j,k=null,l=new ReadableStream({start(a){k=a}}),m=new Set,n=new Map,o=!1;function p(){o&&0===m.size&&(null!=j&&k.enqueue(j),k.close())}let q=new TransformStream({async transform(b,l){let o=b.type;switch(o){case"stream-start":case"text-start":case"text-delta":case"text-end":case"reasoning-start":case"reasoning-delta":case"reasoning-end":case"tool-input-start":case"tool-input-delta":case"tool-input-end":case"source":case"response-metadata":case"error":case"raw":l.enqueue(b);break;case"file":l.enqueue({type:"file",file:new jp({data:b.data,mediaType:b.mediaType})});break;case"finish":j={type:"finish",finishReason:b.finishReason,usage:b.usage,providerMetadata:b.providerMetadata};break;case"tool-call":try{let j=await jq({toolCall:b,tools:a,repairToolCall:h,system:e,messages:f});if(l.enqueue(j),j.invalid){k.enqueue({type:"tool-error",toolCallId:j.toolCallId,toolName:j.toolName,input:j.input,error:g0(j.error),dynamic:!0});break}let o=a[j.toolName];if(n.set(j.toolCallId,j.input),null!=o.onInputAvailable&&await o.onInputAvailable({input:j.input,toolCallId:j.toolCallId,messages:f,abortSignal:g,experimental_context:i}),null!=o.execute&&!0!==j.providerExecuted){let a=g_();m.add(a),ji({name:"ai.toolCall",attributes:jk({telemetry:d,attributes:{...je({operationId:"ai.toolCall",telemetry:d}),"ai.toolCall.name":j.toolName,"ai.toolCall.id":j.toolCallId,"ai.toolCall.args":{output:()=>JSON.stringify(j.input)}}}),tracer:c,fn:async b=>{let c;try{for await(let a of ht({execute:o.execute.bind(o),input:j.input,options:{toolCallId:j.toolCallId,messages:f,abortSignal:g,experimental_context:i}}))k.enqueue({...j,type:"tool-result",output:a.output,..."preliminary"===a.type&&{preliminary:!0}}),"final"===a.type&&(c=a.output)}catch(c){jj(b,c),k.enqueue({...j,type:"tool-error",error:c}),m.delete(a),p();return}m.delete(a),p();try{b.setAttributes(jk({telemetry:d,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(c)}}}))}catch(a){}}})}}catch(a){k.enqueue({type:"error",error:a})}break;case"tool-result":{let a=b.toolName;b.isError?k.enqueue({type:"tool-error",toolCallId:b.toolCallId,toolName:a,input:n.get(b.toolCallId),providerExecuted:b.providerExecuted,error:b.result}):l.enqueue({type:"tool-result",toolCallId:b.toolCallId,toolName:a,input:n.get(b.toolCallId),output:b.result,providerExecuted:b.providerExecuted});break}default:throw Error(`Unhandled chunk type: ${o}`)}},flush(){o=!0,p()}});return new ReadableStream({start:async a=>Promise.all([b.pipeThrough(q).pipeTo(new WritableStream({write(b){a.enqueue(b)},close(){}})),l.pipeTo(new WritableStream({write(b){a.enqueue(b)},close(){a.close()}}))])})}({tools:j,generatorStream:O,tracer:S,telemetry:b,system:g,messages:H,repairToolCall:n,abortSignal:f,experimental_context:B}),Z=null!=Q?Q:{},$=[],_=[],aa={},ab="unknown",ac={inputTokens:void 0,outputTokens:void 0,totalTokens:void 0},ad=!0,ae={id:v(),timestamp:u(),modelId:a.modelId},af="";V.addStream(Y.pipeThrough(new TransformStream({async transform(a,b){var c,d,e,g;if("stream-start"===a.type){D=a.warnings;return}if(ad){let a=t()-X;ad=!1,W.addEvent("ai.stream.firstChunk",{"ai.response.msToFirstChunk":a}),W.setAttributes({"ai.response.msToFirstChunk":a}),b.enqueue({type:"start-step",request:Z,warnings:null!=D?D:[]})}let h=a.type;switch(h){case"text-start":case"text-end":case"reasoning-start":case"reasoning-end":case"file":case"source":b.enqueue(a);break;case"text-delta":a.delta.length>0&&(b.enqueue({type:"text-delta",id:a.id,text:a.delta,providerMetadata:a.providerMetadata}),af+=a.delta);break;case"reasoning-delta":b.enqueue({type:"reasoning-delta",id:a.id,text:a.delta,providerMetadata:a.providerMetadata});break;case"tool-call":b.enqueue(a),$.push(a);break;case"tool-result":b.enqueue(a),a.preliminary||_.push(a);break;case"tool-error":b.enqueue(a),_.push(a);break;case"response-metadata":ae={id:null!=(c=a.id)?c:ae.id,timestamp:null!=(d=a.timestamp)?d:ae.timestamp,modelId:null!=(e=a.modelId)?e:ae.modelId};break;case"finish":{ac=a.usage,ab=a.finishReason,E=a.providerMetadata;let b=t()-X;W.addEvent("ai.stream.finish"),W.setAttributes({"ai.response.msToFinish":b,"ai.response.avgOutputTokensPerSecond":1e3*(null!=(g=ac.outputTokens)?g:0)/b});break}case"tool-input-start":{aa[a.id]=a.toolName;let c=null==j?void 0:j[a.toolName];(null==c?void 0:c.onInputStart)!=null&&await c.onInputStart({toolCallId:a.id,messages:H,abortSignal:f,experimental_context:B}),b.enqueue({...a,dynamic:(null==c?void 0:c.type)==="dynamic"});break}case"tool-input-end":delete aa[a.id],b.enqueue(a);break;case"tool-input-delta":{let c=aa[a.id],d=null==j?void 0:j[c];(null==d?void 0:d.onInputDelta)!=null&&await d.onInputDelta({inputTextDelta:a.delta,toolCallId:a.id,messages:H,abortSignal:f,experimental_context:B}),b.enqueue(a);break}case"error":b.enqueue(a),ab="error";break;case"raw":F&&b.enqueue(a);break;default:throw Error(`Unknown chunk type: ${h}`)}},async flush(a){var c;let f=$.length>0?JSON.stringify($):void 0;try{W.setAttributes(jk({telemetry:b,attributes:{"ai.response.finishReason":ab,"ai.response.text":{output:()=>af},"ai.response.toolCalls":{output:()=>f},"ai.response.id":ae.id,"ai.response.model":ae.modelId,"ai.response.timestamp":ae.timestamp.toISOString(),"ai.response.providerMetadata":JSON.stringify(E),"ai.usage.inputTokens":ac.inputTokens,"ai.usage.outputTokens":ac.outputTokens,"ai.usage.totalTokens":ac.totalTokens,"ai.usage.reasoningTokens":ac.reasoningTokens,"ai.usage.cachedInputTokens":ac.cachedInputTokens,"gen_ai.response.finish_reasons":[ab],"gen_ai.response.id":ae.id,"gen_ai.response.model":ae.modelId,"gen_ai.usage.input_tokens":ac.inputTokens,"gen_ai.usage.output_tokens":ac.outputTokens}}))}catch(a){}finally{W.end()}a.enqueue({type:"finish-step",finishReason:ab,usage:ac,providerMetadata:E,response:{...ae,headers:null==P?void 0:P.headers}});let g=(c=ac,{inputTokens:jl(s.inputTokens,c.inputTokens),outputTokens:jl(s.outputTokens,c.outputTokens),totalTokens:jl(s.totalTokens,c.totalTokens),reasoningTokens:jl(s.reasoningTokens,c.reasoningTokens),cachedInputTokens:jl(s.cachedInputTokens,c.cachedInputTokens)});await C.promise;let h=$.filter(a=>!0!==a.providerExecuted),i=_.filter(a=>!0!==a.providerExecuted);if(h.length>0&&i.length===h.length&&!await jt({stopConditions:o,steps:K})){l.push(...jw({content:K[K.length-1].content,tools:j}));try{await e({currentStep:d+1,responseMessages:l,usage:g})}catch(b){a.enqueue({type:"error",error:b}),V.closeStream()}}else a.enqueue({type:"finish",finishReason:ab,totalUsage:g}),V.closeStream()}})))}D=d,await e({currentStep:0,responseMessages:[],usage:{inputTokens:void 0,outputTokens:void 0,totalTokens:void 0}})}}).catch(a=>{V.addStream(new ReadableStream({start(b){b.enqueue({type:"error",error:a}),b.close()}})),V.closeStream()})}get steps(){return this.consumeStream(),this._steps.promise}get finalStep(){return this.steps.then(a=>a[a.length-1])}get content(){return this.finalStep.then(a=>a.content)}get warnings(){return this.finalStep.then(a=>a.warnings)}get providerMetadata(){return this.finalStep.then(a=>a.providerMetadata)}get text(){return this.finalStep.then(a=>a.text)}get reasoningText(){return this.finalStep.then(a=>a.reasoningText)}get reasoning(){return this.finalStep.then(a=>a.reasoning)}get sources(){return this.finalStep.then(a=>a.sources)}get files(){return this.finalStep.then(a=>a.files)}get toolCalls(){return this.finalStep.then(a=>a.toolCalls)}get staticToolCalls(){return this.finalStep.then(a=>a.staticToolCalls)}get dynamicToolCalls(){return this.finalStep.then(a=>a.dynamicToolCalls)}get toolResults(){return this.finalStep.then(a=>a.toolResults)}get staticToolResults(){return this.finalStep.then(a=>a.staticToolResults)}get dynamicToolResults(){return this.finalStep.then(a=>a.dynamicToolResults)}get usage(){return this.finalStep.then(a=>a.usage)}get request(){return this.finalStep.then(a=>a.request)}get response(){return this.finalStep.then(a=>a.response)}get totalUsage(){return this.consumeStream(),this._totalUsage.promise}get finishReason(){return this.consumeStream(),this._finishReason.promise}teeStream(){let[a,b]=this.baseStream.tee();return this.baseStream=b,a}get textStream(){return jE(this.teeStream().pipeThrough(new TransformStream({transform({part:a},b){"text-delta"===a.type&&b.enqueue(a.text)}})))}get fullStream(){return jE(this.teeStream().pipeThrough(new TransformStream({transform({part:a},b){b.enqueue(a)}})))}async consumeStream(a){var b;try{await jF({stream:this.fullStream,onError:null==a?void 0:a.onError})}catch(c){null==(b=null==a?void 0:a.onError)||b.call(a,c)}}get experimental_partialOutputStream(){if(null==this.output)throw new id;return jE(this.teeStream().pipeThrough(new TransformStream({transform({partialOutput:a},b){null!=a&&b.enqueue(a)}})))}toUIMessageStream({originalMessages:a,generateMessageId:b,onFinish:c,messageMetadata:d,sendReasoning:e=!0,sendSources:f=!1,sendStart:g=!0,sendFinish:h=!0,onError:i=au}={}){let j=null!=b?function({originalMessages:a,responseMessageId:b}){if(null==a)return;let c=a[a.length-1];return(null==c?void 0:c.role)==="assistant"?c.id:"function"==typeof b?b():b}({originalMessages:a,responseMessageId:b}):void 0,k={},l=a=>{var b,c;let d=k[a];return(null==(c=null==(b=this.tools)?void 0:b[d])?void 0:c.type)==="dynamic"||void 0};return jE(function({messageId:a,originalMessages:b=[],onFinish:c,onError:d,stream:e}){let f=null==b?void 0:b[b.length-1];(null==f?void 0:f.role)!=="assistant"?f=void 0:a=f.id;let g=!1,h=e.pipeThrough(new TransformStream({transform(b,c){"start"===b.type&&null==b.messageId&&null!=a&&(b.messageId=a),"abort"===b.type&&(g=!0),c.enqueue(b)}}));if(null==c)return h;let i=function({lastMessage:a,messageId:b}){return{message:(null==a?void 0:a.role)==="assistant"?a:{id:b,metadata:void 0,role:"assistant",parts:[]},activeTextParts:{},activeReasoningParts:{},partialToolCalls:{}}}({lastMessage:f?structuredClone(f):void 0,messageId:null!=a?a:""});return(function({stream:a,messageMetadataSchema:b,dataPartSchemas:c,runUpdateMessageJob:d,onError:e,onToolCall:f,onData:g}){return a.pipeThrough(new TransformStream({async transform(a,h){await d(async({state:d,write:i})=>{var j,k,l,m;function n(a){let b=d.message.parts.filter(jC).find(b=>b.toolCallId===a);if(null==b)throw Error("tool-output-error must be preceded by a tool-input-available");return b}function o(a){let b=d.message.parts.filter(a=>"dynamic-tool"===a.type).find(b=>b.toolCallId===a);if(null==b)throw Error("tool-output-error must be preceded by a tool-input-available");return b}function p(a){var b;let c=d.message.parts.find(b=>jC(b)&&b.toolCallId===a.toolCallId);null!=c?(c.state=a.state,c.input=a.input,c.output=a.output,c.errorText=a.errorText,c.rawInput=a.rawInput,c.preliminary=a.preliminary,c.providerExecuted=null!=(b=a.providerExecuted)?b:c.providerExecuted,null!=a.providerMetadata&&"input-available"===c.state&&(c.callProviderMetadata=a.providerMetadata)):d.message.parts.push({type:`tool-${a.toolName}`,toolCallId:a.toolCallId,state:a.state,input:a.input,output:a.output,rawInput:a.rawInput,errorText:a.errorText,providerExecuted:a.providerExecuted,preliminary:a.preliminary,...null!=a.providerMetadata?{callProviderMetadata:a.providerMetadata}:{}})}function q(a){var b;let c=d.message.parts.find(b=>"dynamic-tool"===b.type&&b.toolCallId===a.toolCallId);null!=c?(c.state=a.state,c.toolName=a.toolName,c.input=a.input,c.output=a.output,c.errorText=a.errorText,c.rawInput=null!=(b=a.rawInput)?b:c.rawInput,c.preliminary=a.preliminary,null!=a.providerMetadata&&"input-available"===c.state&&(c.callProviderMetadata=a.providerMetadata)):d.message.parts.push({type:"dynamic-tool",toolName:a.toolName,toolCallId:a.toolCallId,state:a.state,input:a.input,output:a.output,errorText:a.errorText,preliminary:a.preliminary,...null!=a.providerMetadata?{callProviderMetadata:a.providerMetadata}:{}})}async function r(a){if(null!=a){let c=null!=d.message.metadata?function a(b,c){if(void 0===b&&void 0===c)return;if(void 0===b)return c;if(void 0===c)return b;let d={...b};for(let e in c)if(Object.prototype.hasOwnProperty.call(c,e)){let f=c[e];if(void 0===f)continue;let g=e in b?b[e]:void 0,h=null!==f&&"object"==typeof f&&!Array.isArray(f)&&!(f instanceof Date)&&!(f instanceof RegExp),i=null!=g&&"object"==typeof g&&!Array.isArray(g)&&!(g instanceof Date)&&!(g instanceof RegExp);h&&i?d[e]=a(g,f):d[e]=f}return d}(d.message.metadata,a):a;null!=b&&await hc({value:c,schema:b}),d.message.metadata=c}}switch(a.type){case"text-start":{let b={type:"text",text:"",providerMetadata:a.providerMetadata,state:"streaming"};d.activeTextParts[a.id]=b,d.message.parts.push(b),i();break}case"text-delta":{let b=d.activeTextParts[a.id];b.text+=a.delta,b.providerMetadata=null!=(j=a.providerMetadata)?j:b.providerMetadata,i();break}case"text-end":{let b=d.activeTextParts[a.id];b.state="done",b.providerMetadata=null!=(k=a.providerMetadata)?k:b.providerMetadata,delete d.activeTextParts[a.id],i();break}case"reasoning-start":{let b={type:"reasoning",text:"",providerMetadata:a.providerMetadata,state:"streaming"};d.activeReasoningParts[a.id]=b,d.message.parts.push(b),i();break}case"reasoning-delta":{let b=d.activeReasoningParts[a.id];b.text+=a.delta,b.providerMetadata=null!=(l=a.providerMetadata)?l:b.providerMetadata,i();break}case"reasoning-end":{let b=d.activeReasoningParts[a.id];b.providerMetadata=null!=(m=a.providerMetadata)?m:b.providerMetadata,b.state="done",delete d.activeReasoningParts[a.id],i();break}case"file":d.message.parts.push({type:"file",mediaType:a.mediaType,url:a.url}),i();break;case"source-url":d.message.parts.push({type:"source-url",sourceId:a.sourceId,url:a.url,title:a.title,providerMetadata:a.providerMetadata}),i();break;case"source-document":d.message.parts.push({type:"source-document",sourceId:a.sourceId,mediaType:a.mediaType,title:a.title,filename:a.filename,providerMetadata:a.providerMetadata}),i();break;case"tool-input-start":{let b=d.message.parts.filter(jC);d.partialToolCalls[a.toolCallId]={text:"",toolName:a.toolName,index:b.length,dynamic:a.dynamic},a.dynamic?q({toolCallId:a.toolCallId,toolName:a.toolName,state:"input-streaming",input:void 0}):p({toolCallId:a.toolCallId,toolName:a.toolName,state:"input-streaming",input:void 0,providerExecuted:a.providerExecuted}),i();break}case"tool-input-delta":{let b=d.partialToolCalls[a.toolCallId];b.text+=a.inputTextDelta;let{value:c}=await jB(b.text);b.dynamic?q({toolCallId:a.toolCallId,toolName:b.toolName,state:"input-streaming",input:c}):p({toolCallId:a.toolCallId,toolName:b.toolName,state:"input-streaming",input:c}),i();break}case"tool-input-available":a.dynamic?q({toolCallId:a.toolCallId,toolName:a.toolName,state:"input-available",input:a.input,providerMetadata:a.providerMetadata}):p({toolCallId:a.toolCallId,toolName:a.toolName,state:"input-available",input:a.input,providerExecuted:a.providerExecuted,providerMetadata:a.providerMetadata}),i(),f&&!a.providerExecuted&&await f({toolCall:a});break;case"tool-input-error":a.dynamic?q({toolCallId:a.toolCallId,toolName:a.toolName,state:"output-error",input:a.input,errorText:a.errorText,providerMetadata:a.providerMetadata}):p({toolCallId:a.toolCallId,toolName:a.toolName,state:"output-error",input:void 0,rawInput:a.input,errorText:a.errorText,providerExecuted:a.providerExecuted,providerMetadata:a.providerMetadata}),i();break;case"tool-output-available":if(a.dynamic){let b=o(a.toolCallId);q({toolCallId:a.toolCallId,toolName:b.toolName,state:"output-available",input:b.input,output:a.output,preliminary:a.preliminary})}else{let b=n(a.toolCallId);p({toolCallId:a.toolCallId,toolName:jD(b),state:"output-available",input:b.input,output:a.output,providerExecuted:a.providerExecuted,preliminary:a.preliminary})}i();break;case"tool-output-error":if(a.dynamic){let b=o(a.toolCallId);q({toolCallId:a.toolCallId,toolName:b.toolName,state:"output-error",input:b.input,errorText:a.errorText})}else{let b=n(a.toolCallId);p({toolCallId:a.toolCallId,toolName:jD(b),state:"output-error",input:b.input,rawInput:b.rawInput,errorText:a.errorText})}i();break;case"start-step":d.message.parts.push({type:"step-start"});break;case"finish-step":d.activeTextParts={},d.activeReasoningParts={};break;case"start":null!=a.messageId&&(d.message.id=a.messageId),await r(a.messageMetadata),(null!=a.messageId||null!=a.messageMetadata)&&i();break;case"finish":case"message-metadata":await r(a.messageMetadata),null!=a.messageMetadata&&i();break;case"error":null==e||e(Error(a.errorText));break;default:if(a.type.startsWith("data-")){if((null==c?void 0:c[a.type])!=null&&await hc({value:a.data,schema:c[a.type]}),a.transient){null==g||g(a);break}let b=null!=a.id?d.message.parts.find(b=>a.type===b.type&&a.id===b.id):void 0;null!=b?b.data=a.data:d.message.parts.push(a),null==g||g(a),i()}}h.enqueue(a)})}}))})({stream:h,runUpdateMessageJob:async a=>{await a({state:i,write:()=>{}})},onError:d}).pipeThrough(new TransformStream({transform(a,b){b.enqueue(a)},async flush(){let a=i.message.id===(null==f?void 0:f.id);await c({isAborted:g,isContinuation:a,responseMessage:i.message,messages:[...a?b.slice(0,-1):b,i.message]})}}))}({stream:this.fullStream.pipeThrough(new TransformStream({transform:async(a,b)=>{let c=null==d?void 0:d({part:a}),m=a.type;switch(m){case"text-start":b.enqueue({type:"text-start",id:a.id,...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{}});break;case"text-delta":b.enqueue({type:"text-delta",id:a.id,delta:a.text,...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{}});break;case"text-end":b.enqueue({type:"text-end",id:a.id,...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{}});break;case"reasoning-start":b.enqueue({type:"reasoning-start",id:a.id,...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{}});break;case"reasoning-delta":e&&b.enqueue({type:"reasoning-delta",id:a.id,delta:a.text,...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{}});break;case"reasoning-end":b.enqueue({type:"reasoning-end",id:a.id,...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{}});break;case"file":b.enqueue({type:"file",mediaType:a.file.mediaType,url:`data:${a.file.mediaType};base64,${a.file.base64}`});break;case"source":f&&"url"===a.sourceType&&b.enqueue({type:"source-url",sourceId:a.id,url:a.url,title:a.title,...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{}}),f&&"document"===a.sourceType&&b.enqueue({type:"source-document",sourceId:a.id,mediaType:a.mediaType,title:a.title,filename:a.filename,...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{}});break;case"tool-input-start":{k[a.id]=a.toolName;let c=l(a.id);b.enqueue({type:"tool-input-start",toolCallId:a.id,toolName:a.toolName,...null!=a.providerExecuted?{providerExecuted:a.providerExecuted}:{},...null!=c?{dynamic:c}:{}});break}case"tool-input-delta":b.enqueue({type:"tool-input-delta",toolCallId:a.id,inputTextDelta:a.delta});break;case"tool-call":{k[a.toolCallId]=a.toolName;let c=l(a.toolCallId);a.invalid?b.enqueue({type:"tool-input-error",toolCallId:a.toolCallId,toolName:a.toolName,input:a.input,...null!=a.providerExecuted?{providerExecuted:a.providerExecuted}:{},...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{},...null!=c?{dynamic:c}:{},errorText:i(a.error)}):b.enqueue({type:"tool-input-available",toolCallId:a.toolCallId,toolName:a.toolName,input:a.input,...null!=a.providerExecuted?{providerExecuted:a.providerExecuted}:{},...null!=a.providerMetadata?{providerMetadata:a.providerMetadata}:{},...null!=c?{dynamic:c}:{}});break}case"tool-result":{let c=l(a.toolCallId);b.enqueue({type:"tool-output-available",toolCallId:a.toolCallId,output:a.output,...null!=a.providerExecuted?{providerExecuted:a.providerExecuted}:{},...null!=a.preliminary?{preliminary:a.preliminary}:{},...null!=c?{dynamic:c}:{}});break}case"tool-error":{let c=l(a.toolCallId);b.enqueue({type:"tool-output-error",toolCallId:a.toolCallId,errorText:i(a.error),...null!=a.providerExecuted?{providerExecuted:a.providerExecuted}:{},...null!=c?{dynamic:c}:{}});break}case"error":b.enqueue({type:"error",errorText:i(a.error)});break;case"start-step":b.enqueue({type:"start-step"});break;case"finish-step":b.enqueue({type:"finish-step"});break;case"start":g&&b.enqueue({type:"start",...null!=c?{messageMetadata:c}:{},...null!=j?{messageId:j}:{}});break;case"finish":h&&b.enqueue({type:"finish",...null!=c?{messageMetadata:c}:{}});break;case"abort":b.enqueue(a);break;case"tool-input-end":case"raw":break;default:throw Error(`Unknown chunk type: ${m}`)}null!=c&&"start"!==m&&"finish"!==m&&b.enqueue({type:"message-metadata",messageMetadata:c})}})),messageId:null!=j?j:null==b?void 0:b(),originalMessages:a,onFinish:c,onError:i}))}pipeUIMessageStreamToResponse(a,{originalMessages:b,generateMessageId:c,onFinish:d,messageMetadata:e,sendReasoning:f,sendSources:g,sendFinish:h,sendStart:i,onError:j,...k}={}){!function({response:a,status:b,statusText:c,headers:d,stream:e,consumeSseStream:f}){let g=e.pipeThrough(new jz);if(f){let[a,b]=g.tee();g=a,f({stream:b})}jy({response:a,status:b,statusText:c,headers:Object.fromEntries(jx(d,jA).entries()),stream:g.pipeThrough(new TextEncoderStream)})}({response:a,stream:this.toUIMessageStream({originalMessages:b,generateMessageId:c,onFinish:d,messageMetadata:e,sendReasoning:f,sendSources:g,sendFinish:h,sendStart:i,onError:j}),...k})}pipeTextStreamToResponse(a,b){!function({response:a,status:b,statusText:c,headers:d,textStream:e}){jy({response:a,status:b,statusText:c,headers:Object.fromEntries(jx(d,{"content-type":"text/plain; charset=utf-8"}).entries()),stream:e.pipeThrough(new TextEncoderStream)})}({response:a,textStream:this.textStream,...b})}toUIMessageStreamResponse({originalMessages:a,generateMessageId:b,onFinish:c,messageMetadata:d,sendReasoning:e,sendSources:f,sendFinish:g,sendStart:h,onError:i,...j}={}){return function({status:a,statusText:b,headers:c,stream:d,consumeSseStream:e}){let f=d.pipeThrough(new jz);if(e){let[a,b]=f.tee();f=a,e({stream:b})}return new Response(f.pipeThrough(new TextEncoderStream),{status:a,statusText:b,headers:jx(c,jA)})}({stream:this.toUIMessageStream({originalMessages:a,generateMessageId:b,onFinish:c,messageMetadata:d,sendReasoning:e,sendSources:f,sendFinish:g,sendStart:h,onError:i}),...j})}toTextStreamResponse(a){return function({status:a,statusText:b,headers:c,textStream:d}){return new Response(d.pipeThrough(new TextEncoderStream),{status:null!=a?a:200,statusText:b,headers:jx(c,{"content-type":"text/plain; charset=utf-8"})})}({textStream:this.textStream,...a})}};g$({prefix:"aiobj",size:24}),g$({prefix:"aiobj",size:24}),((a,b)=>{for(var c in b)h9(a,c,{get:b[c],enumerable:!0})})({},{object:()=>jL,text:()=>jK});var jK=()=>({type:"text",responseFormat:{type:"text"},parsePartial:async({text:a})=>({partial:a}),parseOutput:async({text:a})=>a}),jL=({schema:a})=>{let b=ho(a);return{type:"object",responseFormat:{type:"json",schema:b.jsonSchema},async parsePartial({text:a}){let b=await jB(a);switch(b.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:b.value};default:{let a=b.state;throw Error(`Unsupported parse state: ${a}`)}}},async parseOutput({text:a},c){let d=await hf({text:a});if(!d.success)throw new ir({message:"No object generated: could not parse the response.",cause:d.error,text:a,response:c.response,usage:c.usage,finishReason:c.finishReason});let e=await hd({value:d.value,schema:b});if(!e.success)throw new ir({message:"No object generated: response did not match schema.",cause:e.error,text:a,response:c.response,usage:c.usage,finishReason:c.finishReason});return e.value}}},jM=(Symbol.for("vercel.ai.error.AI_NoSuchProviderError"),f4({name:ft(),version:ft()})),jN=f4({_meta:gh(f2({}).loose())}),jO=f2({method:ft(),params:gh(jN)}),jP=f4({experimental:gh(f2({}).loose()),logging:gh(f2({}).loose()),prompts:gh(f4({listChanged:gh(fT())})),resources:gh(f4({subscribe:gh(fT()),listChanged:gh(fT())})),tools:gh(f4({listChanged:gh(fT())}))});jN.extend({protocolVersion:ft(),capabilities:jP,serverInfo:jM,instructions:gh(ft())});var jQ=jN.extend({nextCursor:gh(ft())}),jR=f2({name:ft(),description:gh(ft()),inputSchema:f2({type:ge("object"),properties:gh(f2({}).loose())}).loose()}).loose();jQ.extend({tools:f0(jR)});var jS=f2({type:ge("text"),text:ft()}).loose(),jT=f2({type:ge("image"),data:e6(fK,void 0),mimeType:ft()}).loose(),jU=f2({uri:ft(),mimeType:gh(ft())}).loose(),jV=jU.extend({text:ft()}),jW=jU.extend({blob:e6(fK,void 0)}),jX=f2({type:ge("resource"),resource:f6([jV,jW])}).loose();jN.extend({content:f0(f6([jS,jT,jX])),isError:fT().default(!1).optional()}).or(jN.extend({toolResult:fY()}));var jY=f2({jsonrpc:ge("2.0"),id:f6([ft(),fP().int()])}).merge(jO).strict(),jZ=f2({jsonrpc:ge("2.0"),id:f6([ft(),fP().int()]),result:jN}).strict(),j$=f2({jsonrpc:ge("2.0"),id:f6([ft(),fP().int()]),error:f2({code:fP().int(),message:ft(),data:gh(fY())})}).strict();f6([jY,f2({jsonrpc:ge("2.0")}).merge(f2({method:ft(),params:gh(jN)})).strict(),jZ,j$]);let j_=30;async function j0(a){let{messages:b}=await a.json();return(function({model:a,tools:b,toolChoice:c,system:d,prompt:e,messages:f,maxRetries:g,abortSignal:h,headers:i,stopWhen:j=function(a){return({steps:a})=>1===a.length}(0),experimental_output:k,experimental_telemetry:l,prepareStep:m,providerOptions:n,experimental_activeTools:o,activeTools:p=o,experimental_repairToolCall:q,experimental_transform:r,includeRawChunks:s=!1,onChunk:t,onError:u=({error:a})=>{console.error(a)},onFinish:v,onAbort:w,onStepFinish:x,experimental_context:y,_internal:{now:z=function(){var a,b;return null!=(b=null==(a=null==globalThis?void 0:globalThis.performance)?void 0:a.now())?b:Date.now()},generateId:A=jI,currentDate:B=()=>new Date}={},...C}){return new jJ({model:iV(a),telemetry:l,headers:i,settings:C,maxRetries:g,abortSignal:h,system:d,prompt:e,messages:f,tools:b,toolChoice:c,transforms:jm(r),activeTools:p,repairToolCall:q,stopConditions:jm(j),output:k,providerOptions:n,prepareStep:m,includeRawChunks:s,onChunk:t,onError:u,onFinish:v,onAbort:w,onStepFinish:x,now:z,currentDate:B,generateId:A,experimental_context:y})})({model:gU("gemini-2.0-flash"),messages:function(a,b){let c=[];for(let d of a)switch(d.role){case"system":{let a=d.parts.filter(a=>"text"===a.type),b=a.reduce((a,b)=>null!=b.providerMetadata?{...a,...b.providerMetadata}:a,{});c.push({role:"system",content:a.map(a=>a.text).join(""),...Object.keys(b).length>0?{providerOptions:b}:{}});break}case"user":c.push({role:"user",content:d.parts.filter(a=>"text"===a.type||"file"===a.type).map(a=>{switch(a.type){case"text":return{type:"text",text:a.text,...null!=a.providerMetadata?{providerOptions:a.providerMetadata}:{}};case"file":return{type:"file",mediaType:a.mediaType,filename:a.filename,data:a.url,...null!=a.providerMetadata?{providerOptions:a.providerMetadata}:{}};default:return a}})});break;case"assistant":if(null!=d.parts){let a=function(){var a,f;if(0===e.length)return;let g=[];for(let b of e)if("text"===b.type)g.push({type:"text",text:b.text,...null!=b.providerMetadata?{providerOptions:b.providerMetadata}:{}});else if("file"===b.type)g.push({type:"file",mediaType:b.mediaType,filename:b.filename,data:b.url});else if("reasoning"===b.type)g.push({type:"reasoning",text:b.text,providerOptions:b.providerMetadata});else if("dynamic-tool"===b.type){let a=b.toolName;if("input-streaming"===b.state)throw new iM({originalMessage:d,message:`incomplete tool input is not supported: ${b.toolCallId}`});g.push({type:"tool-call",toolCallId:b.toolCallId,toolName:a,input:b.input,...null!=b.callProviderMetadata?{providerOptions:b.callProviderMetadata}:{}})}else if(jC(b)){let c=jD(b);if("input-streaming"===b.state)throw new iM({originalMessage:d,message:`incomplete tool input is not supported: ${b.toolCallId}`});g.push({type:"tool-call",toolCallId:b.toolCallId,toolName:c,input:"output-error"===b.state?null!=(a=b.input)?a:b.rawInput:b.input,providerExecuted:b.providerExecuted,...null!=b.callProviderMetadata?{providerOptions:b.callProviderMetadata}:{}}),!0===b.providerExecuted&&("output-available"===b.state||"output-error"===b.state)&&g.push({type:"tool-result",toolCallId:b.toolCallId,toolName:c,output:ju({output:"output-error"===b.state?b.errorText:b.output,tool:(f=void 0,void 0),errorMode:"output-error"===b.state?"json":"none"})})}else throw Error(`Unsupported part: ${b}`);c.push({role:"assistant",content:g});let h=e.filter(a=>jC(a)&&!0!==a.providerExecuted||"dynamic-tool"===a.type);h.length>0&&c.push({role:"tool",content:h.map(a=>{var c;switch(a.state){case"output-error":case"output-available":{let d="dynamic-tool"===a.type?a.toolName:jD(a);return{type:"tool-result",toolCallId:a.toolCallId,toolName:d,output:ju({output:"output-error"===a.state?a.errorText:a.output,tool:null==(c=null==b?void 0:b.tools)?void 0:c[d],errorMode:"output-error"===a.state?"text":"none"})}}default:throw new iM({originalMessage:d,message:`Unsupported tool part state: ${a.state}`})}})}),e=[]},e=[];for(let b of d.parts)"text"===b.type||"reasoning"===b.type||"file"===b.type||"dynamic-tool"===b.type||jC(b)?e.push(b):"step-start"===b.type&&a();a()}break;default:{let a=d.role;throw new iM({originalMessage:d,message:`Unsupported role: ${a}`})}}return c}(b)}).toUIMessageStreamResponse()}let j1=new U.AppRouteRouteModule({definition:{kind:V.RouteKind.APP_ROUTE,page:"/api/chat/route",pathname:"/api/chat",filename:"route",bundlePath:"app/api/chat/route"},distDir:".next",projectDir:"",resolvedPagePath:"/Users/salman/Desktop/chat-snap-gen/app/api/chat/route.ts",nextConfigOutput:"",userland:T}),{workAsyncStorage:j2,workUnitAsyncStorage:j3,serverHooks:j4}=j1;function j5(){return(0,W.patchFetch)({workAsyncStorage:j2,workUnitAsyncStorage:j3})}async function j6(a,b,c){var d;let e="/api/chat/route";"/index"===e&&(e="/");let f=await j1.prepare(a,b,{srcPage:e,multiZoneDraftMode:"false"});if(!f)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:g,params:h,nextConfig:i,isDraftMode:j,prerenderManifest:k,routerServerContext:l,isOnDemandRevalidate:m,revalidateOnlyGenerated:n,resolvedPathname:o}=f,p=(0,Z.normalizeAppPath)(e),q=!!(k.dynamicRoutes[p]||k.routes[o]);if(q&&!j){let a=!!k.routes[o],b=k.dynamicRoutes[p];if(b&&!1===b.fallback&&!a)throw new ag.NoFallbackError}let r=null;!q||j1.isDev||j||(r="/index"===(r=o)?"/":r);let s=!0===j1.isDev||!q,t=q&&!s,u=a.method||"GET",v=(0,Y.getTracer)(),w=v.getActiveScopeSpan(),x={params:h,prerenderManifest:k,renderOpts:{experimental:{dynamicIO:!!i.experimental.dynamicIO,authInterrupts:!!i.experimental.authInterrupts},supportsDynamicResponse:s,incrementalCache:(0,X.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=i.experimental)?void 0:d.cacheLife,isRevalidate:t,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>j1.onRequestError(a,b,d,l)},sharedContext:{buildId:g}},y=new $.NodeNextRequest(a),z=new $.NodeNextResponse(b),A=_.NextRequestAdapter.fromNodeNextRequest(y,(0,_.signalFromNodeResponse)(b));try{let d=async c=>j1.handle(A,x).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=v.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==aa.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${u} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${u} ${a.url}`)}),f=async f=>{var g,h;let o=async({previousCacheEntry:g})=>{try{if(!(0,X.getRequestMeta)(a,"minimalMode")&&m&&n&&!g)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(f);a.fetchMetrics=x.renderOpts.fetchMetrics;let h=x.renderOpts.pendingWaitUntil;h&&c.waitUntil&&(c.waitUntil(h),h=void 0);let i=x.renderOpts.collectedTags;if(!q)return await (0,ac.I)(y,z,e,x.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,ad.toNodeOutgoingHttpHeaders)(e.headers);i&&(b[af.NEXT_CACHE_TAGS_HEADER]=i),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==x.renderOpts.collectedRevalidate&&!(x.renderOpts.collectedRevalidate>=af.INFINITE_CACHE)&&x.renderOpts.collectedRevalidate,d=void 0===x.renderOpts.collectedExpire||x.renderOpts.collectedExpire>=af.INFINITE_CACHE?void 0:x.renderOpts.collectedExpire;return{value:{kind:ah.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==g?void 0:g.isStale)&&await j1.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,ab.c)({isRevalidate:t,isOnDemandRevalidate:m})},l),b}},p=await j1.handleResponse({req:a,nextConfig:i,cacheKey:r,routeKind:V.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:k,isRoutePPREnabled:!1,isOnDemandRevalidate:m,revalidateOnlyGenerated:n,responseGenerator:o,waitUntil:c.waitUntil});if(!q)return null;if((null==p||null==(g=p.value)?void 0:g.kind)!==ah.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==p||null==(h=p.value)?void 0:h.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,X.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",m?"REVALIDATED":p.isMiss?"MISS":p.isStale?"STALE":"HIT"),j&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let s=(0,ad.fromNodeOutgoingHttpHeaders)(p.value.headers);return(0,X.getRequestMeta)(a,"minimalMode")&&q||s.delete(af.NEXT_CACHE_TAGS_HEADER),!p.cacheControl||b.getHeader("Cache-Control")||s.get("Cache-Control")||s.set("Cache-Control",(0,ae.getCacheControlHeader)(p.cacheControl)),await (0,ac.I)(y,z,new Response(p.value.body,{headers:s,status:p.value.status||200})),null};w?await f(w):await v.withPropagatedContext(a.headers,()=>v.trace(aa.BaseServerSpan.handleRequest,{spanName:`${u} ${a.url}`,kind:Y.SpanKind.SERVER,attributes:{"http.method":u,"http.target":a.url}},f))}catch(b){if(w||b instanceof ag.NoFallbackError||await j1.onRequestError(a,b,{routerKind:"App Router",routePath:p,routeType:"route",revalidateReason:(0,ab.c)({isRevalidate:t,isOnDemandRevalidate:m})}),q)throw b;return await (0,ac.I)(y,z,new Response(null,{status:500})),null}}},96487:()=>{},96559:(a,b,c)=>{"use strict";a.exports=c(44870)}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[431],()=>b(b.s=96349));module.exports=c})();